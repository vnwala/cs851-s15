function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}function in$(member,list){for(var i=0,length=list.length;length>i;++i)if(i in list&&list[i]===member)return!0;return!1}void function(){var safeInit;null!=window.Tracking?window.Tracking:window.Tracking={},safeInit=function(obj,payload,cb){var err;try{return obj.init(payload,cb)}catch(e$){return err=e$,OptimizeSuite.TrackingHub.add("DealPage-FrontEndInit-Error",{error:err}),cb()}},Tracking.Initializer=function(timeoutInMs){var finished,inFlight;return null==timeoutInMs&&(timeoutInMs=3e4),inFlight=0,this._hasRun=!1,finished=!1,{run:function(modules,payload,cb){for(var module,i$=0,length$=modules.length;length$>i$;++i$)module=modules[i$],inFlight++,safeInit(module,payload,function(this$){return function(){return inFlight--,0===inFlight&&this$._hasRun&&!finished?(finished=!0,cb()):void 0}}(this));return this._hasRun=!0,0!==inFlight||finished||(finished=!0,cb()),setTimeout(function(){return finished?void 0:(OptimizeSuite.TrackingHub.add("DealPage-FrontEndInit-Timeout",{numberInFlight:inFlight}),finished=!0,cb())},timeoutInMs)}}}}.call(this),window.swfobject=function(){var abstractAltContent,addDomLoadEvent,addListener,addLoadEvent,autoHideShow,callDomLoadFunctions,canExpressInstall,cleanup,createCSS,createElement,createObjParam,createSWF,displayAltContent,doc,domLoadFnArr,dynamicStylesheet,dynamicStylesheetMedia,EXPRESS_INSTALL_ID,FLASH_MIME_TYPE,getElementById,getObjectById,hasPlayerVersion,isDomLoaded,isExpressInstallActive,listenersArr,main,matchVersions,nav,OBJECT,objIdArr,ON_READY_STATE_CHANGE,onDomLoad,plugin,regObjArr,removeObjectInIE,removeSWF,setVisibility,SHOCKWAVE_FLASH,SHOCKWAVE_FLASH_AX,showExpressInstall,storedAltContent,storedAltContentId,storedCallbackFn,storedCallbackObj,testPlayerVersion,ua,UNDEF,urlEncodeIfNecessary,win;return UNDEF="undefined",OBJECT="object",SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",EXPRESS_INSTALL_ID="SWFObjectExprInst",ON_READY_STATE_CHANGE="onreadystatechange",win=window,doc=document,nav=navigator,plugin=!1,regObjArr=[],objIdArr=[],listenersArr=[],isDomLoaded=!1,isExpressInstallActive=!1,autoHideShow=!0,storedAltContent=storedAltContentId=storedCallbackFn=storedCallbackObj=dynamicStylesheet=dynamicStylesheetMedia=null,callDomLoadFunctions=function(){var dl,e,t;if(!isDomLoaded){try{t=doc.getElementsByTagName("body")[0].appendChild(createElement("span")),t.parentNode.removeChild(t)}catch(e$){return e=e$,void 0}return isDomLoaded=!0,dl=domLoadFnArr,function(accum$){for(var dlFn,i,cache$=domLoadFnArr||[],i$=0,length$=cache$.length;length$>i$;++i$)dlFn=cache$[i$],i=i$,accum$.push(dlFn());return accum$}.call(this,[])}},addDomLoadEvent=function(fn){return isDomLoaded?fn():domLoadFnArr[domLoadFnArr.length]=fn},addLoadEvent=function(fn){var fnOld;return typeof win.addEventListener!==UNDEF?win.addEventListener("load",fn,!1):typeof doc.addEventListener!==UNDEF?doc.addEventListener("load",fn,!1):typeof win.attachEvent!==UNDEF?addListener(win,"onload",fn):"function"==typeof win.onload?(fnOld=win.onload,win.onload=function(){return fnOld(),fn()}):win.onload=fn},main=function(){return plugin?testPlayerVersion():matchVersions()},domLoadFnArr=[main],testPlayerVersion=function(){var b,counter,o,t;return b=doc.getElementsByTagName("body")[0],o=createElement(OBJECT),o.setAttribute("type",FLASH_MIME_TYPE),t=b.appendChild(o),t?(counter=0,function(){var d;if(typeof t.GetVariable!==UNDEF)d=t.GetVariable("$version"),d&&(d=d.split(" ")[1].split(","),ua.pv=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]);else if(10>counter)return counter++,setTimeout(arguments.callee,10),void 0;return b.removeChild(o),t=null,matchVersions()}()):matchVersions()},matchVersions=function(){var rl;return rl=regObjArr.length,regObjArr.length?function(accum$){for(var att,cb,cbObj,i,id,o,obj,p,par,pl,regObj,i$=0,length$=regObjArr.length;length$>i$;++i$)regObj=regObjArr[i$],i=i$,id=regObj.id,cb=regObj.callbackFn,cbObj={success:!1,id:id},accum$.push(ua.pv[0]>0?(obj=getElementById(id),obj?!hasPlayerVersion(regObj.swfVersion)||ua.wk&&ua.wk<312?regObj.expressInstall&&canExpressInstall()?(att={},att.data=regObj.expressInstall,att.width=obj.getAttribute("width")||"0",att.height=obj.getAttribute("height")||"0",obj.getAttribute("class")?att.styleclass=obj.getAttribute("class"):void 0,obj.getAttribute("align")?att.align=obj.getAttribute("align"):void 0,par={},p=obj.getElementsByTagName("param"),pl=p.length,function(accum$1){for(var pair,cache$=p||[],i$1=0,length$1=cache$.length;length$1>i$1;++i$1)pair=cache$[i$1],accum$1.push("movie"!==pair.getAttribute("name").toLowerCase()?par[pair.getAttribute("name")]=pair.getAttribute("value"):void 0);return accum$1}.call(this,[]),showExpressInstall(att,par,id,cb)):(displayAltContent(obj),cb?cb(cbObj):void 0):(setVisibility(id,!0),cb?(cbObj.success=!0,cbObj.ref=getObjectById(id),cb(cbObj)):void 0):void 0):(setVisibility(id,!0),cb?(o=getObjectById(id),o&&typeof o.SetVariable!==UNDEF?(cbObj.success=!0,cbObj.ref=o):void 0,cb(cbObj)):void 0));return accum$}.call(this,[]):void 0},getObjectById=function(objectIdStr){var n,o,r;return r=null,o=getElementById(objectIdStr),o&&"OBJECT"===o.nodeName&&(typeof o.SetVariable!==UNDEF?r=o:(n=o.getElementsByTagName(OBJECT)[0],n&&(r=n))),r},canExpressInstall=function(){return!isExpressInstallActive&&hasPlayerVersion("6.0.65")&&(ua.win||ua.mac)&&!(ua.wk&&ua.wk<312)},showExpressInstall=function(att,par,replaceElemIdStr,callbackFn){var fv,newObj,obj,pt;return isExpressInstallActive=!0,storedCallbackFn=callbackFn||null,storedCallbackObj={success:!1,id:replaceElemIdStr},obj=getElementById(replaceElemIdStr),obj?("OBJECT"===obj.nodeName?(storedAltContent=abstractAltContent(obj),storedAltContentId=null):(storedAltContent=obj,storedAltContentId=replaceElemIdStr),att.id=EXPRESS_INSTALL_ID,(typeof att.width===UNDEF||!/%$/.test(att.width)&&parseInt(att.width,10)<310)&&(att.width="310"),(typeof att.height===UNDEF||!/%$/.test(att.height)&&parseInt(att.height,10)<137)&&(att.height="137"),doc.title=doc.title.slice(0,47)+" - Flash Player Installation",pt=ua.ie&&ua.win?"ActiveX":"PlugIn",fv="MMredirectURL="+win.location.toString().replace(/&/g,"%26")+"&MMplayerType="+pt+"&MMdoctitle="+doc.title,typeof par.flashvars!==UNDEF?par.flashvars+="&"+fv:par.flashvars=fv,ua.ie&&ua.win&&4!==obj.readyState&&(newObj=createElement("div"),replaceElemIdStr+="SWFObjectNew",newObj.setAttribute("id",replaceElemIdStr),obj.parentNode.insertBefore(newObj,obj),obj.style.display="none",function(){return 4===obj.readyState?obj.parentNode.removeChild(obj):setTimeout(arguments.callee,10)}()),createSWF(att,par,replaceElemIdStr)):void 0},displayAltContent=function(obj){var el;return ua.ie&&ua.win&&4!==obj.readyState?(el=createElement("div"),obj.parentNode.insertBefore(el,obj),el.parentNode.replaceChild(abstractAltContent(obj),el),obj.style.display="none",function(){return 4===obj.readyState?obj.parentNode.removeChild(obj):setTimeout(arguments.callee,10)}()):obj.parentNode.replaceChild(abstractAltContent(obj),obj)},abstractAltContent=function(obj){var ac,c,childNode,cl,nestedObj;if(ac=createElement("div"),ua.win&&ua.ie)ac.innerHTML=obj.innerHTML;else if(nestedObj=obj.getElementsByTagName(OBJECT)[0],nestedObj&&(c=nestedObj.childNodes)){cl=c.length;for(var i$=0,length$=c.length;length$>i$;++i$)childNode=c[i$],1===childNode.nodeType&&"PARAM"===childNode.nodeName||8===childNode.nodeType||ac.appendChild(childNode.cloneNode(!0))}return ac},createSWF=function(attObj,parObj,id){var att,el,i,j,m,n,o,par,r;if(r=void 0,el=getElementById(id),ua.wk&&ua.wk<312)return r;if(el)if(typeof attObj.id===UNDEF&&(attObj.id=id),ua.ie&&ua.win){att="";for(i in attObj)attObj[i]!==Object.prototype[i]&&("data"===i.toLowerCase()?parObj.movie=attObj[i]:"styleclass"===i.toLowerCase()?att+=' class="'+attObj[i]+'"':"classid"!==i.toLowerCase()&&(att+=" "+i+'="'+attObj[i]+'"'));par="";for(j in parObj)parObj[j]!==Object.prototype[j]&&(par+='<param name="'+j+'" value="'+parObj[j]+'" />');el.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+att+">"+par+"</object>",objIdArr[objIdArr.length]=attObj.id,r=getElementById(attObj.id)}else{o=createElement(OBJECT),o.setAttribute("type",FLASH_MIME_TYPE);for(m in attObj)attObj[m]!==Object.prototype[m]&&("styleclass"===m.toLowerCase()?o.setAttribute("class",attObj[m]):"classid"!==m.toLowerCase()&&o.setAttribute(m,attObj[m]));for(n in parObj)parObj[n]!==Object.prototype[n]&&"movie"!==n.toLowerCase()&&createObjParam(o,n,parObj[n]);el.parentNode.replaceChild(o,el),r=o}return r},createObjParam=function(el,pName,pValue){var p;return p=createElement("param"),p.setAttribute("name",pName),p.setAttribute("value",pValue),el.appendChild(p)},removeSWF=function(id){var obj;return obj=getElementById(id),obj&&"OBJECT"===obj.nodeName?ua.ie&&ua.win?(obj.style.display="none",function(){return 4===obj.readyState?removeObjectInIE(id):setTimeout(arguments.callee,10)}()):obj.parentNode.removeChild(obj):void 0},removeObjectInIE=function(id){var obj,thing;if(obj=getElementById(id)){for(var i$=0,length$=obj.length;length$>i$;++i$)thing=obj[i$],"function"==typeof thing&&(thing=null);return obj.parentNode.removeChild(obj)}},getElementById=function(id){var e,el;el=null;try{el=doc.getElementById(id)}catch(e$){e=e$}return el},createElement=function(el){return doc.createElement(el)},addListener=function(target,eventType,fn){return target.attachEvent(eventType,fn),listenersArr[listenersArr.length]=[target,eventType,fn]},hasPlayerVersion=function(rv){var pv,v;return pv=ua.pv,v=rv.split("."),v[0]=parseInt(v[0],10),v[1]=parseInt(v[1],10)||0,v[2]=parseInt(v[2],10)||0,null!=(pv[0]>v[0]||pv[0]===v[0]&&pv[1]>v[1]||pv[0]===v[0]&&pv[1]===v[1]&&pv[2]>=v[2])?pv[0]>v[0]||pv[0]===v[0]&&pv[1]>v[1]||pv[0]===v[0]&&pv[1]===v[1]&&pv[2]>=v[2]:{"true":!1}},createCSS=function(sel,decl,media,newStyle){var h,m,s;if((!ua.ie||!ua.mac)&&(h=doc.getElementsByTagName("head")[0]))if(m=null!=(media&&"string"==typeof media)?media&&"string"==typeof media:{media:"screen"},newStyle&&(dynamicStylesheet=null,dynamicStylesheetMedia=null),dynamicStylesheet&&dynamicStylesheetMedia===m||(s=createElement("style"),s.setAttribute("type","text/css"),s.setAttribute("media",m),dynamicStylesheet=h.appendChild(s),ua.ie&&ua.win&&typeof doc.styleSheets!==UNDEF&&doc.styleSheets.length>0&&(dynamicStylesheet=doc.styleSheets[doc.styleSheets.length-1]),dynamicStylesheetMedia=m),ua.ie&&ua.win){if(dynamicStylesheet&&typeof dynamicStylesheet.addRule===OBJECT)return dynamicStylesheet.addRule(sel,decl)}else if(dynamicStylesheet&&typeof doc.createTextNode!==UNDEF)return dynamicStylesheet.appendChild(doc.createTextNode(sel+" {"+decl+"}"))},setVisibility=function(id,isVisible){var v;if(autoHideShow)return v=null!=isVisible?isVisible:{visible:"hidden"},isDomLoaded&&getElementById(id)?getElementById(id).style.visibility=v:createCSS("#"+id,"visibility:"+v)},urlEncodeIfNecessary=function(s){var hasBadChars,regex;return regex=/[\\\"<>\.;]/,hasBadChars=null!==regex.exec(s),hasBadChars&&typeof encodeURIComponent!==(UNDEF?encodeURIComponent(s):s)},ua=function(){var a,d,e,ie,mac,p,playerVersion,u,w3cdom,webkit,windows;if(w3cdom=typeof doc.getElementById!==UNDEF&&typeof doc.getElementsByTagName!==UNDEF&&typeof doc.createElement!==UNDEF,u=nav.userAgent.toLowerCase(),p=nav.platform.toLowerCase(),windows=p?/win/.test(p):/win/.test(u),mac=p?/mac/.test(p):/mac/.test(u),webkit=/webkit/.test(u)?parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,ie=!1,playerVersion=[0,0,0],d=null,typeof nav.plugins!==UNDEF&&typeof nav.plugins[SHOCKWAVE_FLASH]===OBJECT)d=nav.plugins[SHOCKWAVE_FLASH].description,!d||typeof nav.mimeTypes!==UNDEF&&nav.mimeTypes[FLASH_MIME_TYPE]&&!nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin||(plugin=!0,ie=!1,d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),playerVersion[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10),playerVersion[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10),playerVersion[2]=/[a-zA-Z]/.test(d)?parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);
else if(typeof win.ActiveXObject!==UNDEF)try{a=new ActiveXObject(SHOCKWAVE_FLASH_AX),a&&(d=a.GetVariable("$version"),d&&(ie=!0,d=d.split(" ")[1].split(","),playerVersion=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]))}catch(e$){e=e$}return{w3:w3cdom,pv:playerVersion,wk:webkit,ie:ie,win:windows,mac:mac}}(),onDomLoad=function(){return ua.w3?((typeof doc.readyState!==UNDEF&&"complete"===doc.readyState||typeof doc.readyState===UNDEF&&(doc.getElementsByTagName("body")[0]||doc.body))&&callDomLoadFunctions(),isDomLoaded?void 0:(typeof doc.addEventListener!==UNDEF&&doc.addEventListener("DOMContentLoaded",callDomLoadFunctions,!1),ua.ie&&ua.win&&(doc.attachEvent(ON_READY_STATE_CHANGE,function(){return"complete"===doc.readyState?(doc.detachEvent(ON_READY_STATE_CHANGE,arguments.callee),callDomLoadFunctions()):void 0}),win===top&&function(){var e;if(!isDomLoaded){try{doc.documentElement.doScroll("left")}catch(e$){return e=e$,setTimeout(arguments.callee,0),void 0}return callDomLoadFunctions()}}()),ua.wk&&function(){return isDomLoaded?void 0:/loaded|complete/.test(doc.readyState)?callDomLoadFunctions():(setTimeout(arguments.callee,0),void 0)}(),addLoadEvent(callDomLoadFunctions))):void 0}(),cleanup=function(){return ua.ie&&ua.win?window.attachEvent("onunload",function(){for(var k,l,listener,obj,swfobject,i$=0,length$=listenersArr.length;length$>i$;++i$)listener=listenersArr[i$],listener[0].detachEvent(listener[1],listener[2]);for(var i$1=0,length$1=objIdArr.length;length$1>i$1;++i$1)obj=objIdArr[i$1],removeSWF(obj);for(k in ua)ua[k]=null;ua=null;for(l in swfobject)swfobject[l]=null;return swfobject=null}):void 0}(),{registerObject:function(objectIdStr,swfVersionStr,xiSwfUrlStr,callbackFn){var regObj;return ua.w3&&objectIdStr&&swfVersionStr?(regObj={},regObj.id=objectIdStr,regObj.swfVersion=swfVersionStr,regObj.expressInstall=xiSwfUrlStr,regObj.callbackFn=callbackFn,regObjArr[regObjArr.length]=regObj,setVisibility(objectIdStr,!1)):"function"==typeof callbackFn?callbackFn({success:!1,id:objectIdStr}):void 0},getObjectById:function(objectIdStr){return ua.w3?getObjectById(objectIdStr):void 0},embedSWF:function(swfUrlStr,replaceElemIdStr,widthStr,heightStr,swfVersionStr,xiSwfUrlStr,flashvarsObj,parObj,attObj,callbackFn){var callbackObj;return callbackObj={success:!1,id:replaceElemIdStr},ua.w3&&!(ua.wk&&ua.wk<312)&&swfUrlStr&&replaceElemIdStr&&widthStr&&heightStr&&swfVersionStr?(setVisibility(replaceElemIdStr,!1),addDomLoadEvent(function(){var att,i,j,k,obj,par;if(widthStr+="",heightStr+="",att={},attObj&&typeof attObj===OBJECT)for(i in attObj)att[i]=attObj[i];if(att.data=swfUrlStr,att.width=widthStr,att.height=heightStr,par={},parObj&&typeof parObj===OBJECT)for(j in parObj)par[j]=parObj[j];if(flashvarsObj&&typeof flashvarsObj===OBJECT)for(k in flashvarsObj)typeof par.flashvars!==UNDEF?par.flashvars+="&"+k+"="+flashvarsObj[k]:par.flashvars=k+"="+flashvarsObj[k];if(hasPlayerVersion(swfVersionStr))obj=createSWF(att,par,replaceElemIdStr),att.id===replaceElemIdStr&&setVisibility(replaceElemIdStr,!0),callbackObj.success=!0,callbackObj.ref=obj;else{if(xiSwfUrlStr&&canExpressInstall())return att.data=xiSwfUrlStr,showExpressInstall(att,par,replaceElemIdStr,callbackFn),void 0;setVisibility(replaceElemIdStr,!0)}return"function"==typeof callbackFn?callbackFn(callbackObj):void 0})):"function"==typeof callbackFn?callbackFn(callbackObj):void 0},switchOffAutoHideShow:function(){return autoHideShow=!1},ua:ua,getFlashPlayerVersion:function(){return{major:ua.pv[0],minor:ua.pv[1],release:ua.pv[2]}},hasFlashPlayerVersion:hasPlayerVersion,createSWF:function(attObj,parObj,replaceElemIdStr){return ua.w3?createSWF(attObj,parObj,replaceElemIdStr):void 0},showExpressInstall:function(att,par,replaceElemIdStr,callbackFn){return ua.w3&&canExpressInstall()?showExpressInstall(att,par,replaceElemIdStr,callbackFn):void 0},removeSWF:function(objElemIdStr){return ua.w3?removeSWF(objElemIdStr):void 0},createCSS:function(selStr,declStr,mediaStr,newStyleBoolean){return ua.w3?createCSS(selStr,declStr,mediaStr,newStyleBoolean):void 0},addDomLoadEvent:addDomLoadEvent,addLoadEvent:addLoadEvent,getQueryParamValue:function(param){var pair,pairs,q;if(q=doc.location.search||doc.location.hash){if(/\?/.test(q)&&(q=q.split("?")[1]),null===param)return urlEncodeIfNecessary(q);pairs=q.split("&");for(var i$=0,length$=pairs.length;length$>i$;++i$)if(pair=pairs[i$],pair.substring(0,pair.indexOf("="))===param)return urlEncodeIfNecessary(pair.substring(pair.indexOf("=")+1))}return""},expressInstallCallback:function(){var obj;return isExpressInstallActive?(obj=getElementById(EXPRESS_INSTALL_ID),obj&&storedAltContent&&(obj.parentNode.replaceChild(storedAltContent,obj),storedAltContentId&&(setVisibility(storedAltContentId,!0),ua.ie&&ua.win&&(storedAltContent.style.display="block")),storedCallbackFn&&storedCallbackFn(storedCallbackObj)),isExpressInstallActive=!1):void 0}}}(),null!=window.DetectFlash?window.DetectFlash:window.DetectFlash={},DetectFlash.hasFlash=swfobject.hasFlashPlayerVersion("1"),void function(){var DEFAULT_EL;null!=window.DealCarousel?window.DealCarousel:window.DealCarousel={},DEFAULT_EL=".featured-image",DealCarousel.Helpers={getMedia:function(carousel){var cache$,dealImages,dealVideos,forceVideos,media,showVideos,videoPosition;return cache$=carousel,dealImages=cache$.dealImages,forceVideos=cache$.forceVideos,dealVideos=cache$.dealVideos,videoPosition=cache$.videoPosition,media=dealImages.slice(0),showVideos=forceVideos||DetectFlash.hasFlash||!!("undefined"!=typeof Modernizr&&null!=Modernizr?Modernizr.video:void 0),showVideos&&(null!=dealVideos?dealVideos.length:void 0)>0&&media.splice(videoPosition,0,dealVideos[0]),{media:media,showVideos:showVideos}},prepareCarouselOptions:function(carousel,currentDealMedia,featuredImage,i18n){var cache$,carouselOptions,dealId,el,imageZoomState,mediaHeight,showThumbs,zoomMessage;switch(cache$=carousel,el=cache$.el,imageZoomState=cache$.imageZoomState,mediaHeight=cache$.mediaHeight,dealId=cache$.dealId,showThumbs=cache$.showThumbs,imageZoomState){case"hover":zoomMessage=i18n.t(".hoverZoom");break;case"click":zoomMessage=i18n.t(".clickZoom");break;default:zoomMessage=!1}return carouselOptions={collection:currentDealMedia,el:el||DEFAULT_EL,imageZoomState:imageZoomState,mediaHeight:mediaHeight,showThumbs:showThumbs,uuid:dealId,zoomMessage:zoomMessage},null!=featuredImage&&(carouselOptions.featured=currentDealMedia.findWhere({baseURL:featuredImage})),carouselOptions},setVideoLoaderFlags:function(showVideos,carousel){var loadKaltura,loadOoyala,video;if(loadKaltura=!1,loadOoyala=!1,showVideos&&("undefined"==typeof kWidget||null==kWidget||"undefined"==typeof OO||null==OO))for(var cache$=carousel.dealVideos||[],i$=0,length$=cache$.length;length$>i$;++i$)video=cache$[i$],loadKaltura||"KALTURA"!==video.provider||(loadKaltura=!0),loadOoyala||"OOYALA"!==video.provider||(loadOoyala=!0);return{loadKaltura:loadKaltura,loadOoyala:loadOoyala}},loadVideoScripts:function(carousel,currentCarouselView,loadKaltura,loadOoyala){return!loadKaltura||"undefined"!=typeof kWidget&&null!=kWidget||$.getScript(carousel.kalturaScriptUrl).fail(function(){return currentCarouselView.collection.remove(currentCarouselView.collection.where({provider:"KALTURA"})),currentCarouselView.collection.classes.indexOf("script-load-fail")>-1||(currentCarouselView.collection.classes+=" script-load-fail"),currentCarouselView.render()}),!loadOoyala||"undefined"!=typeof OO&&null!=OO?void 0:$.getScript(carousel.ooyalaScriptUrl).fail(function(){return currentCarouselView.collection.remove(currentCarouselView.collection.where({provider:"OOYALA"})),currentCarouselView.collection.classes.indexOf("script-load-fail")>-1||(currentCarouselView.collection.classes+=" script-load-fail"),currentCarouselView.render()})}}}.call(this),null!=window.DealCarousel?window.DealCarousel:window.DealCarousel={},DealCarousel.Media=Backbone.Model.extend({initialize:function(param$){var cache$;return null==param$&&(param$={}),cache$=param$,this.id=cache$.id,this.type=cache$.type,this.media=cache$.media,this.thumb=cache$.thumb,this.provider=cache$.provider,this.baseURL=cache$.baseURL,null!=this.id?this.id:this.id=this.cid},isFeatured:function(){return(null!=this.collection?this.collection.view.currentFeatured:void 0)===this},isLast:function(){return(null!=this.collection?this.collection.last():void 0)===this},isVideo:function(){return"video"===this.type}});/*
 *  Copyright 2011 Twitter, Inc.
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
var Hogan={};!function(Hogan,useArrayBuffer){function coerceToString(val){return String(null===val||void 0===val?"":val)}function hoganEscape(str){return str=coerceToString(str),hChars.test(str)?str.replace(rAmp,"&amp;").replace(rLt,"&lt;").replace(rGt,"&gt;").replace(rApos,"&#39;").replace(rQuot,"&quot;"):str}Hogan.Template=function(renderFunc,text,compiler,options){this.r=renderFunc||this.r,this.c=compiler,this.options=options,this.text=text||"",this.buf=useArrayBuffer?[]:""},Hogan.Template.prototype={r:function(){return""},v:hoganEscape,t:coerceToString,render:function(context,partials,indent){return this.ri([context],partials||{},indent)},ri:function(context,partials,indent){return this.r(context,partials,indent)},rp:function(name,context,partials,indent){var partial=partials[name];return partial?(this.c&&"string"==typeof partial&&(partial=this.c.compile(partial,this.options)),partial.ri(context,partials,indent)):""},rs:function(context,partials,section){var tail=context[context.length-1];if(!isArray(tail))return section(context,partials,this),void 0;for(var i=0;i<tail.length;i++)context.push(tail[i]),section(context,partials,this),context.pop()},s:function(val,ctx,partials,inverted,start,end,tags){var pass;return isArray(val)&&0===val.length?!1:("function"==typeof val&&(val=this.ls(val,ctx,partials,inverted,start,end,tags)),pass=""===val||!!val,!inverted&&pass&&ctx&&ctx.push("object"==typeof val?val:ctx[ctx.length-1]),pass)},d:function(key,ctx,partials,returnFound){var names=key.split("."),val=this.f(names[0],ctx,partials,returnFound),cx=null;if("."===key&&isArray(ctx[ctx.length-2]))return ctx[ctx.length-1];for(var i=1;i<names.length;i++)val&&"object"==typeof val&&names[i]in val?(cx=val,val=val[names[i]]):val="";return returnFound&&!val?!1:(returnFound||"function"!=typeof val||(ctx.push(cx),val=this.lv(val,ctx,partials),ctx.pop()),val)},f:function(key,ctx,partials,returnFound){for(var val=!1,v=null,found=!1,i=ctx.length-1;i>=0;i--)if(v=ctx[i],v&&"object"==typeof v&&key in v){val=v[key],found=!0;break}return found?(returnFound||"function"!=typeof val||(val=this.lv(val,ctx,partials)),val):returnFound?!1:""},ho:function(val,cx,partials,text,tags){var compiler=this.c,options=this.options;options.delimiters=tags;var text=val.call(cx,text);return text=null==text?String(text):text.toString(),this.b(compiler.compile(text,options).render(cx,partials)),!1},b:useArrayBuffer?function(s){this.buf.push(s)}:function(s){this.buf+=s},fl:useArrayBuffer?function(){var r=this.buf.join("");return this.buf=[],r}:function(){var r=this.buf;return this.buf="",r},ls:function(val,ctx,partials,inverted,start,end,tags){var cx=ctx[ctx.length-1],t=null;if(!inverted&&this.c&&val.length>0)return this.ho(val,cx,partials,this.text.substring(start,end),tags);if(t=val.call(cx),"function"==typeof t){if(inverted)return!0;if(this.c)return this.ho(t,cx,partials,this.text.substring(start,end),tags)}return t},lv:function(val,ctx,partials){var cx=ctx[ctx.length-1],result=val.call(cx);return"function"==typeof result&&(result=coerceToString(result.call(cx)),this.c&&~result.indexOf("{{"))?this.c.compile(result,this.options).render(cx,partials):coerceToString(result)}};var rAmp=/&/g,rLt=/</g,rGt=/>/g,rApos=/\'/g,rQuot=/\"/g,hChars=/[&<>\"\']/,isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}}("undefined"!=typeof exports?exports:Hogan),function(Hogan){function cleanTripleStache(token){"}"===token.n.substr(token.n.length-1)&&(token.n=token.n.substring(0,token.n.length-1))}function trim(s){return s.trim?s.trim():s.replace(/^\s*|\s*$/g,"")}function tagChange(tag,text,index){if(text.charAt(index)!=tag.charAt(0))return!1;for(var i=1,l=tag.length;l>i;i++)if(text.charAt(index+i)!=tag.charAt(i))return!1;return!0}function buildTree(tokens,kind,stack,customTags){for(var instructions=[],opener=null,token=null;tokens.length>0;)if(token=tokens.shift(),"#"==token.tag||"^"==token.tag||isOpener(token,customTags))stack.push(token),token.nodes=buildTree(tokens,token.tag,stack,customTags),instructions.push(token);else{if("/"==token.tag){if(0===stack.length)throw new Error("Closing tag without opener: /"+token.n);if(opener=stack.pop(),token.n!=opener.n&&!isCloser(token.n,opener.n,customTags))throw new Error("Nesting error: "+opener.n+" vs. "+token.n);return opener.end=token.i,instructions}instructions.push(token)}if(stack.length>0)throw new Error("missing closing tag: "+stack.pop().n);return instructions}function isOpener(token,tags){for(var i=0,l=tags.length;l>i;i++)if(tags[i].o==token.n)return token.tag="#",!0}function isCloser(close,open,tags){for(var i=0,l=tags.length;l>i;i++)if(tags[i].c==close&&tags[i].o==open)return!0}function esc(s){return s.replace(rSlash,"\\\\").replace(rQuot,'\\"').replace(rNewline,"\\n").replace(rCr,"\\r")}function chooseMethod(s){return~s.indexOf(".")?"d":"f"}function walk(tree){for(var code="",i=0,l=tree.length;l>i;i++){var tag=tree[i].tag;"#"==tag?code+=section(tree[i].nodes,tree[i].n,chooseMethod(tree[i].n),tree[i].i,tree[i].end,tree[i].otag+" "+tree[i].ctag):"^"==tag?code+=invertedSection(tree[i].nodes,tree[i].n,chooseMethod(tree[i].n)):"<"==tag||">"==tag?code+=partial(tree[i]):"{"==tag||"&"==tag?code+=tripleStache(tree[i].n,chooseMethod(tree[i].n)):"\n"==tag?code+=text('"\\n"'+(tree.length-1==i?"":" + i")):"_v"==tag?code+=variable(tree[i].n,chooseMethod(tree[i].n)):void 0===tag&&(code+=text('"'+esc(tree[i])+'"'))}return code}function section(nodes,id,method,start,end,tags){return"if(_.s(_."+method+'("'+esc(id)+'",c,p,1),'+"c,p,0,"+start+","+end+',"'+tags+'")){'+"_.rs(c,p,"+"function(c,p,_){"+walk(nodes)+"});c.pop();}"}function invertedSection(nodes,id,method){return"if(!_.s(_."+method+'("'+esc(id)+'",c,p,1),c,p,1,0,0,"")){'+walk(nodes)+"};"}function partial(tok){return'_.b(_.rp("'+esc(tok.n)+'",c,p,"'+(tok.indent||"")+'"));'}function tripleStache(id,method){return"_.b(_.t(_."+method+'("'+esc(id)+'",c,p,0)));'}function variable(id,method){return"_.b(_.v(_."+method+'("'+esc(id)+'",c,p,0)));'}function text(id){return"_.b("+id+");"}var rIsWhitespace=/\S/,rQuot=/\"/g,rNewline=/\n/g,rCr=/\r/g,rSlash=/\\/g,tagTypes={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};Hogan.scan=function(text,delimiters){function addBuf(){buf.length>0&&(tokens.push(new String(buf)),buf="")}function lineIsWhitespace(){for(var isAllWhitespace=!0,j=lineStart;j<tokens.length;j++)if(isAllWhitespace=tokens[j].tag&&tagTypes[tokens[j].tag]<tagTypes._v||!tokens[j].tag&&null===tokens[j].match(rIsWhitespace),!isAllWhitespace)return!1;return isAllWhitespace}function filterLine(haveSeenTag,noNewLine){if(addBuf(),haveSeenTag&&lineIsWhitespace())for(var next,j=lineStart;j<tokens.length;j++)tokens[j].tag||((next=tokens[j+1])&&">"==next.tag&&(next.indent=tokens[j].toString()),tokens.splice(j,1));else noNewLine||tokens.push({tag:"\n"});seenTag=!1,lineStart=tokens.length}function changeDelimiters(text,index){var close="="+ctag,closeIndex=text.indexOf(close,index),delimiters=trim(text.substring(text.indexOf("=",index)+1,closeIndex)).split(" ");return otag=delimiters[0],ctag=delimiters[1],closeIndex+close.length-1}var len=text.length,IN_TEXT=0,IN_TAG_TYPE=1,IN_TAG=2,state=IN_TEXT,tagType=null,tag=null,buf="",tokens=[],seenTag=!1,i=0,lineStart=0,otag="{{",ctag="}}";for(delimiters&&(delimiters=delimiters.split(" "),otag=delimiters[0],ctag=delimiters[1]),i=0;len>i;i++)state==IN_TEXT?tagChange(otag,text,i)?(--i,addBuf(),state=IN_TAG_TYPE):"\n"==text.charAt(i)?filterLine(seenTag):buf+=text.charAt(i):state==IN_TAG_TYPE?(i+=otag.length-1,tag=tagTypes[text.charAt(i+1)],tagType=tag?text.charAt(i+1):"_v","="==tagType?(i=changeDelimiters(text,i),state=IN_TEXT):(tag&&i++,state=IN_TAG),seenTag=i):tagChange(ctag,text,i)?(tokens.push({tag:tagType,n:trim(buf),otag:otag,ctag:ctag,i:"/"==tagType?seenTag-ctag.length:i+otag.length}),buf="",i+=ctag.length-1,state=IN_TEXT,"{"==tagType&&("}}"==ctag?i++:cleanTripleStache(tokens[tokens.length-1]))):buf+=text.charAt(i);return filterLine(seenTag,!0),tokens},Hogan.generate=function(tree,text,options){var code='var _=this;_.b(i=i||"");'+walk(tree)+"return _.fl();";return options.asString?"function(c,p,i){"+code+";}":new Hogan.Template(new Function("c","p","i",code),text,Hogan,options)},Hogan.parse=function(tokens,text,options){return options=options||{},buildTree(tokens,"",[],options.sectionTags||[])},Hogan.cache={},Hogan.compile=function(text,options){options=options||{};var key=text+"||"+!!options.asString,t=this.cache[key];return t?t:(t=this.generate(this.parse(this.scan(text,options.delimiters),text,options),text,options),this.cache[key]=t)}}("undefined"!=typeof exports?exports:Hogan),null!=window.DealCarousel?window.DealCarousel:window.DealCarousel={},DealCarousel.CarouselTemplate=Hogan.compile('{{# renderFullCarousel }}\n  <div class="gallery {{ classes }}" data-bhw="PromNightGallery" data-bhc="PromNightGallery:{{ uuid }}">\n    <div class="gallery-featured">\n      <div class="click-blocker"></div>\n      {{# featured }}\n        {{# isVideo }}\n          <img src="http://cdnapi.kaltura.com/p/1302621/thumbnail/entry_id/{{ media }}/height/{{ collection.view.options.mediaHeight}}" id="gallery-video-{{ id }}" data-id="{{ id }}" />\n        {{/ isVideo }}\n        {{^ isVideo }}\n          <img src="{{ media }}" id="gallery-image-{{ id }}" data-id="{{ id }}" />\n        {{/ isVideo }}\n      {{/ featured }}\n    </div>\n\n    {{# showThumbs }}\n      <ul class="gallery-thumbs">\n        {{# models }}\n          <li class="gallery-thumbnail{{# isFeatured }} selected{{/ isFeatured }}{{# isVideo }} video{{/ isVideo }}{{^ thumb }} no-thumbnail{{/ thumb }}{{# isLast }} last{{/ isLast }}" id="gallery-thumb-{{ id }}" data-id="{{ id }}" data-bhc="thumbnail_click:{{ id }}"{{# isVideo }} data-bhd="{{ videoBHD }}"{{/ isVideo }}>{{# thumb }}<img src="{{ thumb }}" />{{/ thumb }}</li>\n        {{/ models }}\n      </ul>\n    {{/ showThumbs }}\n\n    <div class="gallery-controls">\n      {{# zoomMessage }}\n        <div class="image-zoom"></div>\n        <div class="image-zoom-label">\n          <span class="icon-zoom">\n            &nbsp;{{ zoomMessage }}\n          </span>\n        </div>\n      {{/ zoomMessage }}\n\n      {{# showThumbs }}\n        <div class="gallery-control-back icon-arrow-left-large disabled" data-bhc="thumbnail_back:{{ uuid }}"></div>\n        <div class="gallery-control-forward icon-arrow-right-large" data-bhc="thumbnail_forward:{{ uuid }}"></div>\n      {{/ showThumbs }}\n\n      <div class="gallery-control-left icon-arrow-left-large disabled" data-bhc="bumper_left:{{ uuid }}"></div>\n      <div class="gallery-control-right icon-arrow-right-large" data-bhc="bumper_right:{{ uuid }}"></div>\n    </div>\n  </div>\n{{/ renderFullCarousel }}\n{{^ renderFullCarousel }}\n  <div class="gallery-single">\n    <div class="gallery-featured">\n      {{# first }}\n        <img class="featured-image" src="{{ media }}" data-id="{{ id }}" />\n      {{/ first }}\n    </div>\n    <div class="gallery-controls">\n      {{# zoomMessage }}\n        <div class="image-zoom"></div>\n        <div class="image-zoom-label">\n          <span class="icon-zoom">\n            &nbsp;{{ zoomMessage }}\n          </span>\n        </div>\n      {{/ zoomMessage }}\n    </div>\n  </div>\n{{/ renderFullCarousel }}'),void function(){var IMAGE_ASPECT_RATION,IZ_DOUBLE_HEIGHT,IZ_DOUBLE_WIDTH,IZ_EXT_DOUBLE,IZ_EXT_TRIPLE,IZ_TRIPLE_HEIGHT,IZ_TRIPLE_WIDTH,RETRIEVE_IMAGE_DIMENSIONS_REGEX,TABLET_MQ_WIDTH;TABLET_MQ_WIDTH=768,IMAGE_ASPECT_RATION=.6,IZ_DOUBLE_WIDTH=1400,IZ_DOUBLE_HEIGHT=840,IZ_TRIPLE_WIDTH=2100,IZ_TRIPLE_HEIGHT=1260,RETRIEVE_IMAGE_DIMENSIONS_REGEX=/\/\w+-(\d+x\d+)?\/v1/,IZ_EXT_DOUBLE="c"+IZ_DOUBLE_WIDTH+"x"+IZ_DOUBLE_HEIGHT+".jpg",IZ_EXT_TRIPLE="c"+IZ_TRIPLE_WIDTH+"x"+IZ_TRIPLE_HEIGHT+".jpg",null!=window.DealCarousel?window.DealCarousel:window.DealCarousel={},DealCarousel.View=Backbone.View.extend({events:{"click .gallery-control-back":"onBackClick","click .gallery-control-forward":"onForwardClick","click .gallery-control-left":"onLeftClick","click .gallery-control-right":"onRightClick","click .gallery-thumbnail":"onThumbnailClick","mouseenter .image-zoom":"_startImageZoom","mouseleave .gallery-controls":"_disableImageZoom","click .image-zoom":"_toggleImageZoom"},initialize:function(){return null!=this.$el?this.$el:this.$el=$(this.el),this.currentFeatured=this.options.featured||this.collection.first(),this.collection.classes="",this.collection.view=this,this.collection.videoBHD=JSON.stringify({video:!0}),this.collection.featured=function(this$){return function(){return this$.currentFeatured}}(this),this.collection.uuid=this.options.uuid,this.collection.renderFullCarousel=this.collection.length>1,this.collection.showThumbs=this.options.showThumbs,this.imageZoomState=this.options.imageZoomState,this.imageZoomActive=!1},render:function(){var bodyWidth,el,featuredIndex,height,renderOptions;return this.$el=$(this.el),renderOptions=_.extend({zoomMessage:this.options.zoomMessage},this.collection),el=DealCarousel.CarouselTemplate.render(renderOptions),this.$el=$(el).replaceAll(this.$el),this.el=this.$el[0],this.$thumbs=this.$el.find(".gallery-thumbs"),this.$thumbnails=this.$thumbs.children(),this.$gallery=this.$el.find(".gallery-featured"),this.$galleryMedia=this.$gallery.find("img"),this.$clickBlocker=this.$el.find(".click-blocker"),this.$controls=this.$el.find(".gallery-controls"),this.$backButton=this.$controls.find(".gallery-control-back"),this.$forwardButton=this.$controls.find(".gallery-control-forward"),this.$leftButton=this.$controls.find(".gallery-control-left"),this.$rightButton=this.$controls.find(".gallery-control-right"),this.containerWidth=this.$el.width(),this.insideContainerWidth=this.containerWidth-this.$backButton.width()-this.$forwardButton.width(),this.$body=$(document.body),this.rtl=this.$body.hasClass("rtl"),this.animateViaJS=!this.$body.parent("html").hasClass("cssanimations"),this.thumbsWidth=this.$thumbs.width(),this.thumbWidth=this.$thumbs.children().outerWidth(),this.thumbMargin=this.rtl?parseInt(this.$thumbs.children().css("margin-left")):parseInt(this.$thumbs.children().css("margin-right")),this.thumbsWidth=this._calculateThumbsWidth(),this.media={},this.currentPosition=0,this.hasOverflow=this.thumbsWidth>this.containerWidth,("click"===this.imageZoomState||"hover"===this.imageZoomState)&&(this.$imageZoom=this.$el.find(".image-zoom"),this.$imageZoomLabel=this.$el.find(".image-zoom-label"),this.carouselOffset=this.$imageZoom.offset(),this.lastZoomTime=Date.now(),this._zoomBackgroundImage()),this.options.mediaHeight<this.$galleryMedia.height()||0===this.$galleryMedia.height()?(bodyWidth=this.$body.width(),bodyWidth>TABLET_MQ_WIDTH?this.setFeaturedHeight(this.options.mediaHeight):(height=IMAGE_ASPECT_RATIO*this.containerWidth,this.setFeaturedHeight(height))):this.setFeaturedHeight(this.$galleryMedia.height()),this.centerThumbs(),featuredIndex=this.collection.indexOf(this.currentFeatured),this.fetchInitialMedia(featuredIndex),this._prepareGroups(),0!==featuredIndex&&this._adjustThumbs(featuredIndex),this.delegateEvents()},centerThumbs:function(){var direction;return this.thumbsWidth=this._calculateThumbsWidth(),this.$thumbs.width(this.thumbsWidth),this.hasOverflow?(direction=this.rtl?"right":"left",this.visibleThumbs=Math.floor(this.insideContainerWidth/this.thumbWidth),this.visibleThumbs--,this.$el.addClass("has-navigation"),this.$thumbs.css(direction,this.$backButton.width()+this.thumbMargin)):this.visibleThumbs=this.$thumbnails.length},fetchMedia:function(index){var media;return media=this.collection.at(index),null!=this.media[media.id]?!1:"video"===media.type?this.fetchVideo(media):this.fetchImage(media)},fetchImage:function(image){var $newImage,newImage;return newImage=new Image,newImage.src=image.media,$newImage=$(newImage),$newImage.data("id",image.id),$newImage.attr("id","gallery-image-"+image.id),this.media[image.id]=$newImage},fetchVideo:function(video){var playerId;return playerId="KALTURA"===video.provider?"kaltura-player-1360194818":"OOYALA"===video.provider?"ooyala-player":void 0,this.media[video.id]=$("<div/>",{id:"video-container"}).attr("data-bhw","PromNightVideo").html('<div id="'+playerId+'" style="width:'+this.containerWidth+"px; height:"+this.options.mediaHeight+'px; margin: 0 auto;"></div>')},fetchInitialMedia:function(start){var collectionSize,loadCount;return null==start&&(start=0),collectionSize=this.collection.size(),loadCount=this.visibleThumbs,start+loadCount>collectionSize&&(loadCount=collectionSize-start),function(accum$){for(var i,cache$=function(){var accum$1;accum$1=[];for(var i$=start;start+loadCount>=start?start+loadCount>i$:i$>start+loadCount;start+loadCount>=start?++i$:--i$)accum$1.push(i$);return accum$1}.apply(this,arguments),i$=0,length$=cache$.length;length$>i$;++i$)i=cache$[i$],accum$.push(this.fetchMedia(i));return accum$}.call(this,[])},onBackClick:function(){return this.hasOverflow?(this.activeGroup>0?this.activeGroup--:this.activeGroup=this.totalGroups-1,this._updateThumbsPosition()):void 0},onForwardClick:function(){return this.hasOverflow?(this.activeGroup<this.totalGroups-1?this.activeGroup++:this.activeGroup=0,this._updateThumbsPosition()):void 0},onLeftClick:function(){var currentThumb,newMedia;return currentThumb=this.collection.indexOf(this.currentFeatured),currentThumb>0?(newMedia=this.collection.at(currentThumb-1),this.updateGallery(newMedia)):(newMedia=this.collection.at(this.collection.length-1),this.updateGallery(newMedia)),this._setActiveGroup(),this._disableImageZoom()},onRightClick:function(){var currentThumb,newMedia;return currentThumb=this.collection.indexOf(this.currentFeatured),currentThumb<this.collection.size()-1?(newMedia=this.collection.at(currentThumb+1),this.updateGallery(newMedia)):(newMedia=this.collection.at(0),this.updateGallery(newMedia)),this._setActiveGroup(),this._disableImageZoom()},onThumbnailClick:function(e){var $thumb,newMedia;return $thumb=this.$thumbs.find(e.currentTarget),newMedia=this.collection.get($thumb.data("id")),newMedia!==this.currentFeatured?this.updateGallery(newMedia):void 0},playVideo:function(media){return"KALTURA"===media.provider?kWidget.embed({targetId:"kaltura-player-1360194818",cache_st:1360194818,wid:"_1302621",uiconf_id:"11486911",flashvars:{autoPlay:!0,streamerType:"hdnetwork",akamaiHD:{loadingPolicy:"preInitialize",asyncInit:"true"}},entry_id:media.media}):"OOYALA"===media.provider?this.videoPlayer=OO.Player.create("ooyala-player",media.media,{autoplay:!0}):void 0},setFeaturedHeight:function(mediaHeight){return this.$gallery.height(mediaHeight),this.$body.hasClass("goods")||this.$body.hasClass("getaways")||this.$body.hasClass("getaways-booking")||(mediaHeight+=3),this.$controls.height(mediaHeight)},updateGallery:function(newMedia){var $newGalleryMedia,isCurrentVideo,newGalleryMedia,newMediaIndex,onComplete,transitionCSS;return newMediaIndex=this.collection.indexOf(newMedia),this.media[newMedia.id]?newGalleryMedia=this.media[newMedia.id]:(this.fetchMedia(newMediaIndex),newGalleryMedia=this.media[newMedia.id]),$newGalleryMedia=$(newGalleryMedia),this.animateViaJS&&(transitionCSS={opacity:0},$newGalleryMedia.css(transitionCSS)),$newGalleryMedia.appendTo(this.$gallery),newMediaIndex>0?this.$leftButton.removeClass("disabled"):this.$leftButton.addClass("disabled"),newMediaIndex<this.collection.size()-1?this.$rightButton.removeClass("disabled"):this.$rightButton.addClass("disabled"),this._adjustThumbs(this.collection.indexOf(newMedia)),"video"===newMedia.type?(this.playVideo(newMedia),this.$clickBlocker.hide(),this.$controls.hide()):(this.$clickBlocker.show(),this.$controls.show()),isCurrentVideo="video"===this.currentFeatured.type,onComplete=function(this$){return function(){return this$.$gallery.children("[id^='gallery-']:not(#gallery-video-"+this$.currentFeatured.id+", #gallery-image-"+this$.currentFeatured.id+")").remove(),isCurrentVideo?(null!=this$.videoPlayer&&this$.videoPlayer.destroy(),this$.$gallery.children("#video-container").remove()):void 0}}(this),this.animateViaJS?(transitionCSS={opacity:1},$newGalleryMedia.animate(transitionCSS,{complete:onComplete},"slow")):setTimeout(onComplete,600),this.$thumbs.find("#gallery-thumb-"+newMedia.id).addClass("selected").siblings().removeClass("selected"),this.$galleryMedia=$newGalleryMedia,this.currentFeatured=newMedia,this.$body.trigger("carouselUpdate",{image:newMedia.baseURL,uuid:this.options.uuid})},updateCollection:function(param$){var currentHeight,singleImage;return this.collection=param$,this.collection?(singleImage=1===this.collection.length,singleImage&&(currentHeight=this.$el.height()),this.collection.uuid=this.options.uuid,this.collection.renderFullCarousel=!singleImage,this.currentFeatured=this.collection.first(),this.render(),singleImage?this.$el.css("min-height",currentHeight):void 0):void 0},_calculateThumbMargins:function(marginalia){return this.visibleThumbs>1?Math.floor(marginalia/(this.visibleThumbs-1)):Math.floor(marginalia)},_calculateThumbsWidth:function(){return(this.thumbWidth+this.thumbMargin)*this.$thumbnails.length-this.thumbMargin},_prepareGroups:function(){return this.thumbGroups=[],this.totalGroups=0,this.thumbsPerGroup=0,this.activeGroup=0,this.pnThumbWidth=this.thumbWidth+this.thumbMargin,this.pnThumbWrapWidth=this.$thumbnails.length*this.pnThumbWidth,this.hasOverflow?(this._setThumbsPerGroup(),this._setTotalGroups(),this._setThumbGroups(),this._setLastGroupThumbsShort(),this._setActiveGroup(),this._updateThumbsPosition()):void 0},_scrollThumbsPosition:function(){var direction,options;return direction=this.rtl?"right":"left",options={},options[direction]=-1*$(this.$thumbnails[this.currentPosition]).position()[direction]+this.$backButton.width(),this.animateViaJS?this.$thumbs.animate(options):this.$thumbs.css(options),0===this.currentPosition?this.$backButton.addClass("disabled"):this.$backButton.removeClass("disabled"),this.currentPosition===this.collection.size()-this.visibleThumbs?this.$forwardButton.addClass("disabled"):this.$forwardButton.removeClass("disabled")},_setActiveGroup:function(){var currentIndex,lastRange;return currentIndex=this.collection.indexOf(this.currentFeatured),lastRange=this.thumbGroups[this.totalGroups-1],function(accum$){for(var group,i,i$=0,length$=this.thumbGroups.length;length$>i$;++i$)group=this.thumbGroups[i$],i=i$,accum$.push(currentIndex>=group[0]&&currentIndex<=group[1]?this.activeGroup!==i?(this.activeGroup=i,this._updateThumbsPosition()):void 0:void 0);return accum$}.call(this,[])},_setLastGroupThumbsShort:function(){return this.thumbsShort=this.thumbsPerGroup-(this.thumbGroups[this.totalGroups-1][1]-this.thumbGroups[this.totalGroups-1][0]+1)},_setThumbGroups:function(){return function(accum$){for(var end,i,start,cache$=function(){var accum$1;accum$1=[];for(var i$=0;0<=this.totalGroups-1?i$<=this.totalGroups-1:i$>=this.totalGroups-1;0<=this.totalGroups-1?++i$:--i$)accum$1.push(i$);return accum$1}.apply(this,arguments),i$=0,length$=cache$.length;length$>i$;++i$)i=cache$[i$],start=i*this.thumbsPerGroup,end=start+this.thumbsPerGroup-1,end>=this.$thumbnails.length&&(end=this.$thumbnails.length-1),accum$.push(this.thumbGroups[i]=[start,end]);return accum$}.call(this,[])},_setThumbsPerGroup:function(){return this.thumbsPerGroup=Math.floor(this.insideContainerWidth/(this.thumbWidth+this.thumbMargin))},_setTotalGroups:function(){return this.totalGroups=Math.ceil(this.thumbsWidth/this.insideContainerWidth)},_updateThumbsPosition:function(){var direction,modifier,options;return modifier=0,this.activeGroup===this.totalGroups-1&&(modifier=(this.thumbWidth+this.thumbMargin)*this.thumbsShort),direction=this.rtl?"right":"left",options={},options[direction]=""+-1*((this.insideContainerWidth-this.thumbMargin)*this.activeGroup-modifier-this.$backButton.width()-this.thumbMargin)+"px",this.animateViaJS?this.$thumbs.animate(options):this.$thumbs.css(options)},_startImageZoom:function(){return"hover"===this.imageZoomState?this._performImageZoom():void 0},_disableImageZoom:function(){return("hover"===this.imageZoomState||"click"===this.imageZoomState&&this.imageZoomActive)&&(this.$imageZoom.fadeTo("normal",0),"click"===this.imageZoomState)?this.imageZoomActive=!this.imageZoomActive:void 0},_toggleImageZoom:function(){return"click"===this.imageZoomState?this.imageZoomActive?this._disableImageZoom():this._performImageZoom():void 0},_performImageZoom:function(){var message,zoomFactor;return zoomFactor=this._zoomBackgroundImage(),"click"===this.imageZoomState&&(this.imageZoomActive=!this.imageZoomActive),this.$imageZoom.fadeTo("normal",1),message="click"===this.imageZoomState?"ImageZoom-Click":"ImageZoom-Hover","undefined"!=typeof OptimizeSuite&&null!=OptimizeSuite&&null!=OptimizeSuite.TrackingHub&&OptimizeSuite.TrackingHub.add(message,{image:this.currentFeatured.baseURL}),this.$imageZoom.mousemove(function(this$){return function(e){var left,top;return e.timeStamp-this$.lastZoomTime>25?(this$.lastZoomTime=e.timeStamp,left=-1*(e.pageX-this$.carouselOffset.left)*zoomFactor,top=-1*(e.pageY-this$.carouselOffset.top)*zoomFactor,this$.$imageZoom.css("background-position",""+String(left)+"px "+String(top)+"px")):void 0}}(this))},_zoomBackgroundImage:function(){var zoomFactor;return zoomFactor=this._calculateZoomFactor(),this.$imageZoom.css("background-image","url('"+this.currentFeatured.baseURL+this._getImageExtension(zoomFactor)+"')"),zoomFactor},_calculateZoomFactor:function(){var cache$,height,width;return cache$=this._getImageDimensions(this.currentFeatured.baseURL),width=cache$[0],height=cache$[1],width>=IZ_TRIPLE_WIDTH&&height>=IZ_TRIPLE_HEIGHT?2:1},_getImageDimensions:function(baseUrl){var cache$,cache$1,dimensions,height,width;return dimensions=null!=(cache$=baseUrl.match(RETRIEVE_IMAGE_DIMENSIONS_REGEX))&&null!=cache$[1]?cache$[1].split("x"):void 0,2!==(null!=dimensions?dimensions.length:void 0)?[0,0]:(cache$1=dimensions,width=cache$1[0],height=cache$1[1],[parseInt(width,10),parseInt(height,10)])},_getImageExtension:function(factor){switch(factor){case 1:return IZ_EXT_DOUBLE;case 2:return IZ_EXT_TRIPLE;default:return IZ_EXT_DOUBLE}},_adjustThumbs:function(index){for(var group,i,i$=0,length$=this.thumbGroups.length;length$>i$;++i$)if(group=this.thumbGroups[i$],i=i$,index>=group[0]&&index<=group[1]&&this.activeGroup!==i){this.activeGroup=i,this._updateThumbsPosition();for(var cache$=function(){var accum$;accum$=[];for(var i$1=group[0];group[0]<=group[1]?i$1<=group[1]:i$1>=group[1];group[0]<=group[1]?++i$1:--i$1)accum$.push(i$1);return accum$}.apply(this,arguments),i$1=0,length$1=cache$.length;length$1>i$1;++i$1)i=cache$[i$1],this.fetchMedia(i);break}}})}.call(this),void function(){var cache$,getMedia,loadVideoScripts,prepareCarouselOptions,setVideoLoaderFlags;null!=window.DealCarousel?window.DealCarousel:window.DealCarousel={},DealCarousel.carouselViews={},DealCarousel.dealMedia={},DealCarousel.current={},cache$=DealCarousel.Helpers,getMedia=cache$.getMedia,prepareCarouselOptions=cache$.prepareCarouselOptions,setVideoLoaderFlags=cache$.setVideoLoaderFlags,loadVideoScripts=cache$.loadVideoScripts,DealCarousel.init=function(param$,done){var cache$1,cache$2,cache$3,cache$4,carousel,carouselOptions,currentCarouselView,currentDealMedia,dealId,enabled,featuredImage,loadKaltura,loadOoyala,media,showVideos;return cache$1=param$,carousel=cache$1.carousel,featuredImage=cache$1.featuredImage,cache$2=carousel,dealId=cache$2.dealId,(enabled=cache$2.enabled)?(cache$3=getMedia(carousel),media=cache$3.media,showVideos=cache$3.showVideos,null!=this.i18n?this.i18n:this.i18n=I18n.scoped("modules.carousel"),this.dealMedia[dealId]=currentDealMedia=new Backbone.Collection(media,{model:DealCarousel.Media}),this.current.currentDealMedia=currentDealMedia,carouselOptions=prepareCarouselOptions(carousel,currentDealMedia,featuredImage,this.i18n),this.carouselViews[dealId]=currentCarouselView=new DealCarousel.View(carouselOptions),this.current.currentCarouselView=currentCarouselView,cache$4=setVideoLoaderFlags(showVideos,carousel),loadKaltura=cache$4.loadKaltura,loadOoyala=cache$4.loadOoyala,$(function(){return loadVideoScripts(carousel,currentCarouselView,loadKaltura,loadOoyala),currentCarouselView.render(),"function"==typeof done?done():void 0})):"function"==typeof done?done():void 0},DealCarousel.updateCurrent=function(param$){var cache$1,cache$2,cache$3,cache$4,carousel,carouselOptions,dealId,enabled,featuredImage,loadKaltura,loadOoyala,media,showVideos;return cache$1=param$,carousel=cache$1.carousel,featuredImage=cache$1.featuredImage,this.current.currentDealMedia&&this.current.currentCarouselView&&(cache$2=carousel,dealId=cache$2.dealId,enabled=cache$2.enabled)?(delete this.dealMedia[this.current.currentDealMedia.uuid],delete this.carouselViews[this.current.currentDealMedia.uuid],cache$3=getMedia(carousel),media=cache$3.media,showVideos=cache$3.showVideos,this.current.currentDealMedia.reset(media,{model:DealCarousel.Media}),carouselOptions=prepareCarouselOptions(carousel,this.current.currentDealMedia,featuredImage,this.i18n),this.current.currentCarouselView.options=carouselOptions,this.current.currentCarouselView.initialize(),this.current.currentCarouselView.updateCollection(this.current.currentDealMedia),cache$4=setVideoLoaderFlags(showVideos,carousel),loadKaltura=cache$4.loadKaltura,loadOoyala=cache$4.loadOoyala,$(function(this$){return function(){return loadVideoScripts(carousel,this$.current.currentCarouselView,loadKaltura,loadOoyala)}}(this))):void 0}}.call(this),null!=window.Gift?window.Gift:window.Gift={},Gift.init=function(payload,done){return $(function(){return Gift.bindGiftButton(),done()})},Gift.bindGiftButton=function(){var $gift_button;return $gift_button=$("#gift-button"),$gift_button.length>0?$gift_button.on("click",function(e){return e.preventDefault(),Gift.createCookie(),BuyButton.view.giftButtonClicked=!0,BuyButton.eventBus.go("buy_button_clicked")}):void 0},Gift.createCookie=function(){var cookieDomain;return cookieDomain="undefined"!=typeof payload&&null!=payload&&null!=payload.giftButton?payload.giftButton.cookieDomain:void 0,Cookie.set("modalForGiftOnLoad","true",60,cookieDomain),Gift.cookieCreated=!0},Gift.removeCookie=function(){var cookieDomain;return cookieDomain="undefined"!=typeof payload&&null!=payload&&null!=payload.giftButton?payload.giftButton.cookieDomain:void 0,Cookie.unset("modalForGiftOnLoad",cookieDomain),Gift.cookieCreated=!1},void function(){var addLeadingZero,countdownTimeKey,countdownTimestamp,countdownTimeTouch,countdownTimeTouchKey,millisRemaining,timeRemaining;timeRemaining=function(timeRemainingMilliseconds){var days,hours,millisecondsLeft,minutes,seconds;return null==timeRemainingMilliseconds?{days:0,hours:0,minutes:0,seconds:0}:(days=Math.floor(timeRemainingMilliseconds/864e5),millisecondsLeft=Math.floor(timeRemainingMilliseconds-864e5*days),hours=Math.floor(millisecondsLeft/36e5),millisecondsLeft=Math.floor(millisecondsLeft-36e5*hours),minutes=Math.floor(millisecondsLeft/6e4),millisecondsLeft=Math.floor(millisecondsLeft-60*1e3*minutes),seconds=Math.floor(millisecondsLeft/1e3),{days:days,hours:hours,minutes:minutes,seconds:seconds})},millisRemaining=function(endTime){var millsRemaining,rightNow;return null==endTime?0:(rightNow=(new Date).getTime(),millsRemaining=endTime-rightNow,0>millsRemaining?0:millsRemaining)},addLeadingZero=function(number){return 0>number?void 0:10>number?"0"+number:""+number},countdownTimeKey=function(timeLeft){switch(!1){case!(timeLeft.days>=15):return"";case!(timeLeft.days>1):return".countdown_time_many_days";case!(1===timeLeft.days):return".countdown_time_1_day";default:return".countdown_time_today"}},countdownTimeTouchKey=function(timeLeft,unit){var metric;switch(metric=""+unit+"s",!1){case!(timeLeft[metric]>1||0===timeLeft[metric]):return".touch_countdown_time_"+unit+"s";case!(1===timeLeft[metric]):return".touch_countdown_time_"+unit;default:return""}},countdownTimeTouch=function(timeLeft,i18n){var daysTxn,expiresIn,hoursTxn,minutesTxn;return daysTxn=countdownTimeTouchKey(timeLeft,"day"),hoursTxn=countdownTimeTouchKey(timeLeft,"hour"),minutesTxn=countdownTimeTouchKey(timeLeft,"minute"),expiresIn="",expiresIn+=i18n.t(daysTxn,{days:daysTxn?timeLeft.days:void 0}),expiresIn+=i18n.t(hoursTxn,{hours:hoursTxn?timeLeft.hours:void 0}),expiresIn+=i18n.t(minutesTxn,{minutes:minutesTxn?timeLeft.minutes:void 0})
},countdownTimestamp=function(timeLeft){var hh,mm,ss;return hh=addLeadingZero(timeLeft.hours),mm=addLeadingZero(timeLeft.minutes),ss=addLeadingZero(timeLeft.seconds),""+hh+":"+mm+":"+ss},"undefined"!=typeof window&&null!=window&&(null!=window.CountdownTimer?window.CountdownTimer:window.CountdownTimer={},null!=CountdownTimer.Helpers?CountdownTimer.Helpers:CountdownTimer.Helpers={},CountdownTimer.Helpers.timeRemaining=timeRemaining,CountdownTimer.Helpers.millisRemaining=millisRemaining,CountdownTimer.Helpers.countdownTimeKey=countdownTimeKey,CountdownTimer.Helpers.countdownTimestamp=countdownTimestamp),"undefined"!=typeof module&&null!=module&&(module.exports={timeRemaining:timeRemaining,millisRemaining:millisRemaining,countdownTimeKey:countdownTimeKey,countdownTimeTouch:countdownTimeTouch,countdownTimestamp:countdownTimestamp})}.call(this),null!=window.CountdownTimer?window.CountdownTimer:window.CountdownTimer={},CountdownTimer.Model=Backbone.Model.extend({timeLeft:function(){var millisLeft;return millisLeft=CountdownTimer.Helpers.millisRemaining(this.get("endAt")),CountdownTimer.Helpers.timeRemaining(millisLeft)}}),void function(){var DEFAULT_EL;DEFAULT_EL=".limited-time > #counter li.countdown-timer",null!=window.CountdownTimer?window.CountdownTimer:window.CountdownTimer={},CountdownTimer.View=Backbone.View.extend({UPDATE_FREQUENCY_MS:1e3,initialize:function(){return this.i18n=this.options.i18n,this.el=this.options.el||DEFAULT_EL},render:function(){return this.$el=$(this.el),setInterval(function(this$){return function(){return this$.updateCountdown()}}(this),this.UPDATE_FREQUENCY_MS)},updateCountdown:function(){var countdownTime,timeLeft;return timeLeft=this.model.timeLeft(),countdownTime=this.t("js.modules.timer"+CountdownTimer.Helpers.countdownTimeKey(timeLeft),{days:timeLeft.days,timerIcon:'<span class="icon-now"></span>',timestamp:CountdownTimer.Helpers.countdownTimestamp(timeLeft)}),this.$el.html(countdownTime)},t:function(){return this.i18n.t.apply(this.i18n,arguments)}})}.call(this),null!=window.CountdownTimer?window.CountdownTimer:window.CountdownTimer={},null!=window.CountdownTimer.current?window.CountdownTimer.current:window.CountdownTimer.current={},CountdownTimer.init=function(param$,done){var endAt,timerData,timerModel,timerView;return timerData=param$.timerData,(endAt=null!=timerData&&null!=timerData.expiringSoon?timerData.expiringSoon.endAt:void 0)?(timerModel=new CountdownTimer.Model({endAt:endAt}),window.CountdownTimer.current.timerModel=timerModel,timerView=new CountdownTimer.View({model:timerModel,i18n:I18n.scoped(),el:null!=timerData?timerData.el:void 0}),$(function(){return timerView.render(),"function"==typeof done?done():void 0})):"function"==typeof done?done():void 0},void function(){var GIFT_MODAL_OFFSET,MODAL_OFFSET,OFFERS_MODAL_OFFSET,TABLET_MQ_WIDTH;MODAL_OFFSET={left:112,top:-130},GIFT_MODAL_OFFSET={left:60,top:-145},OFFERS_MODAL_OFFSET={left:136,top:-118},TABLET_MQ_WIDTH=768,null!=window.MultiOptionModal?window.MultiOptionModal:window.MultiOptionModal={},MultiOptionModal.init=function(payload,done){var openMultiOptionModal,positionModal;return(null!=payload?payload.buyButton.multiOptionEnabled:void 0)?(positionModal=function(){var $modal,$trigger,modalSelector,offset,position,scrollAmount;return modalSelector=BuyButton.view.offersClicked?"#offer-options":"#options",$modal=$(modalSelector),$modal.length?(scrollAmount=0,window.scrollTo(0,0),Gift.cookieCreated?($trigger=$("#gift-button"),$modal.addClass("gift-modal"),offset=GIFT_MODAL_OFFSET):($modal.removeClass("gift-modal"),"#offer-options"===modalSelector?($trigger=$("a.btn-multi-offer.offer-buy-button"),offset=OFFERS_MODAL_OFFSET):($trigger=BuyButton.view.$buyButton,offset=MODAL_OFFSET)),position=$trigger.offset(),$(document.body).width()>TABLET_MQ_WIDTH||$("html").hasClass("lt-ie9")?position.left+=$trigger.width()+offset.left:position.left=void 0,position.top+=offset.top-scrollAmount,$modal.children(".modal-body").css(position),$modal.addClass("positioned"),$modal):void 0},openMultiOptionModal=function(e){var $modal,$otherTooltip,$tooltipTrigger,modalSelector;return null!=e&&e.preventDefault(),modalSelector=BuyButton.view.offersClicked?"#offer-options":"#options",$modal=$(modalSelector),$modal.length?($modal.hasClass("tooltip")?($otherTooltip="#options"===modalSelector?$("#offer-options"):$("#options"),$otherTooltip.is(":visible")&&$otherTooltip.find(".tooltip-close").click(),$tooltipTrigger=BuyButton.view.offersClicked?$(".offer-buy-button"):Gift.cookieCreated?$("#gift-button"):$(".buy-button"),$tooltipTrigger.attr({"data-position":"bottom","data-tooltip-id":modalSelector.slice(1),"data-trigger-event":"js-trigger"}),$tooltipTrigger.find(".tooltip-target").attr("data-position","bottom"),GIG.Tooltip.helpers.tooltip.apply($tooltipTrigger[0],[{preventDefault:function(){}}])):GIG.Modal.open({el:$modal}),{stopTheBus:!0}):void 0},BuyButton.eventBus.board("buy_button_clicked",openMultiOptionModal)(998),$(function(){var $body,$triggers;return $triggers=$(".show-multi-option-modal"),$triggers.click(openMultiOptionModal),$body=$(document.body),$body.on("modal-open:options",positionModal),$body.on("modal-open:offer-options",positionModal),GIG.Modal.onClose(Gift.removeCookie,"options"),GIG.Modal.onClose(Gift.removeCookie,"offer-options"),$("#options, #offer-options").on("click",".tooltip-close",Gift.removeCookie),done()})):done()}}.call(this),null!=window.GMap?window.GMap:window.GMap={},GMap.vent=_(Backbone.Events).clone(),GMap._start=function(){return GMap.vent.trigger("start")},null!=window.GMap?window.GMap:window.GMap={},GMap.View=Backbone.View.extend({events:{"click .static-map":"changeToDynamic"},initialize:function(){var cache$;return cache$=this.options,this.mapOptions=cache$.mapOptions,this.markerData=cache$.markerData,this.googleMapsJS=cache$.googleMapsJS,this.staticMapOptions=cache$.staticMapOptions,this.$staticMap=this.$el.find(".static-map"),this.$dynamicMap=this.$el.find(".dynamic-map"),null!=(null!=this.staticMapOptions?this.staticMapOptions.url:void 0)&&this.renderStaticMap(this.staticMapOptions.url),GMap.vent.on("start",function(this$){return function(){return this$.start()}}(this))},renderStaticMap:function(staticMapUrl){var $imgElement,mapHeight,mapWidth,sizeStr;return mapWidth=this.$staticMap.width(),mapHeight=this.$staticMap.height(),sizeStr="size="+mapWidth+"x"+mapHeight,staticMapUrl=staticMapUrl.replace(/size=\d+x\d+/,sizeStr),$imgElement=this.$staticMap.find("img"),$imgElement.hasClass("lazy-load")?$imgElement.attr("data-original",staticMapUrl):$imgElement.attr("src",staticMapUrl)},changeToDynamic:function(){return $.getScript(this.googleMapsJS),!1},start:function(){var map;return GMap.vent.off("start"),null!=this.googleMaps?this.googleMaps:this.googleMaps=window.google.maps,(map=this.createDynamicMap(this.mapOptions))?(this.addMarkersToMap(this.markerData,map),this.revealDynamicMap()):void 0},createDynamicMap:function(options){var mapOptions;return mapOptions=this.buildMapOptions(options),new this.googleMaps.Map(this.$dynamicMap[0],mapOptions)},addMarkersToMap:function(markerData,map){var bounds,markers;return markers=this.makeMarkers(markerData),this.connectMapToMarkers(map,markers),markers.length>1?(bounds=this.createBounds(markers),map.fitBounds(bounds)):void 0},revealDynamicMap:function(){return this.$staticMap.hide(),this.$dynamicMap.show()},makeMarkers:function(markerData){var marker,markerOptions,markers;markers=[];for(var i$=0,length$=markerData.length;length$>i$;++i$)marker=markerData[i$],markerOptions={position:new this.googleMaps.LatLng(marker.lat,marker.lng),icon:marker.icon},markers.push(new this.googleMaps.Marker(markerOptions));return markers},createBounds:function(markers){var bounds,marker;bounds=new this.googleMaps.LatLngBounds;for(var i$=0,length$=markers.length;length$>i$;++i$)marker=markers[i$],bounds.extend(marker.getPosition());return bounds},buildMapOptions:function(mapOptions){return mapOptions.center=new this.googleMaps.LatLng(mapOptions.center.lat,mapOptions.center.lng),mapOptions.mapTypeId=this.googleMaps.MapTypeId.ROADMAP,mapOptions},connectMapToMarkers:function(map,markers){return function(accum$){for(var marker,i$=0,length$=markers.length;length$>i$;++i$)marker=markers[i$],accum$.push(marker.setMap(map));return accum$}.call(this,[])}}),null!=window.GMap?window.GMap:window.GMap={},GMap.init=function(param$,done){var cache$,dynamicMaps,staticMapOptions;return cache$=param$,dynamicMaps=cache$.dynamicMaps,staticMapOptions=cache$.staticMapOptions,null==dynamicMaps?done():$(function(){for(var map,i$=0,length$=dynamicMaps.length;length$>i$;++i$)map=dynamicMaps[i$],new GMap.View(_.extend(map,{staticMapOptions:staticMapOptions}));return done()})},void function(){var isBlackListedLink,isLinkToEmptyUrl,isLinkToExternalUrl,isLinkToJs,isLinkToPdf,isMailToLink,isWhiteListedLink;null!=window.ExternalLinks?window.ExternalLinks:window.ExternalLinks={},isMailToLink=function(obj){return obj.href.match(/^mailto\:/)},isLinkToPdf=function(obj){return/.pdf$/.test(obj.href)},isLinkToJs=function(obj){return obj.href.match(/^javascript\:/)},isLinkToEmptyUrl=function(obj){return obj.href.match(/^$/)},isLinkToExternalUrl=function(obj){return obj.hostname!==location.hostname&&-1===obj.hostname.indexOf("groupon.com")},isWhiteListedLink=function(obj){var $obj,selector,selectors;selectors=[".fine-print a"],$obj=$(obj);for(var i$=0,length$=selectors.length;length$>i$;++i$)if(selector=selectors[i$],$obj.is(selector))return!0;return!1},isBlackListedLink=function(obj){var $obj,selector,selectors;selectors=[".fine-print a.discussion-links.comments",".diy-gift-card-msg a","#buy-link","#options a"],$obj=$(obj);for(var i$=0,length$=selectors.length;length$>i$;++i$)if(selector=selectors[i$],$obj.is(selector))return!0;return!1},$.expr[":"].external=function(obj){return(isLinkToExternalUrl(obj)||isLinkToPdf(obj)||isWhiteListedLink(obj))&&!(isMailToLink(obj)||isLinkToJs(obj)||isLinkToEmptyUrl(obj)||isBlackListedLink(obj))},ExternalLinks.init=function(payload,done){return $(function(){return $("a:external").click(function(e){return e.preventDefault(),window.open($(this).attr("href"),"_blank")}),done()})}}.call(this),null!=window.DealTypes?window.DealTypes:window.DealTypes={},DealTypes.Model=Backbone.Model.extend({urlRoot:function(){return this.get("rootUrl")},url:function(){return""+this.urlRoot()+"/proxy/v2/consumers/"+this.get("consumerId")+"/feedback"},toJSON:function(){return{_csrf:this.get("csrf"),deal_types:[{id:this.get("id"),value:this.get("value")}]}},isNew:function(){return!0},toggle:function(){return"positive"===this.get("value")?this.set("value","neutral"):this.set("value","positive")}}),null!=window.DealTypes?window.DealTypes:window.DealTypes={},DealTypes.View=Backbone.View.extend({events:{"click a":"_toggle"},initialize:function(){return this.model.on("change:value",function(this$){return function(){return this$._updateClass()}}(this))},_toggle:function(e){return null!=e&&e.preventDefault(),this.model.toggle(),this.model.save()},_updateClass:function(){return"positive"===this.model.get("value")?this.$("a").addClass("matching"):this.$("a").removeClass("matching")}}),null!=window.DealTypes?window.DealTypes:window.DealTypes={},DealTypes.init=function(param$,done){var cache$,consumerId,csrf,dealTypes,rootUrl;return cache$=param$,dealTypes=cache$.dealTypes,consumerId=cache$.consumerId,csrf=cache$.csrf,rootUrl=cache$.rootUrl,(null!=consumerId?consumerId.length:void 0)>0&&(null!=dealTypes?dealTypes.length:void 0)>0?$(function(){for(var cache$1,el,id,model,value,i$=0,length$=dealTypes.length;length$>i$;++i$)cache$1=dealTypes[i$],id=cache$1.id,value=cache$1.value,el=cache$1.el,model=new DealTypes.Model({id:id,value:value,consumerId:consumerId,csrf:csrf,rootUrl:rootUrl}),new DealTypes.View({el:el,model:model});return done()}):done()},null!=window.ChannelTabs?window.ChannelTabs:window.ChannelTabs={},ChannelTabs.init=function(param$,done){var categoriesBaseUrl;return categoriesBaseUrl=param$.categoriesBaseUrl,$(function(){return $(".primary-nav").find("a[href='"+categoriesBaseUrl+"']").parent().addClass("active"),done()})},null!=window.SearchBar?window.SearchBar:window.SearchBar={},SearchBar.init=function(param$,done){var division;return division=param$.division,division&&Groupon.Modules.SearchBar.Common.Location.setDivision(division),done()},null!=window.FacebookPromNight?window.FacebookPromNight:window.FacebookPromNight={},FacebookPromNight.init=function(payload,done){return $(function(){return $(".share-links .icon-facebook").on({click:function(e){return e.preventDefault(),window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent($(this).attr("href")),"_blank","width=626,height=436")}}),done()})},null!=window.DealEventPipe?window.DealEventPipe:window.DealEventPipe=_(Backbone.Events).clone(),null!=window.Discount?window.Discount:window.Discount={},Discount.View=Backbone.View.extend({el:"#discount-data",initialize:function(){return DealEventPipe.on("priceUpdate",function(this$){return function(priceData){return this$.updateTiles(priceData)}}(this))},updateTiles:function(param$){var cache$,percent,savings,value;return cache$=param$,value=cache$.value,percent=cache$.percent,savings=cache$.savings,this.$("#discount-value").html(value),this.$("#discount-percent").html(percent),this.$("#discount-you-save").html(savings)}}),null!=window.DealController?window.DealController:window.DealController={},DealController.init=function(payload,done){return $(function(){return new Discount.View,done()})},window.IframeLogin={init:function(param$,done){var iframeLogin;return iframeLogin=param$.iframeLogin,this.authenticated=null!=iframeLogin?iframeLogin.authenticated:void 0,null!=this.authenticated?this.authenticated:this.authenticated=!0,this.authenticated?"function"==typeof done?done():void 0:$(function(this$){return function(){return this$.$modal=$("#login-modal"),this$.$iframe=this$.$modal.find("iframe"),this$.iframeName=this$.$iframe.attr("name"),IframeLogin.reloadBindings(),"function"==typeof done?done():void 0}}(this))},go:function(path,data){var key,value;if(data){path+="?ref="+encodeURIComponent(this.destination);for(key in data)value=data[key],path+="&"+key+"="+value}return window.location.assign(path)},reloadBindings:function(el){return null==el&&(el=document.body),$(el).find("[data-login-required]").on("click",function(e){var $this;return e.preventDefault(),$this=$(this),IframeLogin.openModal($this.attr("href"))})},openModal:function(path){null==path&&(path=window.location.href),this.destination=path,GIG.Modal.open({el:this.$modal});try{if(null!=frames[this.iframeName])return frames[this.iframeName].IframeLogin.iframeView.resetHeight()}catch(e$){return window.location.assign(path)}},success:function(){return window.location.assign(this.destination)},updateHeight:function(height){return this.$iframe.attr("height",height)}},void function(){var MagicEventBus;MagicEventBus=function(){function MagicEventBus(){this.handlers={},this.statuses={}}return MagicEventBus.prototype.board=function(eventName,callback,errorHandler){var position;return null!=this.handlers[eventName]?this.handlers[eventName]:this.handlers[eventName]=[],position=this._pushHandler(eventName,callback,errorHandler),function(this$){return function(zIndex){return this$.handlers[eventName][position].zIndex=zIndex}}(this)},MagicEventBus.prototype.go=function(eventName){var handler,sortedHandlers;if(null==this.handlers[eventName])return!1;this.statuses[eventName]="going",sortedHandlers=this.handlers[eventName].slice().sort(function(a,b){return(a.zIndex||0)-(b.zIndex||0)});for(var i$=0,length$=sortedHandlers.length;length$>i$&&(handler=sortedHandlers[i$],"stopTheBus"!==this.statuses[eventName]);++i$)this._callback(eventName,handler);return this.statuses[eventName]="stopped"},MagicEventBus.prototype._callback=function(eventName,param$){var cache$,callback,errorHandler,results;return cache$=param$,callback=cache$.callback,errorHandler=cache$.errorHandler,results=function(){var error;try{return callback()}catch(e$){if(error=e$,"undefined"!=typeof TrackingHub&&null!=TrackingHub&&TrackingHub.add("MagicEventBus "+eventName+" Error",{error:error}),"function"==typeof errorHandler)return errorHandler()}}.call(this),(null!=results?results.stopTheBus:void 0)?this.statuses[eventName]="stopTheBus":void 0},MagicEventBus.prototype._pushHandler=function(eventName,callback,errorHandler){return this.handlers[eventName].push({callback:callback,errorHandler:errorHandler}),this.handlers[eventName].length-1},MagicEventBus}(),"undefined"!=typeof window&&null!=window&&(window.MagicEventBus=MagicEventBus),"undefined"!=typeof module&&null!=module&&(module.exports=MagicEventBus)}.call(this),null!=window.BuyButton?window.BuyButton:window.BuyButton={},BuyButton.View=Backbone.View.extend({el:"#purchase-cluster",events:{"click a.buy-button":"buyButtonClicked","click a.offer-buy-button":"offersBuyButtonClicked","click .multi-option-breakout input":"updateMultiOptionBreakoutButton"},initialize:function(param$){var multiOptionEnabled,processLink;return multiOptionEnabled=param$.multiOptionEnabled,this.$buyContainer=this.$(".buy"),this.$buyButton=this.$("a.buy-button"),this.$offersBuyButton=this.$("a.offer-buy-button"),this.$dealHeroPrice=this.$("#deal-hero-price"),this.$mainBtnPrice=this.$("#main-button-formatted-price"),this.$priceBox=this.$(".price"),this.$priceLabel=this.$(".price-label"),this.$multiOptionBreakout=this.$(".multi-option-breakout"),this.$buyButtonLoader=this.$buyButton.siblings(".order-processing-loader"),this.hasBeenClicked=!1,this.variationsSelected=!1,this.multiOptionEnabled=multiOptionEnabled,processLink=function(this$){return function(){return this$.processLink()}}(this),BuyButton.eventBus.board("buy_button_clicked",processLink)(1e3),DealEventPipe.on("priceUpdate",function(this$){return function(priceData){return this$.variationsSelected=priceData.variationsSelected,this$.$buyButton.removeClass("login-disabled"),this$.updatePrice(priceData),this$.updateBuyButton(priceData)}}(this))},buyButtonClicked:function(e){return this.offersClicked=!1,this.giftButtonClicked=!1,e.preventDefault(),BuyButton.eventBus.go("buy_button_clicked")},offersBuyButtonClicked:function(e){return this.offersClicked=!0,this.giftButtonClicked=!1,e.preventDefault(),BuyButton.eventBus.go("buy_button_clicked")},shouldShowPriceInTwoRows:function(){return this.$priceBox.width()+this.$smallPrice.width()>this.$dealHeroPrice.width()},setPriceWithSale:function(newPrice,regularPrice){return this.$priceBox.text(newPrice),this.$priceBox.after("<span class='price-small'>"+regularPrice+"</span>"),this.$smallPrice=this.$dealHeroPrice.find(".price-small"),this.shouldShowPriceInTwoRows()?(this.$priceBox.addClass("two-rows"),this.$smallPrice.addClass("two-rows")):void 0},setOfferLabel:function(offerLabel){return offerLabel?this.$dealHeroPrice.append("<span class='urgency-pricing-label'>"+offerLabel+"</span>"):void 0},cleanPriceBox:function(){return this.$priceBox.removeClass("two-rows"),this.$dealHeroPrice.find(".price-small").remove(),this.$dealHeroPrice.removeClass("urgency-pricing"),this.$(".urgency-pricing-label").remove()},setPriceBox:function(price,sale){return this.cleanPriceBox(),null!=(null!=sale?sale.urgencyPricing:void 0)?(this.$dealHeroPrice.addClass("urgency-pricing"),this.setPriceWithSale(sale.urgencyPricing.newPrice,sale.urgencyPricing.regularPrice),this.setOfferLabel(null!=sale.urgencyPricing.pricingMetadata?sale.urgencyPricing.pricingMetadata.offerLabel:void 0)):null!=(null!=sale?sale.offer:void 0)?(this.$mainBtnPrice.text(sale.offer.formattedNewPrice),this.setPriceWithSale(sale.offer.formattedOldPrice,sale.offer.formattedValue)):this.$priceBox.text(price)},updatePrice:function(param$){var cache$,lengthClass,price,sale,variationsSelected;return cache$=param$,variationsSelected=cache$.variationsSelected,price=cache$.price,sale=cache$.sale,lengthClass=cache$.lengthClass,this.currentPriceClass&&this.$buyContainer.removeClass(this.currentPriceClass),lengthClass&&this.$buyContainer.addClass(lengthClass),this.setPriceBox(price,sale),this.currentPriceClass=lengthClass,variationsSelected?this.$priceLabel.hide():this.$priceLabel.show()},updateBuyButton:function(param$){var buyUrl,cache$,sale,variationsSelected;return cache$=param$,variationsSelected=cache$.variationsSelected,buyUrl=cache$.buyUrl,sale=cache$.sale,variationsSelected&&(this.$buyButton.attr("href",buyUrl),null!=(null!=sale?sale.offer:void 0))?this.$offersBuyButton.attr("href",sale.offer.buyUrl):void 0},disableBuyButton:function(){return this.hasBeenClicked=!0,this.$buyButton.removeClass("state-buy"),this.$offersBuyButton.removeClass("state-buy"),this.$buyButton.addClass("state-disabled"),this.$offersBuyButton.addClass("state-disabled"),this.$buyButtonLoader.show()},enableBuyButton:function(){return this.hasBeenClicked=!1,this.$buyButton.removeClass("state-disabled"),this.$offersBuyButton.removeClass("state-disabled"),this.$buyButton.addClass("state-buy"),this.$offersBuyButton.addClass("state-buy"),this.$buyButtonLoader.hide()},processLink:function(){var button;return this.hasBeenClicked||(button=this.offersClicked?this.$offersBuyButton:this.$buyButton,window.location=button.attr("href")),this.disableBuyButton()},updateMultiOptionBreakoutButton:function(e){var $option,value;return $option=this.$multiOptionBreakout.find(e.currentTarget),value=$option.val(),this.$buyButton.attr("href",value),$option.parent("a").length?BuyButton.eventBus.go("buy_button_clicked"):void 0}}),null!=window.BuyButton?window.BuyButton:window.BuyButton={},BuyButton.init=function(param$,done){var buyButton,cache$,handleBuyButton,iframeLogin;return cache$=param$,buyButton=cache$.buyButton,iframeLogin=cache$.iframeLogin,this.eventBus=new MagicEventBus,null==iframeLogin||iframeLogin.authenticated||iframeLogin.disabledOnBuyButton||(handleBuyButton=function(){return IframeLogin.openModal(BuyButton.view.$buyButton.attr("href")),{stopTheBus:!0}},this.eventBus.board("buy_button_clicked",handleBuyButton)(999)),$(function(this$){return function(){return this$.view=new BuyButton.View({multiOptionEnabled:buyButton.multiOptionEnabled}),done()}}(this))},function(g,H,T){g.ProductReviews||(g.ProductReviews={}),g.ProductReviews.Templates={product_reviews_review_list:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.s(_.f("reviews",c,p,1),c,p,0,14,181,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('  <div class="review-card" id="'),_.b(_.v(_.d("reviewIds.card",c,p,0))),_.b('" data-bhc="product-review:'),_.b(_.v(_.f("uuid",c,p,0))),_.b('" data-bh-viewport="respect">'),_.b("\n"+i),_.b(_.rp("product_reviews_review_card",c,p,"    ")),_.b("  </div>"),_.b("\n")}),c.pop()),_.fl()},'{{# reviews }}\n  <div class="review-card" id="{{ reviewIds.card }}" data-bhc="product-review:{{ uuid }}" data-bh-viewport="respect">\n    {{> product_reviews_review_card }}\n  </div>\n{{/ reviews }}\n',H,{}),product_reviews_review_card:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<div class="review-header">'),_.b("\n"+i),_.b('  <div class="review-header-line">'),_.b("\n"+i),_.b('    <span class="review-display-name should-truncate" data-display-name="'),_.b(_.v(_.f("displayName",c,p,0))),_.b('">'),_.b(_.v(_.f("username",c,p,0))),_.b("</span>"),_.b("\n"+i),_.b('    <span class="review-rating" id="'),_.b(_.v(_.d("reviewIds.rating",c,p,0))),_.b('">'),_.b("\n"+i),_.b(_.rp("product_reviews_stars",c,p,"      ")),_.b("    </span>"),_.b("\n"+i),_.s(_.f("isPending",c,p,1),c,p,0,305,608,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('      <a class="review-status tooltip-trigger" data-tooltip-id="product-reviews-pending-tooltip" data-bhw="ProductReviewsPendingTooltip" data-position="right">'),_.b("\n"+i),_.b("        "),_.s(_.f("translate",c,p,1),c,p,0,490,540,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("modules.product_reviews.review_card.review_pending")}),c.pop()),_.b(' <span class="icon-question"></span>'),_.b("\n"+i),_.b("      </a>"),_.b("\n")}),c.pop()),_.s(_.f("isRejected",c,p,1),c,p,0,646,792,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('      <span class="review-status">'),_.b("\n"+i),_.b("        "),_.s(_.f("translate",c,p,1),c,p,0,706,757,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("modules.product_reviews.review_card.review_rejected")}),c.pop()),_.b("\n"+i),_.b("      </span>"),_.b("\n")}),c.pop()),_.b('    <span class="review-date">'),_.b(_.v(_.f("date",c,p,0))),_.b("</span>"),_.b("\n"+i),_.b("  </div>"),_.b("\n"+i),_.b("</div>"),_.b("\n"+i),_.b('<div class="review-text '),_.s(_.f("isRatingOnly",c,p,1),c,p,0,917,935,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("rating-only-review")}),c.pop()),_.b('">'),_.b(_.v(_.f("text",c,p,0))),_.b("</div>"),_.b("\n"+i),_.b('<div class="review-actions">'),_.b("\n"+i),_.s(_.f("helpfulUpvote",c,p,1),c,p,0,1024,1683,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('    <div class="review-vote">'),_.b("\n"+i),_.b("      <span>"),_.s(_.f("translate",c,p,1),c,p,0,1083,1133,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("modules.product_reviews.review_card.helpful.prompt")}),c.pop()),_.b("</span>"),_.b("\n"+i),_.b("      <button"),_.b("\n"+i),_.b('        id="'),_.b(_.v(_.d("reviewIds.vote",c,p,0))),_.b('"'),_.b("\n"+i),_.b('        class="btn-secondary btn-small '),_.b(_.v(_.d("displayOptions.loginRequired.triggerClass",c,p,0))),_.b(" "),_.b(_.v(_.f("buttonClass",c,p,0))),_.b('"'),_.b("\n"+i),_.b("        "),_.b(_.t(_.d("displayOptions.loginRequired.triggerData.vote",c,p,0))),_.b("\n"+i),_.b("        "),_.s(_.d("displayOptions.loginRequired.iframeLogin",c,p,1),c,p,0,1428,1454,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('data-login-required="true"')}),c.pop()),_.b("\n"+i),_.b('        data-review-id="'),_.b(_.v(_.f("uuid",c,p,0))),_.b('"'),_.b("\n"+i),_.b('        data-review-placement="'),_.b(_.v(_.f("placement",c,p,0))),_.b('"'),_.b("\n"+i),_.b('        data-bhw="ProductReviewsVote">'),_.b("\n"+i),_.b("          "),_.b(_.v(_.f("buttonText",c,p,0))),_.b("\n"+i),_.b("        </button>"),_.b("\n"+i),_.b("    </div>"),_.b("\n")}),c.pop()),_.s(_.f("isUserReview",c,p,1),c,p,0,1725,2178,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("    <a"),_.b("\n"+i),_.b('      id="review-delete"'),_.b("\n"+i),_.b('      class="'),_.b(_.v(_.d("displayOptions.loginRequired.triggerClass",c,p,0))),_.b('"'),_.b("\n"+i),_.b("      "),_.b(_.t(_.d("displayOptions.loginRequired.triggerData.review",c,p,0))),_.b("\n"+i),_.b("      "),_.s(_.d("displayOptions.loginRequired.iframeLogin",c,p,1),c,p,0,1935,1961,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('data-login-required="true"')}),c.pop()),_.b("\n"+i),_.b('      data-review-id="'),_.b(_.v(_.f("uuid",c,p,0))),_.b('"'),_.b("\n"+i),_.b('      data-bhw="ProductReviewsDelete">'),_.b("\n"+i),_.b("        "),_.s(_.f("translate",c,p,1),c,p,0,2106,2148,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("modules.product_reviews.review_card.delete")}),c.pop()),_.b("\n"+i),_.b("      </a>"),_.b("\n")}),c.pop()),_.s(_.d("displayOptions.showShare",c,p,1),c,p,0,2231,2564,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('    <div class="review-share tooltip-trigger" data-tooltip-id="product-reviews-share-tooltip" data-trigger-event="click" data-bhw="ProductReviewShare" data-position="bottom">'),_.b("\n"+i),_.b('      <span class="icon-share"></span><span class="share-text">'),_.s(_.f("translate",c,p,1),c,p,0,2486,2527,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("modules.product_reviews.review_card.share")}),c.pop()),_.b("</span>"),_.b("\n"+i),_.b("    </div>"),_.b("\n")}),c.pop()),_.b("</div>"),_.b("\n"+i),_.s(_.f("helpfulUpvote",c,p,1),c,p,0,2623,2703,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('  <div id="'),_.b(_.v(_.d("reviewIds.voteText",c,p,0))),_.b('" class="review-vote-text">'),_.b(_.v(_.f("text",c,p,0))),_.b("</div>"),_.b("\n")}),c.pop()),_.b('<div id="'),_.b(_.v(_.d("reviewIds.notification",c,p,0))),_.b('" class="notification review-notification"></div>'),_.b("\n"),_.fl()},'<div class="review-header">\n  <div class="review-header-line">\n    <span class="review-display-name should-truncate" data-display-name="{{ displayName }}">{{ username }}</span>\n    <span class="review-rating" id="{{ reviewIds.rating }}">\n      {{> product_reviews_stars }}\n    </span>\n    {{# isPending }}\n      <a class="review-status tooltip-trigger" data-tooltip-id="product-reviews-pending-tooltip" data-bhw="ProductReviewsPendingTooltip" data-position="right">\n        {{# translate }}modules.product_reviews.review_card.review_pending{{/ translate }} <span class="icon-question"></span>\n      </a>\n    {{/ isPending }}\n    {{# isRejected }}\n      <span class="review-status">\n        {{# translate }}modules.product_reviews.review_card.review_rejected{{/ translate }}\n      </span>\n    {{/ isRejected }}\n    <span class="review-date">{{ date }}</span>\n  </div>\n</div>\n<div class="review-text {{# isRatingOnly }}rating-only-review{{/ isRatingOnly }}">{{ text }}</div>\n<div class="review-actions">\n  {{# helpfulUpvote }}\n    <div class="review-vote">\n      <span>{{# translate }}modules.product_reviews.review_card.helpful.prompt{{/ translate }}</span>\n      <button\n        id="{{ reviewIds.vote }}"\n        class="btn-secondary btn-small {{ displayOptions.loginRequired.triggerClass }} {{ buttonClass }}"\n        {{{ displayOptions.loginRequired.triggerData.vote }}}\n        {{# displayOptions.loginRequired.iframeLogin }}data-login-required="true"{{/ displayOptions.loginRequired.iframeLogin }}\n        data-review-id="{{ uuid }}"\n        data-review-placement="{{ placement }}"\n        data-bhw="ProductReviewsVote">\n          {{ buttonText }}\n        </button>\n    </div>\n  {{/ helpfulUpvote }}\n  {{# isUserReview }}\n    <a\n      id="review-delete"\n      class="{{ displayOptions.loginRequired.triggerClass }}"\n      {{{ displayOptions.loginRequired.triggerData.review }}}\n      {{# displayOptions.loginRequired.iframeLogin }}data-login-required="true"{{/ displayOptions.loginRequired.iframeLogin }}\n      data-review-id="{{ uuid }}"\n      data-bhw="ProductReviewsDelete">\n        {{# translate }}modules.product_reviews.review_card.delete{{/ translate }}\n      </a>\n  {{/ isUserReview }}\n  {{# displayOptions.showShare }}\n    <div class="review-share tooltip-trigger" data-tooltip-id="product-reviews-share-tooltip" data-trigger-event="click" data-bhw="ProductReviewShare" data-position="bottom">\n      <span class="icon-share"></span><span class="share-text">{{# translate }}modules.product_reviews.review_card.share{{/ translate }}</span>\n    </div>\n  {{/ displayOptions.showShare }}\n</div>\n{{# helpfulUpvote }}\n  <div id="{{ reviewIds.voteText }}" class="review-vote-text">{{ text }}</div>\n{{/ helpfulUpvote }}\n<div id="{{ reviewIds.notification }}" class="notification review-notification"></div>\n',H,{}),product_reviews_stars:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.s(_.f("ratingStars",c,p,1),c,p,0,18,129,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('  <ul class="rating" data-bhc="'),_.b(_.v(_.f("bhc",c,p,0))),_.b('">'),_.b("\n"+i),_.s(_.f("stars",c,p,1),c,p,0,78,108,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("      <li>"),_.b(_.t(_.d(".",c,p,0))),_.b("</li>"),_.b("\n")}),c.pop()),_.b("  </ul>"),_.b("\n")}),c.pop()),_.fl()},'{{# ratingStars }}\n  <ul class="rating" data-bhc="{{ bhc }}">\n    {{# stars }}\n      <li>{{{ . }}}</li>\n    {{/ stars }}\n  </ul>\n{{/ ratingStars }}\n',H,{}),product_reviews_user_review:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.s(_.f("userReview",c,p,1),c,p,0,17,216,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('  <div id="user-review-card" class="review-card" data-bhw="ProductReviewsUserReview" data-bhc="product-review:'),_.b(_.v(_.f("uuid",c,p,0))),_.b('" data-bh-viewport="respect">'),_.b("\n"+i),_.b(_.rp("product_reviews_review_card",c,p,"    ")),_.b("  </div>"),_.b("\n")}),c.pop()),_.fl()},'{{# userReview }}\n  <div id="user-review-card" class="review-card" data-bhw="ProductReviewsUserReview" data-bhc="product-review:{{ uuid }}" data-bh-viewport="respect">\n    {{> product_reviews_review_card }}\n  </div>\n{{/ userReview }}\n',H,{})}
}(this,Hogan,Hogan.Template),null!=window.ProductReviews?window.ProductReviews:window.ProductReviews={},null!=window.ProductReviews.Views?window.ProductReviews.Views:window.ProductReviews.Views={},ProductReviews.Views.ReviewCard=Backbone.View.extend({render:function(){var data;return data=_.extend({},this.model.attributes,{displayOptions:this.model.displayOptions,translate:function(){return function(text){return I18n.t("js."+text)}}}),this.$el.append(ProductReviews.Templates.product_reviews_review_card.render(data))}}),null!=window.ProductReviews?window.ProductReviews:window.ProductReviews={},null!=window.ProductReviews.Views?window.ProductReviews.Views:window.ProductReviews.Views={},ProductReviews.Views.ReviewRating=Backbone.View.extend({render:function(){return this.$el.append(ProductReviews.Templates.product_reviews_stars.render(this.model.attributes))}}),null!=window.ProductReviews?window.ProductReviews:window.ProductReviews={},null!=window.ProductReviews.Views?window.ProductReviews.Views:window.ProductReviews.Views={},ProductReviews.Views.ReviewList=Backbone.View.extend({el:"#product-reviews-list",render:function(){var fetchedReviews;return fetchedReviews=this.collection.fetchedReviews(),1===this.collection.page?this.$el.html(ProductReviews.Templates.product_reviews_review_list.render({reviews:_.pluck(fetchedReviews,"attributes")})):this.$el.append(ProductReviews.Templates.product_reviews_review_list.render({reviews:_.pluck(fetchedReviews,"attributes")})),function(accum$){for(var review,i$=0,length$=fetchedReviews.length;length$>i$;++i$)review=fetchedReviews[i$],new ProductReviews.Views.ReviewCard({model:review,el:"#review-card-"+review.id}).render(),accum$.push(new ProductReviews.Views.ReviewRating({model:review,el:"#review-rating-"+review.id}).render());return accum$}.call(this,[])}}),null!=window.ProductReviews?window.ProductReviews:window.ProductReviews={},null!=window.ProductReviews.Views?window.ProductReviews.Views:window.ProductReviews.Views={},ProductReviews.Views.Main=Backbone.View.extend({el:"#product-reviews",events:{"mouseover #user-rating.allow-submission .review-star":"hoverStar","click #user-rating.allow-submission .review-star":"clickStar","mouseout #user-rating":"clearHoverStar","keyup #product-reviews-form-extension textarea":"updateMinimumLengthNotification","click #product-reviews-form-extension button":"submitReview","click #product-reviews-form-extension a":"resetForm","click .review-vote button.allow-submission":"voteReview","click #review-delete.allow-submission":"deleteReview","click .review-share":"showShareTooltip","click #product-reviews-pagination-button":"showMoreReviews","change #product-reviews-sort-filter select":"resortReviews"},initialize:function(){return null!=this.$el?this.$el:this.$el=$(this.el),_.extend(this,this.options),this.listenTo(this.model,"change:rating",this.updateStars),this.$el.find("textarea[placeholder]").PlaceholderField(),this.initializeTooltip(),this.$userRating=this.$el.find("#user-rating"),this.$userStars=this.$el.find("#user-rating .review-star"),this.$userReviewNotification=this.$el.find("#user-review-notification"),this.$reviewFormExtension=this.$el.find("#product-reviews-form-extension"),this.$reviewLengthNotification=this.$el.find("#product-reviews-review-length-notification"),this.$reviewText=this.$el.find("#product-reviews-form-extension textarea"),this.$reviewSubmit=this.$el.find("#product-reviews-form-extension button"),this.$reviewCancel=this.$el.find("#product-reviews-form-extension a"),this.$sortNotification=this.$el.find("#product-reviews-sort-notification"),this.$paginationNotification=this.$el.find("#product-reviews-pagination-notification"),this.$paginationLoader=this.$el.find("#product-reviews-pagination-loader"),this.$paginationButton=this.$el.find("#product-reviews-pagination"),this.$reviewFilter=this.$el.find("#product-reviews-sort-filter select"),this.$reviewList=this.$el.find("#product-reviews-list"),this.$loginRequiredTooltip=$("#product-reviews-login-required-tooltip"),this.$shareTooltip=$("#product-reviews-share-tooltip"),this.countdownOpen='<span id="review-character-countdown">',this.countdownClose="</span>"},render:function(reviewList){return this.resetNotifications(),reviewList.render(),this.reloadBindings(),this.updatePagination(),this.$paginationLoader.hide(),this.$reviewList.show()},initializeTooltip:function(){return this.$quickViewTooltipTrigger=$("#product-reviews-quick-view.tooltip-trigger"),this.$formRatingTooltipTrigger=$("#product-reviews-form-rating.tooltip-trigger"),this.$quickViewTooltip=$("#product-reviews-quick-view-tooltip"),this.$quickViewTooltipTrigger.mouseover(function(this$){return function(){return this$.$quickViewTooltip.attr("data-trigger","product-reviews-quick-view")}}(this)),this.$formRatingTooltipTrigger.mouseover(function(this$){return function(){return this$.$quickViewTooltip.attr("data-trigger","product-reviews-form-rating")}}(this))},resetNotifications:function(){return this.$el.find(".review-notification").hide()},httpsRedirect:function(element){return window.location.assign(""+this.dealUrl+element)},hideTooltips:function(){return this.$loginRequiredTooltip.find(".tooltip-close").click(),this.$shareTooltip.find(".tooltip-close").click()},showShareTooltip:function(e){var $reviewCard,emailBody,emailSubject,hrefText,text,username;return $reviewCard=$(e.currentTarget).closest(".review-card"),$reviewCard.length?(username=$reviewCard.find(".review-display-name").data("display-name"),text=$reviewCard.find(".review-text").text(),emailSubject=encodeURIComponent(I18n.t("js.modules.product_reviews.share_review.email_subject",{dealTitle:this.dealTitle,username:username})),emailBody=encodeURIComponent(""+this.dealTitle+"\n"+this.dealUrl+'\n\n"'+text+'"\n- '+username),hrefText="mailto:?subject="+emailSubject+"&body="+emailBody+"&utm_campaign=UserReferral&utm_medium=email&utm_source=uu",this.$shareTooltip.find(".icon-email").attr("href",hrefText)):void 0},updateMinimumLengthNotification:function(){var remainder,reviewLength,text;return reviewLength=this.$reviewText.val().length,remainder=this.minimumReviewLength-reviewLength,0>=remainder?(this.$reviewLengthNotification.removeClass("warning").addClass("success"),remainder=0):this.$reviewLengthNotification.removeClass("success").addClass("warning"),this.maximumReviewLength-reviewLength<0&&(text=this.$reviewText.val().substring(0,this.maximumReviewLength),this.$reviewText.val(text)),this.$reviewLengthNotification.html(I18n.p(remainder,"js.modules.product_reviews.review_form.review_length",{minimumLength:this.minimumReviewLength,countdownOpen:this.countdownOpen,countdownClose:this.countdownClose}))},showMoreReviews:function(){return this.resetNotifications(),this.hideTooltips(),this.$paginationLoader.show(),this.collection.nextPage(this.$reviewFilter.val())},resortReviews:function(){return this.resetNotifications(),this.hideTooltips(),this.$reviewList.hide(),this.$paginationLoader.show(),this.collection.resortReviews(this.$reviewFilter.val())},updatePagination:function(){var displayedReviewCount,reviewsLength;return reviewsLength=this.collection.length,displayedReviewCount={formatted:I18n.toNumber(reviewsLength),value:reviewsLength},this.$el.find("#product-reviews-display-count span").text(I18n.t("js.modules.product_reviews.pagination.showing_count",{formattedDisplayedReviewCount:displayedReviewCount.formatted,formattedReviewCount:this.reviewCount.formatted})),displayedReviewCount.value<this.reviewCount.value?this.$paginationButton.show():this.$paginationButton.hide()},reloadBindings:function(){return($("#product-reviews-login-required-tooltip").length||$("#product-reviews-pending-tooltip").length||$("#product-reviews-share-tooltip").length)&&GIG.Tooltip.reloadBindings(this.$el),$("#login-modal").length?IframeLogin.reloadBindings(this.$el):void 0},findReview:function(placement,id){return"helpful"===placement?this.helpfulCollection.get(id):this.collection.get(id)},showPaginationError:function(action){return this.$paginationLoader.hide(),this.$reviewList.show(),this.$reviewFilter.val(this.collection.sortBy),"nextPage"===action?this.$paginationNotification.show():this.$sortNotification.show()},updateRatingDescriptionText:function(star){return this.$ratingDescription||($("#product-reviews-product-info").append($("<span id='rating-description'/>")),this.$ratingDescription=this.$el.find("#rating-description")),this.$ratingDescription.text(star?'"'+I18n.t("js.modules.product_reviews.review_form.rating_description.rating_"+star)+'"':"")},hoverStar:function(e){var i$,rating,star,x;for(this.$userStars.removeClass("selected-star"),rating=$(e.currentTarget).data("star-rating"),i$=1;5>=i$;++i$)x=i$,star=$("#review-star-"+x),rating>=x?star.addClass("hovered-star"):star.removeClass("hovered-star").addClass("empty-star");return this.updateRatingDescriptionText(rating)},clearHoverStar:function(){var i$,rating,star,x;for(this.$userStars.removeClass("hovered-star"),rating=this.model.get("rating"),i$=1;5>=i$;++i$)x=i$,star=$("#review-star-"+x),rating>=x?star.addClass("selected-star"):star.addClass("empty-star");return this.updateRatingDescriptionText(rating)},clickStar:function(e){return this.reviewable?(this.model.set("rating",$(e.currentTarget).data("star-rating")),this.$reviewFormExtension.slideDown("slow")):this.httpsRedirect("#product-reviews")},updateStars:function(){var i$,rating,star,x;for(rating=this.model.get("rating"),i$=1;5>=i$;++i$)x=i$,star=$("#review-star-"+x),rating>=x?star.removeClass("empty-star").addClass("selected-star"):star.addClass("empty-star").removeClass("selected-star");return this.updateRatingDescriptionText(rating)},submitReview:function(){return this.resetNotifications(),this.model.set("text",$("#product-reviews-form-extension textarea").val()),this.$reviewSubmit.attr("disabled","disabled").addClass("btn-secondary"),this.$reviewCancel.hide(),this.model.review()},showReviewSuccess:function(userReview){return this.resetForm(),userReview.render(),this.$reviewSubmit.hide(),this.$ratingDescription.hide(),this.$userReviewNotification.removeClass("error").addClass("success").text(I18n.t("js.modules.product_reviews.create_review.success")).show(),this.reloadBindings(),this.disableStarButton()},showReviewError:function(){return this.$userReviewNotification.removeClass("success").addClass("error").text(I18n.t("js.modules.product_reviews.create_review.error")).show(),this.enableSubmit(),this.$reviewCancel.show()},enableSubmit:function(){return this.$reviewSubmit.removeAttr("disabled").removeClass("btn-secondary").html("Submit")},disableStarButton:function(){return this.$userRating.removeClass("allow-submission").hide(),this.$userStars.removeClass("hovered-star")},resetForm:function(){return this.model.set("rating",0),this.$reviewFormExtension.slideUp("slow"),this.enableSubmit(),this.$reviewCancel.show()},voteReview:function(e){var $target,anchor,review;return $target=$(e.currentTarget),this.reviewable?(review=this.findReview($target.data("review-placement"),$target.data("review-id")),$target.attr("disabled","disabled"),this.resetNotifications(),review.view=this,$target.hasClass("upvoted")?review.unvote():review.upvote()):(anchor="helpful"===$target.data("review-placement")?"#product-reviews-helpful-reviews":"#product-reviews-list",this.httpsRedirect(anchor))},showVoteSuccess:function(model){var helpfulUpvote,reviewIds,successMessage,voteButton;return reviewIds=model.get("reviewIds"),helpfulUpvote=model.get("helpfulUpvote"),voteButton=$("#"+reviewIds.vote),"upvoted"===helpfulUpvote.buttonClass?(voteButton.addClass("upvoted"),successMessage=I18n.t("js.modules.product_reviews.upvote_review.success")):(voteButton.removeClass("upvoted"),successMessage=I18n.t("js.modules.product_reviews.unvote_review.success")),voteButton.text(helpfulUpvote.buttonText).removeAttr("disabled"),this.$el.find("#"+reviewIds.voteText).text(helpfulUpvote.text),this.$el.find("#"+reviewIds.notification).removeClass("error").addClass("success").text(successMessage).show()},showVoteError:function(model){var errorMessage,helpfulUpvote,reviewIds;return reviewIds=model.get("reviewIds"),$("#"+reviewIds.vote).removeAttr("disabled"),helpfulUpvote=model.get("helpfulUpvote"),errorMessage="upvoted"===helpfulUpvote.buttonClass?I18n.t("js.modules.product_reviews.unvote_review.error"):I18n.t("js.modules.product_reviews.upvote_review.error"),this.$el.find("#"+reviewIds.notification).removeClass("success").addClass("error").text(errorMessage).show()},deleteReview:function(){return this.reviewable?(this.resetNotifications(),$("#user-review-notification-"+this.model.id).hide(),this.model["delete"]()):this.httpsRedirect("#product-reviews")},showDeleteSuccess:function(model){var reviewIds;return reviewIds=model.get("reviewIds"),this.$el.find("#review-delete").hide(),this.$el.find("#"+reviewIds.notification).removeClass("error").addClass("success").text(I18n.t("js.modules.product_reviews.delete_review.success")).show()},showDeleteError:function(model){var reviewIds;return reviewIds=model.get("reviewIds"),this.$el.find("#review-delete").hide(),this.$el.find("#"+reviewIds.notification).removeClass("success").addClass("error").text(I18n.t("js.modules.product_reviews.delete_review.error")).show()}}),//! license : MIT
function(undefined){function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function deprecate(msg,fn){function printMsg(){moment.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}var firstTime=!0;return extend(function(){return firstTime&&(printMsg(),firstTime=!1),fn.apply(this,arguments)},fn)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}function Language(){}function Moment(config){checkOverflow(config),extend(this,config)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._bubble()}function extend(a,b){for(var i in b)b.hasOwnProperty(i)&&(a[i]=b[i]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function cloneMoment(m){var i,result={};for(i in m)m.hasOwnProperty(i)&&momentProperties.hasOwnProperty(i)&&(result[i]=m[i]);return result}function absRound(number){return 0>number?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength,forceSign){for(var output=""+Math.abs(number),sign=number>=0;output.length<targetLength;)output="0"+output;return(sign?forceSign?"+":"":"-")+output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset?!0:updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding),months&&rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding),updateOffset&&moment.updateOffset(mom,days||months)}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;len>i;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)inputObject.hasOwnProperty(prop)&&(normalizedProp=normalizeUnits(prop),normalizedProp&&(normalizedInput[normalizedProp]=inputObject[prop]));return normalizedInput}function makeList(field){var count,setter;if(0===field.indexOf("week"))count=7,setter="day";else{if(0!==field.indexOf("month"))return;count=12,setter="month"}moment[field]=function(format,index){var i,getter,method=moment.fn._lang[field],results=[];if("number"==typeof format&&(index=format,format=undefined),getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment.fn._lang,m,format||"")},null!=index)return getter(index);for(i=0;count>i;i++)results.push(getter(i));return results}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=coercedNumber>=0?Math.floor(coercedNumber):Math.ceil(coercedNumber)),value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return 0===year%4&&0!==year%100||0===year%400}function checkOverflow(m){var overflow;m._a&&-2===m._pf.overflow&&(overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>23?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1,m._pf._overflowDayOfYear&&(YEAR>overflow||overflow>DATE)&&(overflow=DATE),m._pf.overflow=overflow)}function isValid(m){return null==m._isValid&&(m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated,m._strict&&(m._isValid=m._isValid&&0===m._pf.charsLeftOver&&0===m._pf.unusedTokens.length)),m._isValid}function normalizeLanguage(key){return key?key.toLowerCase().replace("_","-"):key}function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local()}function loadLang(key,values){return values.abbr=key,languages[key]||(languages[key]=new Language),languages[key].set(values),languages[key]}function unloadLang(key){delete languages[key]}function getLangDefinition(key){var j,lang,next,split,i=0,get=function(k){if(!languages[k]&&hasModule)try{require("./lang/"+k)}catch(e){}return languages[k]};if(!key)return moment.fn._lang;if(!isArray(key)){if(lang=get(key))return lang;key=[key]}for(;i<key.length;){for(split=normalizeLanguage(key[i]).split("-"),j=split.length,next=normalizeLanguage(key[i+1]),next=next?next.split("-"):null;j>0;){if(lang=get(split.slice(0,j).join("-")))return lang;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return moment.fn._lang}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;length>i;i++)array[i]=formatTokenFunctions[array[i]]?formatTokenFunctions[array[i]]:removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;length>i;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.lang()),formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)):m.lang().invalidDate()}function expandFormat(format,lang){function replaceLongDateFormatTokens(input){return lang.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict)return parseTokenOneDigit;case"SS":if(strict)return parseTokenTwoDigits;case"SSS":if(strict)return parseTokenThreeDigits;case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return parseTokenOrdinal;default:return a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"))}}function timezoneMinutesFromString(string){string=string||"";var possibleTzMatches=string.match(parseTokenTimezone)||[],tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(60*parts[1])+toInt(parts[2]);return"+"===parts[0]?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":null!=input&&(datePartArray[MONTH]=3*(toInt(input)-1));break;case"M":case"MM":null!=input&&(datePartArray[MONTH]=toInt(input)-1);break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input),null!=a?datePartArray[MONTH]=a:config._pf.invalidMonth=input;break;case"D":case"DD":null!=input&&(datePartArray[DATE]=toInt(input));break;case"Do":null!=input&&(datePartArray[DATE]=toInt(parseInt(input,10)));break;case"DDD":case"DDDD":null!=input&&(config._dayOfYear=toInt(input));break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(1e3*("0."+input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=timezoneMinutesFromString(input);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":token=token.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":token=token.substr(0,2),input&&(config._w=config._w||{},config._w[token]=input)}}function dateFromConfig(config){var i,date,currentDate,yearToUse,fixYear,w,temp,lang,weekday,week,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&(fixYear=function(val){var intVal=parseInt(val,10);return val?val.length<3?intVal>68?1900+intVal:2e3+intVal:intVal:null==config._a[YEAR]?moment().weekYear():config._a[YEAR]},w=config._w,null!=w.GG||null!=w.W||null!=w.E?temp=dayOfYearFromWeeks(fixYear(w.GG),w.W||1,w.E,4,1):(lang=getLangDefinition(config._l),weekday=null!=w.d?parseWeekday(w.d,lang):null!=w.e?parseInt(w.e,10)+lang._week.dow:0,week=parseInt(w.w,10)||1,null!=w.d&&weekday<lang._week.dow&&week++,temp=dayOfYearFromWeeks(fixYear(w.gg),week,weekday,lang._week.doy,lang._week.dow)),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear),config._dayOfYear&&(yearToUse=null==config._a[YEAR]?currentDate[YEAR]:config._a[YEAR],config._dayOfYear>daysInYear(yearToUse)&&(config._pf._overflowDayOfYear=!0),date=makeUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;3>i&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;7>i;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];input[HOUR]+=toInt((config._tzm||0)/60),input[MINUTE]+=toInt((config._tzm||0)%60),config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input)}}function dateFromObject(config){var normalizedInput;config._d||(normalizedInput=normalizeObjectUnits(config._i),config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond],dateFromConfig(config))}function currentDateArray(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}function makeDateFromStringAndFormat(config){config._a=[],config._pf.empty=!0;var i,parsedInput,tokens,token,skipped,lang=getLangDefinition(config._l),string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,lang).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0],parsedInput&&(skipped=string.substr(0,string.indexOf(parsedInput)),skipped.length>0&&config._pf.unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?config._pf.empty=!1:config._pf.unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&config._pf.unusedTokens.push(token);config._pf.charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&config._pf.unusedInput.push(string),config._isPm&&config._a[HOUR]<12&&(config._a[HOUR]+=12),config._isPm===!1&&12===config._a[HOUR]&&(config._a[HOUR]=0),dateFromConfig(config),checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return config._pf.invalidFormat=!0,config._d=new Date(0/0),void 0;for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=extend({},config),tempConfig._pf=defaultParsingFlags(),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=tempConfig._pf.charsLeftOver,currentScore+=10*tempConfig._pf.unusedTokens.length,tempConfig._pf.score=currentScore,(null==scoreToBeat||scoreToBeat>currentScore)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function makeDateFromString(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){for(config._pf.iso=!0,i=0,l=isoDates.length;l>i;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}for(i=0,l=isoTimes.length;l>i;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}string.match(parseTokenTimezone)&&(config._f+="Z"),makeDateFromStringAndFormat(config)}else moment.createFromInputFallback(config)}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);input===undefined?config._d=new Date:matched?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=input.slice(0),dateFromConfig(config)):isDate(input)?config._d=new Date(+input):"object"==typeof input?dateFromObject(config):"number"==typeof input?config._d=new Date(input):moment.createFromInputFallback(config)}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return 1970>y&&date.setFullYear(y),date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return 1970>y&&date.setUTCFullYear(y),date}function parseWeekday(input,language){if("string"==typeof input)if(isNaN(input)){if(input=language.weekdaysParse(input),"number"!=typeof input)return null}else input=parseInt(input,10);return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1e3),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=45>seconds&&["s",seconds]||1===minutes&&["m"]||45>minutes&&["mm",minutes]||1===hours&&["h"]||22>hours&&["hh",hours]||1===days&&["d"]||25>=days&&["dd",days]||45>=days&&["M"]||345>days&&["MM",round(days/30)]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=milliseconds>0,args[4]=lang,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),end-7>daysToDayOfWeek&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add("d",daysToDayOfWeek),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var daysToAdd,dayOfYear,d=makeUTCDate(year,0,1).getUTCDay();return weekday=null!=weekday?weekday:firstDayOfWeek,daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(firstDayOfWeek>d?7:0),dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1,{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var input=config._i,format=config._f;return null===input||format===undefined&&""===input?moment.invalid({nullInput:!0}):("string"==typeof input&&(config._i=input=getLangDefinition().preparse(input)),moment.isMoment(input)?(config=cloneMoment(input),config._d=new Date(+input._d)):format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),new Moment(config))}function rawMonthSetter(mom,value){var dayOfMonth;return"string"==typeof value&&(value=mom.lang().monthsParse(value),"number"!=typeof value)?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){return"Month"===unit?rawMonthSetter(mom,value):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function makeAccessor(unit,keepTime){return function(value){return null!=value?(rawSetter(this,unit,value),moment.updateOffset(this,keepTime),this):rawGetter(this,unit)}}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return+this/factor}}function makeGlobal(shouldDeprecate){"undefined"==typeof ender&&(oldGlobalMoment=globalScope.moment,globalScope.moment=shouldDeprecate?deprecate("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",moment):moment)}for(var moment,oldGlobalMoment,i,VERSION="2.6.0",globalScope="undefined"!=typeof global?global:this,round=Math.round,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,languages={},momentProperties={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},hasModule="undefined"!=typeof module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,unitMillisecondFactors=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);for(formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),extend(Language.prototype,{set:function(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[]),i=0;12>i;i++)if(this._monthsParse[i]||(mom=moment.utc([2e3,i]),regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),this._monthsParse[i].test(monthName))return i},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return"function"==typeof output?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),moment=function(input,format,lang,strict){var c;return"boolean"==typeof lang&&(strict=lang,lang=undefined),c={},c._isAMomentObject=!0,c._i=input,c._f=format,c._l=lang,c._strict=strict,c._isUTC=!1,c._pf=defaultParsingFlags(),makeMoment(c)},moment.suppressDeprecationWarnings=!1,moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i)}),moment.utc=function(input,format,lang,strict){var c;return"boolean"==typeof lang&&(strict=lang,lang=undefined),c={},c._isAMomentObject=!0,c._useUTC=!0,c._isUTC=!0,c._l=lang,c._i=input,c._f=format,c._strict=strict,c._pf=defaultParsingFlags(),makeMoment(c).utc()},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,parseIso,duration=input,match=null;return moment.isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetTimeSpanJsonRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoDurationRegex.exec(input))&&(sign="-"===match[1]?-1:1,parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign},duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}),ret=new Duration(duration),moment.isDuration(input)&&input.hasOwnProperty("_lang")&&(ret._lang=input._lang),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.momentProperties=momentProperties,moment.updateOffset=function(){},moment.lang=function(key,values){var r;return key?(values?loadLang(normalizeLanguage(key),values):null===values?(unloadLang(key),key="en"):languages[key]||getLangDefinition(key),r=moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key),r._abbr):moment.fn._lang._abbr},moment.langData=function(key){return key&&key._lang&&key._lang._abbr&&(key=key._lang._abbr),getLangDefinition(key)},moment.isMoment=function(obj){return obj instanceof Moment||null!=obj&&obj.hasOwnProperty("_isAMomentObject")},moment.isDuration=function(obj){return obj instanceof Duration},i=lists.length-1;i>=0;--i)makeList(lists[i]);moment.normalizeUnits=function(units){return normalizeUnits(units)},moment.invalid=function(flags){var m=moment.utc(0/0);return null!=flags?extend(m._pf,flags):m._pf.userInvalidated=!0,m},moment.parseZone=function(){return moment.apply(null,arguments).parseZone()},moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)},extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();return 0<m.year()&&m.year()<=9999?formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){return this._a?this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0:!1},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;return dur="string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,1),this},subtract:function(input,val){var dur;return dur="string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,-1),this},diff:function(input,units,asFloat){var diff,output,that=makeAs(input,this),zoneDiff=6e4*(this.zone()-that.zone());return units=normalizeUnits(units),"year"===units||"month"===units?(diff=432e5*(this.daysInMonth()+that.daysInMonth()),output=12*(this.year()-that.year())+(this.month()-that.month()),output+=(this-moment(this).startOf("month")-(that-moment(that).startOf("month")))/diff,output-=6e4*(this.zone()-moment(this).startOf("month").zone()-(that.zone()-moment(that).startOf("month").zone()))/diff,"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)
},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(){var sod=makeAs(moment(),this).startOf("day"),diff=this.diff(sod,"days",!0),format=-6>diff?"sameElse":-1>diff?"lastWeek":0>diff?"lastDay":1>diff?"sameDay":2>diff?"nextDay":7>diff?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.lang()),this.add({d:input-day})):day},month:makeAccessor("Month",!0),startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units?this.weekday(0):"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(units){return units=normalizeUnits(units),this.startOf(units).add("isoWeek"===units?"week":units,1).subtract("ms",1)},isAfter:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){return units=units||"ms",+this.clone().startOf(units)===+makeAs(input,this).startOf(units)},min:function(other){return other=moment.apply(null,arguments),this>other?this:other},max:function(other){return other=moment.apply(null,arguments),other>this?this:other},zone:function(input,keepTime){var offset=this._offset||0;return null==input?this._isUTC?offset:this._d.getTimezoneOffset():("string"==typeof input&&(input=timezoneMinutesFromString(input)),Math.abs(input)<16&&(input=60*input),this._offset=input,this._isUTC=!0,offset!==input&&(!keepTime||this._changeInProgress?addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,moment.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(input){return input=input?moment(input).zone():0,0===(this.zone()-input)%60},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add("d",input-dayOfYear)},quarter:function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==input?year:this.add("y",input-year)},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add("y",input-year)},week:function(input){var week=this.lang().week(this);return null==input?week:this.add("d",7*(input-week))},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add("d",7*(input-week))},weekday:function(input){var weekday=(this.day()+7-this.lang()._week.dow)%7;return null==input?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this._lang._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){return units=normalizeUnits(units),this[units]()},set:function(units,value){return units=normalizeUnits(units),"function"==typeof this[units]&&this[units](value),this},lang:function(key){return key===undefined?this._lang:(this._lang=getLangDefinition(key),this)}}),moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",!1),moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",!1),moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",!1),moment.fn.hour=moment.fn.hours=makeAccessor("Hours",!0),moment.fn.date=makeAccessor("Date",!0),moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",!0)),moment.fn.year=makeAccessor("FullYear",!0),moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",!0)),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.quarters=moment.fn.quarter,moment.fn.toJSON=moment.fn.toISOString,extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var seconds,minutes,hours,years,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),data.days=days%30,months+=absRound(days/30),data.months=months%12,years=absRound(months/12),data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*toInt(this._months/12)},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());return withSuffix&&(output=this.lang().pastFuture(difference,output)),this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return units=normalizeUnits(units),this[units.toLowerCase()+"s"]()},as:function(units){return units=normalizeUnits(units),this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang,toIsoString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":""):"P0D"}});for(i in unitMillisecondFactors)unitMillisecondFactors.hasOwnProperty(i)&&(makeDurationAsGetter(i,unitMillisecondFactors[i]),makeDurationGetter(i.toLowerCase()));makeDurationAsGetter("Weeks",6048e5),moment.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},moment.lang("en",{ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hasModule?module.exports=moment:"function"==typeof define&&define.amd?(define("moment",function(require,exports,module){return module.config&&module.config()&&module.config().noGlobal===!0&&(globalScope.moment=oldGlobalMoment),moment}),makeGlobal(!0)):makeGlobal()}.call(this),void function(){var cache$,cache$1,cache$2,extend,extractDisplayNames,extractHelpfulUpvote,extractReviews,formatDate,indexOf,map,placement,processReview,processUserReview,ratingToStars,reviewIds,starToHtml,trim;"undefined"!=typeof window&&null!=window&&(cache$=_,extend=cache$.extend,map=cache$.map,indexOf=cache$.indexOf,cache$1=$,trim=cache$1.trim),"undefined"!=typeof module&&null!=module&&(cache$2=require("underscore"),extend=cache$2.extend,map=cache$2.map,indexOf=cache$2.indexOf),formatDate=function(dateString,datetime,i18n){var date;return date=datetime(dateString),(null!=date?date.isValid():void 0)?date.format(i18n.t("js.modules.product_reviews.review_card.date_format_string")):""},starToHtml=function(starType,position,userInput){return null==userInput&&(userInput=!1),userInput?"<span class='review-star "+starType+"' id='review-star-"+position+"' data-star-rating='"+position+"' data-bhw='ProductReviewUserRatingStar"+position+"'></span>":"<span class='"+starType+"'></span>"},ratingToStars=function(rating,userInput){var bhc,i$,position,stars,starType;for(stars=[],bhc="deal-review-rating:"+rating,i$=1;5>=i$;++i$)position=i$,starType=function(){switch(!1){case!(rating>7/8):return"full-star";case!(rating>5/8):return"three-fourth-star";case!(rating>3/8):return"half-star";case!(rating>1/8):return"fourth-star";default:return"empty-star"}}.call(this),stars.push(starToHtml(starType,position,userInput)),rating--;return{stars:stars,bhc:bhc}},placement=function(review){return review.isUserReview?"user":review.isHelpfulReview?"helpful":"list"},reviewIds=function(review){var prefix;return prefix="list"===review.placement?"":""+review.placement+"-",{card:""+prefix+"review-card-"+review.uuid,notification:""+prefix+"review-notification-"+review.uuid,rating:""+prefix+"review-rating-"+review.uuid,vote:""+prefix+"review-vote-"+review.uuid,voteText:""+prefix+"review-vote-text-"+review.uuid}},extractHelpfulUpvote=function(review,displayOptions,i18n){var userVoted;if(!review.byCurrentUser&&(null!=displayOptions?displayOptions.showVotes:0))return(userVoted=indexOf(displayOptions.userUpvotedReviews||[],review.uuid)>-1)&&review.upvoteCount++,{buttonClass:userVoted?"upvoted":void 0,buttonText:userVoted?i18n.t("js.modules.product_reviews.review_card.helpful.undo"):i18n.t("js.modules.product_reviews.review_card.helpful.yes"),text:review.upvoteCount?i18n.p(review.upvoteCount,"js.modules.product_reviews.review_card.helpful.message"):"",userVoted:userVoted}},extractDisplayNames=function(review,i18n){var displayName,username;return displayName=review.displayName,(null!=displayName?displayName.length:void 0)?username=review.byCurrentUser?i18n.t("js.modules.product_reviews.review_card.display_name.current_user",{displayName:displayName}):displayName:(displayName=i18n.t("js.modules.product_reviews.review_card.display_name.anonymous_user"),username=review.byCurrentUser?i18n.t("js.modules.product_reviews.review_card.display_name.current_user_missing_name"):i18n.t("js.modules.product_reviews.review_card.display_name.anonymous_user")),{username:username,displayName:displayName}},processReview=function(review,displayOptions,i18n,datetime){var cache$3,displayName,username;return review.byCurrentUser=indexOf((null!=displayOptions?displayOptions.userReviewIds:void 0)||[],review.uuid)>-1,review.placement=placement(review),cache$3=extractDisplayNames(review,i18n),username=cache$3.username,displayName=cache$3.displayName,extend(review,{date:formatDate(review.submittedAt,datetime,i18n),helpfulUpvote:extractHelpfulUpvote(review,displayOptions,i18n),ratingStars:ratingToStars(review.rating),reviewIds:reviewIds(review),username:username,displayName:displayName})},extractReviews=function(productReviews,displayOptions,i18n,datetime){return(null!=productReviews&&null!=productReviews.reviews?productReviews.reviews.length:void 0)?map(productReviews.reviews,function(review){return processReview(review,displayOptions,i18n,datetime)}):void 0},processUserReview=function(userReview,displayOptions,i18n,datetime){var isRatingOnly,userReviewText;return userReviewText=userReview.text||"",userReviewText=trim?trim(userReviewText):userReviewText.trim(),isRatingOnly=!userReviewText.length,extend(userReview,{isPending:"PENDING"===userReview.status,isRatingOnly:isRatingOnly,isRejected:"REJECTED"===userReview.status,isUserReview:!0,text:isRatingOnly?i18n.t("js.modules.product_reviews.review_card.rating_only_review"):userReview.text}),processReview(userReview,displayOptions,i18n,datetime)},"undefined"!=typeof window&&null!=window&&(null!=window.ProductReviews?window.ProductReviews:window.ProductReviews={},null!=ProductReviews.Helpers?ProductReviews.Helpers:ProductReviews.Helpers={},ProductReviews.Helpers.extractReviews=extractReviews,ProductReviews.Helpers.processUserReview=processUserReview),"undefined"!=typeof module&&null!=module&&(module.exports={formatDate:formatDate,starToHtml:starToHtml,ratingToStars:ratingToStars,placement:placement,reviewIds:reviewIds,extractHelpfulUpvote:extractHelpfulUpvote,extractDisplayNames:extractDisplayNames,processReview:processReview,extractReviews:extractReviews,processUserReview:processUserReview})}.call(this),null!=window.ProductReviews?window.ProductReviews:window.ProductReviews={},null!=window.ProductReviews.Views?window.ProductReviews.Views:window.ProductReviews.Views={},ProductReviews.Views.UserReview=Backbone.View.extend({el:"#user-review-card",render:function(){return $("#product-reviews-form-extension").after(ProductReviews.Templates.product_reviews_user_review.render({userReview:this.model.attributes})),this.setElement($("#user-review-card")),new ProductReviews.Views.ReviewCard({model:this.model,el:"#user-review-card"}).render(),new ProductReviews.Views.ReviewRating({model:this.model,el:"#user-review-card .review-rating"}).render()}}),null!=window.ProductReviews?window.ProductReviews:window.ProductReviews={},ProductReviews.Model=Backbone.Model.extend({idAttribute:"uuid",defaults:{rating:0},initialize:function(attrs,options){return this.set("locale",I18n.locale),_.extend(this,options),_.bindAll(this,"reviewSuccess","reviewError","upvoteSuccess","upvoteError","unvoteSuccess","unvoteError","deleteSuccess","deleteError")},url:function(action){return null==action&&(action=""),""+this.rootUrl+"/product_review_proxy/reviews"+action+"?_csrf="+this.csrf},sync:function(method,model,options){return null==options&&(options={}),options.timeout=ProductReviews.timeout,Backbone.Model.prototype.sync.call(this,method,model,options)},review:function(){var data;return data={deal_uuid:this.dealUuid,locale:this.get("locale"),rating:this.get("rating"),text:$.trim(this.get("text"))},this.save(data,{type:"POST",wait:!0,success:this.reviewSuccess,error:this.reviewError,url:this.url()})},reviewSuccess:function(model,response){return null!=response.error?this.reviewError(model,response):(this.displayOptions.userReviewIds.push(response.review.uuid),this.set(ProductReviews.Helpers.processUserReview(response.review,this.displayOptions,I18n,moment)),this.view.showReviewSuccess(new ProductReviews.Views.UserReview({model:this})))},reviewError:function(){return this.view.showReviewError()},upvote:function(){return this.save({},{type:"POST",wait:!0,success:this.upvoteSuccess,error:this.upvoteError,url:this.url("/"+this.id+"/upvote")})},upvoteSuccess:function(){var upvoteCount;return upvoteCount=this.get("upvoteCount")+1,this.set({upvoteCount:upvoteCount,helpfulUpvote:{buttonClass:"upvoted",buttonText:I18n.t("js.modules.product_reviews.review_card.helpful.undo"),text:upvoteCount>0?I18n.p(upvoteCount,"js.modules.product_reviews.review_card.helpful.message"):""}}),this.collection.recordUpvote(this.id),this.view.showVoteSuccess(this)},upvoteError:function(model,response){return this.isDuplicateError(response)?this.upvoteSuccess(model,response):(this.set({helpfulUpvote:{buttonClass:""}}),this.view.showVoteError(this))},isDuplicateError:function(response){return 4===response.readyState&&409===response.status},unvote:function(){return this.save({},{type:"POST",wait:!0,success:this.unvoteSuccess,error:this.unvoteError,url:this.url("/"+this.id+"/unvote")})},unvoteSuccess:function(){var upvoteCount;return upvoteCount=this.get("upvoteCount")>0?this.get("upvoteCount")-1:0,this.set({upvoteCount:upvoteCount,helpfulUpvote:{buttonClass:"",buttonText:I18n.t("js.modules.product_reviews.review_card.helpful.yes"),text:upvoteCount>0?I18n.p(upvoteCount,"js.modules.product_reviews.review_card.helpful.message"):""}}),this.collection.recordUnvote(this.id),this.view.showVoteSuccess(this)},unvoteError:function(model,response){return this.isDuplicateError(response)?this.unvoteSuccess(model,response):(this.set({helpfulUpvote:{buttonClass:"upvoted"}}),this.view.showVoteError(this))},"delete":function(){return this.destroy({wait:!0,success:this.deleteSuccess,error:this.deleteError,url:this.url("/"+this.id)})},deleteSuccess:function(){return this.view.showDeleteSuccess(this)},deleteError:function(){return this.view.showDeleteError(this)}}),null!=window.ProductReviews?window.ProductReviews:window.ProductReviews={},ProductReviews.Collection=Backbone.Collection.extend({model:ProductReviews.Model,initialize:function(models,param$){return this.options=param$,this.page=1,this.locale="en_US",this.sortBy="most_recent",_.extend(this,this.options),_.bindAll(this,"paginationSuccess","paginationError")},_prepareModel:function(model,options){return _.extend(options,this.options),delete options.parse,Backbone.Collection.prototype._prepareModel.call(this,model,options)},url:function(){return""+this.rootUrl+"/product_review_proxy/reviews.json?deal_uuid="+this.dealUuid+"&locale="+this.locale+"&sort="+this.sortBy+"&limit="+this.limit()+"&offset="+this.offset()},sync:function(method,collection,options){return null==options&&(options={}),options.timeout=ProductReviews.timeout,Backbone.Collection.prototype.sync.call(this,method,collection,options)},limit:function(){return this.pageSize},offset:function(){return(this.page-1)*this.pageSize},parse:function(response){return response.reviewable?ProductReviews.Helpers.extractReviews(response,this.displayOptions,I18n,moment):void 0},nextPage:function(sortOrder){return this.previousSortBy=this.sortBy,this.previousPage=this.page,this.page++,sortOrder&&(this.sortBy=sortOrder),this.action="nextPage",this.fetch({success:this.paginationSuccess,error:this.paginationError,remove:!1})},resortReviews:function(sortOrder){return this.previousSortBy=this.sortBy,this.previousPage=this.page,this.page=1,sortOrder&&(this.sortBy=sortOrder),this.action="resortReviews",this.fetch({success:this.paginationSuccess,error:this.paginationError,reset:!0})},paginationSuccess:function(){return this.view.render(new ProductReviews.Views.ReviewList({collection:this}))},paginationError:function(){return this.page=this.previousPage,this.sortBy=this.previousSortBy,this.view.showPaginationError(this.action)},recordUpvote:function(id){return this.displayOptions.userUpvotedReviews.push(id)},recordUnvote:function(id){return this.displayOptions.userUpvotedReviews=_.without(this.displayOptions.userUpvotedReviews,id)},fetchedReviews:function(){return this.models.slice(this.offset())}}),null!=window.ProductReviews?window.ProductReviews:window.ProductReviews={},ProductReviews.init=function(param$,done){var cache$,cache$1,collection,csrf,dealTitle,dealUrl,dealUuid,displayOptions,helpfulCollection,maximumReviewLength,minimumReviewLength,model,pageSize,productReviews,reviewable,reviewCount,rootUrl;return cache$=param$,csrf=cache$.csrf,rootUrl=cache$.rootUrl,productReviews=cache$.productReviews,productReviews.dealUuid?(cache$1=productReviews,reviewable=cache$1.reviewable,dealUuid=cache$1.dealUuid,dealUrl=cache$1.dealUrl,dealTitle=cache$1.dealTitle,pageSize=cache$1.pageSize,reviewCount=cache$1.reviewCount,minimumReviewLength=cache$1.minimumReviewLength,maximumReviewLength=cache$1.maximumReviewLength,displayOptions=cache$1.displayOptions,ProductReviews.timeout=3e3,collection=new ProductReviews.Collection(productReviews.reviews,{rootUrl:rootUrl,csrf:csrf,dealUuid:dealUuid,displayOptions:displayOptions,pageSize:pageSize}),helpfulCollection=new ProductReviews.Collection(null!=productReviews.helpful?productReviews.helpful.reviews:void 0,{rootUrl:rootUrl,csrf:csrf,dealUuid:dealUuid,displayOptions:displayOptions}),model=new ProductReviews.Model(productReviews.userReview,{rootUrl:rootUrl,csrf:csrf,dealUuid:dealUuid,displayOptions:displayOptions}),$(function(){var main;return main=new ProductReviews.Views.Main({reviewable:reviewable,dealUrl:dealUrl,dealTitle:dealTitle,collection:collection,helpfulCollection:helpfulCollection,model:model,reviewCount:reviewCount,minimumReviewLength:minimumReviewLength,maximumReviewLength:maximumReviewLength}),collection.view=main,helpfulCollection.view=main,model.view=main,$(".product-reviews-anchor").click(function(e){return e.preventDefault(),$("html,body").animate({scrollTop:$("#product-reviews").offset().top},"slow")}),done()})):done()},void function(){var TWENTY_YEARS;TWENTY_YEARS=63072e4,window.BuyNowTooltip={init:function(param$,done){var cookieDomain;return cookieDomain=param$.cookieDomain,Cookie.get("hide-buy-now-tooltip")?done():$(document).ready(function(){var $focusEl,$tooltip,$trigger,handleTooltipEvents,onBlur,onTooltipClose;return $tooltip=$("#buy-now-tooltip"),$tooltip.length?(null!=cookieDomain||(cookieDomain=window.location.hostname),$trigger=$("#buy-now-tooltip-trigger"),GIG.Tooltip.helpers.tooltip.apply($trigger,[{preventDefault:function(){}}]),onTooltipClose=function(){return Cookie.set("hide-buy-now-tooltip","true",TWENTY_YEARS,cookieDomain),$trigger.removeAttr("data-trigger-event")},onBlur=function(){return onTooltipClose(),GIG.Tooltip.close($tooltip)},handleTooltipEvents=function(){return $focusEl.unbind("blur",onBlur),$tooltip.unbind("mouseleave"),$tooltip.mouseleave(function(){return $focusEl.focus(),$focusEl.blur(onBlur)})},$focusEl=$tooltip.find("#buy-now-tooltip-focus"),$focusEl.focus().blur(onBlur),$tooltip.on("click",".tooltip-close",onTooltipClose),$tooltip.on("mousedown mouseenter",handleTooltipEvents),done()):done()})}}}.call(this),window.DealLazyLoader={init:function(payload,done){return $(function(){return $(document.body).on("modal-open",function(e,data){return $("#"+data.id).find(".lazy-load").lazyload()}),done()})}},$(window).load(function(){return Groupon.Performance.pageReady()}),null!=window.VariationsWidget?window.VariationsWidget:window.VariationsWidget={},null!=VariationsWidget.Models?VariationsWidget.Models:VariationsWidget.Models={},VariationsWidget.Models.Option=Backbone.Model.extend({initialize:function(){}}),null!=window.VariationsWidget?window.VariationsWidget:window.VariationsWidget={},null!=VariationsWidget.Collections?VariationsWidget.Collections:VariationsWidget.Collections={},null!=VariationsWidget.Collections.Option?VariationsWidget.Collections.Option:VariationsWidget.Collections.Option={},VariationsWidget.Collections.Option=Backbone.Collection.extend({model:VariationsWidget.Models.Option,chosen:function(value){return this.find(function(trait){return trait.get("traitValue")===value})},selected:function(){return this.find(function(trait){return trait.get("selected")})},setSelected:function(id){return this.selected().set("selected",!1),this.get(id).set("selected",!0)}}),VariationsWidget.Collections.Option.create=function(traits){return function(accum$){for(var data,trait,i$=0,length$=traits.length;length$>i$;++i$)trait=traits[i$],data=function(accum$1){for(var option,i$1=0,length$1=trait.data.length;length$1>i$1;++i$1)option=trait.data[i$1],accum$1.push({traitValue:option.value,disabled:!1,traitIndex:option.traitIndex,traitName:option.name,id:option.optionIndex,selected:0===option.optionIndex});return accum$1}.call(this,[]),accum$.push(new VariationsWidget.Collections.Option(data));return accum$}.call(this,[])},null!=window.VariationsWidget?window.VariationsWidget:window.VariationsWidget={},null!=VariationsWidget.Views?VariationsWidget.Views:VariationsWidget.Views={},VariationsWidget.Views.Option=Backbone.View.extend({initialize:function(){return _.bindAll(this,"render"),this.model.bind("change:disabled",this.render)},render:function(){return this.$el.attr("disabled",this.model.get("disabled"))}}),null!=window.VariationsWidget?window.VariationsWidget:window.VariationsWidget={},null!=VariationsWidget.Views?VariationsWidget.Views:VariationsWidget.Views={},VariationsWidget.Views.OptionCollection=Backbone.View.extend({events:{change:"selectionChanged"},initialize:function(){return _.bindAll(this,"selectionChanged","render"),this.optionElementViews=function(accum$){for(var optionElementModel,i$=0,length$=this.collection.models.length;length$>i$;++i$)optionElementModel=this.collection.models[i$],accum$.push(new VariationsWidget.Views.Option({el:"#trait-"+optionElementModel.get("traitIndex")+"-"+optionElementModel.get("id"),model:optionElementModel}));return accum$}.call(this,[])},render:function(){return function(accum$){for(var optionElementView,i$=0,length$=this.optionElementViews.length;length$>i$;++i$)optionElementView=this.optionElementViews[i$],accum$.push(optionElementView.render());return accum$}.call(this,[])},isSelectedOptionDisabled:function(selectElement){return null!=selectElement?selectElement.options[selectElement.selectedIndex].disabled:void 0},selectionChanged:function(e){var $currentElement,model,value;return $currentElement=$(e.currentTarget)[0],VariationsWidget.controller.ie7&&this.isSelectedOptionDisabled($currentElement)&&($currentElement.selectedIndex=0),value=$(e.currentTarget).val(),model=this.collection.chosen(value),VariationsWidget.controller.render({trait:this.collection.models[0].get("traitName"),selection:value,id:model.get("id")})}}),VariationsWidget.Views.OptionCollection.create=function(collections){return function(accum$){for(var index,trait,i$=0,length$=collections.length;length$>i$;++i$)trait=collections[i$],index=i$,accum$.push(new VariationsWidget.Views.OptionCollection({collection:trait,el:"#trait-"+index}));return accum$}.call(this,[])},null!=window.VariationsWidget?window.VariationsWidget:window.VariationsWidget={},null!=VariationsWidget.Views?VariationsWidget.Views:VariationsWidget.Views={},VariationsWidget.Views.Error=Backbone.View.extend({show:function(){return this.$el.show()},hide:function(){return this.$el.hide()}}),void function(){var generateCartUrl;generateCartUrl=function(optionuuid,dealuuid){return"/cart/add/"+optionuuid+"?deal_id="+dealuuid},"undefined"!=typeof window&&null!=window&&(null!=window.Cart?window.Cart:window.Cart={},null!=Cart.Helpers?Cart.Helpers:Cart.Helpers={},Cart.Helpers.generateCartUrl=generateCartUrl),"undefined"!=typeof module&&null!=module&&(module.exports={generateCartUrl:generateCartUrl})}.call(this),null!=window.VariationsWidget?window.VariationsWidget:window.VariationsWidget={},VariationsWidget.Controller=function(){function Controller(){var instance$;instance$=this,this.findSelectedCollections=function(){return Controller.prototype.findSelectedCollections.apply(instance$,arguments)},this.findDefaultCollections=function(){return Controller.prototype.findDefaultCollections.apply(instance$,arguments)},this.isSelectionDefault=function(){return Controller.prototype.isSelectionDefault.apply(instance$,arguments)},"IE"===("undefined"!=typeof OptimizeSuite&&null!=OptimizeSuite?OptimizeSuite.TrackingHub.user.browser:void 0)&&"7.0"===OptimizeSuite.TrackingHub.user.browserVersion&&(this.ie7=!0),"undefined"!=typeof I18n&&null!=I18n&&(this.i18n=I18n.scoped()),this.updateSelectElements("",!0),this.availableOptions=this.getAvailableOptions(),this.cheapestOption=this.getCheapestOption(this.availableOptions),this.lastImage="",this.$selectElements=$("#variation-traits").find(".variation-trait"),(null!=VariationsWidget.preSelectTraits?VariationsWidget.preSelectTraits.length:void 0)?this.makeSelectionsViaPreselection():this.updateSelectionsToDefault()}return Controller.prototype.render=function(latestSelection,updateCarousel){null==updateCarousel&&(updateCarousel=!0),null!=latestSelection.selection&&(this.updateSelections(latestSelection),this.updateSelectElements(latestSelection.trait),this.availableOptions=this.getAvailableOptions(),this.cheapestOption=this.getCheapestOption(this.availableOptions),this.updatePricing(this.cheapestOption,this.availableOptions.length),updateCarousel&&this.updateCarousel(),this.removeErrorMessages())},Controller.prototype.updateSelectionsToDefault=function(){return function(accum$){for(var selectElement,cache$=this.$selectElements||[],i$=0,length$=cache$.length;length$>i$;++i$)selectElement=cache$[i$],accum$.push($(selectElement).find("option:eq(0)").prop("selected",!0));return accum$}.call(this,[])},Controller.prototype.updateSelections=function(latestSelection){for(var collection,i$=0,length$=VariationsWidget.collections.length;length$>i$;++i$)if(collection=VariationsWidget.collections[i$],collection.models[0].get("traitName")===latestSelection.trait){collection.setSelected(latestSelection.id);break}},Controller.prototype.updateSelectElements=function(latestSelection,updateAll){var collection,conditions,enabledOptions,temp,tempCollection,tempSelected,tempSelectedTraitValue,trait,traitName,values;null==updateAll&&(updateAll=!1),temp=VariationsWidget.collections;for(var i$=0,length$=VariationsWidget.collections.length;length$>i$;++i$)if(collection=VariationsWidget.collections[i$],traitName=collection.models[0].get("traitName"),traitName!==latestSelection||updateAll){conditions={};for(var i$1=0,length$1=temp.length;length$1>i$1;++i$1)tempCollection=temp[i$1],tempSelected=tempCollection.selected(),tempSelectedTraitValue=tempSelected.get("traitValue"),tempSelectedTraitValue===collection.selected().get("traitValue")||this.isSelectionDefault(tempSelectedTraitValue)||(conditions[tempSelected.get("traitName")]=tempSelectedTraitValue);enabledOptions=[],enabledOptions=$.isEmptyObject(conditions)?VariationsWidget.options:_.where(VariationsWidget.options,conditions),values=_.pluck(enabledOptions,traitName),values.unshift(""+this.i18n.t("js.modules.variations.selector")+" "+traitName);for(var i$2=0,length$2=VariationsWidget.collections.length;length$2>i$2;++i$2)trait=VariationsWidget.collections[i$2],trait.models[0].get("traitName")===traitName&&trait.each(function(model){return 0===model.id||_.contains(values,model.get("traitValue"))?model.set("disabled",!1):model.set("disabled",!0)})}return this.ie7?($("option").removeClass("ie7-color"),$("option[disabled]").addClass("ie7-color")):void 0},Controller.prototype.getAvailableOptions=function(){var collection,options,properties,selectedTrait,selectedTraitValue;properties={};for(var i$=0,length$=VariationsWidget.collections.length;length$>i$;++i$)collection=VariationsWidget.collections[i$],selectedTrait=collection.selected(),selectedTraitValue=selectedTrait.get("traitValue"),this.isSelectionDefault(selectedTraitValue)||(properties[selectedTrait.get("traitName")]=selectedTraitValue);return options=$.isEmptyObject(properties)?VariationsWidget.options:_.where(VariationsWidget.options,properties)},Controller.prototype.getCheapestOption=function(availableOptions){var currentCheapest,element;currentCheapest=availableOptions[0];for(var i$=0,length$=availableOptions.length;length$>i$;++i$)element=availableOptions[i$],element.amount<currentCheapest.amount&&(currentCheapest=element);return currentCheapest},Controller.prototype.overridePriceDataWithSaleInfo=function(priceData,option){var offer,sale;if(null!=(null!=option?option.regularPrice:void 0)||null!=(null!=VariationsWidget.offerCollections?VariationsWidget.offerCollections.offerOptions:void 0)){sale={},option.regularPrice&&_.extend(sale,{urgencyPricing:{regularPrice:option.regularPrice,newPrice:option.newPrice,pricingMetadata:option.pricingMetadata}});for(var cache$=(null!=VariationsWidget.offerCollections?VariationsWidget.offerCollections.offerOptions:void 0)||[],i$=0,length$=cache$.length;length$>i$;++i$)offer=cache$[i$],offer.uuid===option.uuid&&_.extend(sale,{offer:offer});return sale!=={}?_.extend(priceData,{sale:sale}):void 0}},Controller.prototype.updatePricing=function(cheapestOption,length){var priceData;return priceData={value:cheapestOption.oldPrice,percent:cheapestOption.discount,savings:cheapestOption.savePrice,price:cheapestOption.newPrice,lengthClass:cheapestOption.lengthClass,buyUrl:this.buyButtonUrl(cheapestOption),uuid:cheapestOption.uuid,variationsSelected:1===length&&!this.areAnySelectionsDefault(VariationsWidget.collections)},this.overridePriceDataWithSaleInfo(priceData,cheapestOption),DealEventPipe.trigger("priceUpdate",priceData)
},Controller.prototype.buyButtonUrl=function(cheapestOption){return(null!=cheapestOption.externalUrl?cheapestOption.externalUrl.length:void 0)?cheapestOption.externalUrl:("undefined"!=typeof payload&&null!=payload?payload.cartStatus:void 0)?Cart.Helpers.generateCartUrl(cheapestOption.uuid,VariationsWidget.uuid):cheapestOption.url},Controller.prototype.updateCarousel=function(){var currentImage,foundMatch,imageUrl,valuesHash;if(this.areSelectionsDefault(VariationsWidget.collections))DealCarousel.carouselViews[payload.carousel.dealId].updateGallery(DealCarousel.dealMedia[payload.carousel.dealId].models[0]);else for(imageUrl in VariationsWidget.mappings)if(valuesHash=VariationsWidget.mappings[imageUrl],foundMatch=_.every(VariationsWidget.collections,function(this$){return function(collection){var selectedTrait,selectedTraitValue;return selectedTrait=collection.selected(),selectedTraitValue=selectedTrait.get("traitValue"),this$.isSelectionDefault(selectedTraitValue)?!0:_.contains(valuesHash[selectedTrait.get("traitName")],selectedTraitValue)}}(this)),currentImage=DealCarousel.carouselViews[payload.carousel.dealId].currentFeatured.baseURL,foundMatch&&currentImage!==imageUrl){this.changeToMatchingImage(imageUrl);break}},Controller.prototype.changeToMatchingImage=function(imgPath){var image;return this.lastImage=imgPath,image=DealCarousel.dealMedia[payload.carousel.dealId].findWhere({thumb:""+imgPath+"t100x100.jpg"}),DealCarousel.carouselViews[payload.carousel.dealId].updateGallery(image)},Controller.prototype.findMatchingTraits=function(img){var key,selections,value;if(this.lastImage=img,selections=[],null!=VariationsWidget.mappings[img])for(key in VariationsWidget.mappings[img])value=VariationsWidget.mappings[img][key],1===value.length&&selections.push({trait:key,selection:value[0]});return this.makeSelectionsViaCarousel(selections)},Controller.prototype.makeSelectionsViaCarousel=function(selections){return this.clearSelections(),this.makeSelections(selections)},Controller.prototype.makeSelectionsViaPreselection=function(){var collection,option,selections,trait;if(option=_.findWhere(VariationsWidget.options,{uuid:VariationsWidget.dealOptionUuid}),null!=option){selections=[];for(var cache$=VariationsWidget.preSelectTraits||[],i$=0,length$=cache$.length;length$>i$;++i$){trait=cache$[i$];for(var cache$1=VariationsWidget.collections||[],i$1=0,length$1=cache$1.length;length$1>i$1;++i$1)if(collection=cache$1[i$1],collection.models[0].get("traitName")===trait){selections.push({trait:trait,selection:option[trait]});break}}return this.makeSelections(selections)}},Controller.prototype.clearSelections=function(){return function(accum$){for(var collection,data,selectedTrait,selectedTraitName,selection,cache$=VariationsWidget.collections||[],i$=0,length$=cache$.length;length$>i$;++i$)collection=cache$[i$],selectedTrait=collection.selected(),selectedTraitName=selectedTrait.get("traitName"),accum$.push(this.isSelectionDefault(selectedTrait.get("traitValue"))?void 0:(selection=this.i18n.t("js.modules.variations.select",{name:selectedTraitName}),data={trait:selectedTraitName,selection:selection,id:0},$("#trait-"+selectedTrait.get("traitIndex")).val(selection),null==$("#trait-"+selectedTrait.get("traitIndex")).val()?$("#trait-"+selectedTrait.get("traitIndex")).prop("selectedIndex",0):void 0,this.render(data,!1)));return accum$}.call(this,[])},Controller.prototype.makeSelections=function(selections){for(var collection,element,trait,cache$=selections||[],i$=0,length$=cache$.length;length$>i$;++i$){element=cache$[i$];for(var cache$1=VariationsWidget.collections||[],i$1=0,length$1=cache$1.length;length$1>i$1;++i$1)if(collection=cache$1[i$1],collection.models[0].get("traitName")===element.trait&&(trait=collection.findWhere({traitValue:element.selection}),!trait.get("disabled"))){element.id=trait.get("id"),$("#trait-"+collection.models[0].get("traitIndex")).val(element.selection),this.render(element,!1);break}}},Controller.prototype.showErrorMessages=function(){var defaultCollections;return VariationsWidget.error.show(),VariationsWidget.error.$el.addClass("icon-circle-alert"),defaultCollections=this.findDefaultCollections(VariationsWidget.collections),function(accum$){for(var index,i$=0,length$=defaultCollections.length;length$>i$;++i$)index=defaultCollections[i$],accum$.push($("#trait-"+index).addClass("select-error"));return accum$}.call(this,[])},Controller.prototype.removeErrorMessages=function(){var selectedCollections;return this.areAnySelectionsDefault(VariationsWidget.collections)||VariationsWidget.error.hide(),selectedCollections=this.findSelectedCollections(VariationsWidget.collections),function(accum$){for(var index,i$=0,length$=selectedCollections.length;length$>i$;++i$)index=selectedCollections[i$],accum$.push($("#trait-"+index).removeClass("select-error"));return accum$}.call(this,[])},Controller.prototype.areSelectionsDefault=function(collections){return _.every(collections,function(this$){return function(collection){return RegExp(""+this$.i18n.t("js.modules.variations.selector")+" ","i").test(collection.selected().get("traitValue"))}}(this))},Controller.prototype.areAnySelectionsDefault=function(collections){return _.some(collections,function(this$){return function(collection){return RegExp(""+this$.i18n.t("js.modules.variations.selector")+" ","i").test(collection.selected().get("traitValue"))}}(this))},Controller.prototype.isSelectionDefault=function(selection){return RegExp(""+this.i18n.t("js.modules.variations.selector")+" ","i").test(selection)},Controller.prototype.findDefaultCollections=function(collections){var collection,defaultCollections,index;defaultCollections=[];for(var i$=0,length$=collections.length;length$>i$;++i$)collection=collections[i$],index=i$,RegExp(""+this.i18n.t("js.modules.variations.selector")+" ","i").test(collection.selected().get("traitValue"))&&defaultCollections.push(index);return defaultCollections},Controller.prototype.findSelectedCollections=function(collections){var collection,index,selectedCollections;selectedCollections=[];for(var i$=0,length$=collections.length;length$>i$;++i$)collection=collections[i$],index=i$,RegExp(""+this.i18n.t("js.modules.variations.selector")+" ","i").test(collection.selected().get("traitValue"))||selectedCollections.push(index);return selectedCollections},Controller}(),void function(){var _scrollToBuyButton;null!=window.VariationsWidget?window.VariationsWidget:window.VariationsWidget={},_scrollToBuyButton=function(){var top;return $("#purchase-cluster .buy.fixed").length>0?(top=$("#purchase-cluster").position().top,$("body").animate({scrollTop:top+50},500)):void 0},VariationsWidget.init=function(param$,done){var cache$,cache$1,offer,stickyHeader,variations;return cache$=param$,variations=cache$.variations,offer=cache$.offer,stickyHeader=cache$.stickyHeader,null==variations?done():(cache$1=variations,this.options=cache$1.options,this.traits=cache$1.traits,this.mappings=cache$1.mappings,this.uuid=cache$1.uuid,this.dealOptionUuid=cache$1.dealOptionUuid,this.preSelectTraits=cache$1.preSelectTraits,this.collections=VariationsWidget.Collections.Option.create(this.traits),this.offerCollections=offer,BuyButton.eventBus.board("buy_button_clicked",function(this$){return function(){return BuyButton.view.variationsSelected?void 0:(this$.controller.showErrorMessages(),stickyHeader&&_scrollToBuyButton(),BuyButton.view.enableBuyButton(),{stopTheBus:!0})}}(this)),$(function(this$){return function(){return this$.views=VariationsWidget.Views.OptionCollection.create(this$.collections),this$.error=new VariationsWidget.Views.Error({el:".error"}),this$.controller=new VariationsWidget.Controller,$(document.body).on("carouselUpdate",function(this$1){return function(e,data){return data.image!==this$1.controller.lastImage?this$1.controller.findMatchingTraits(data.image):void 0}}(this$)),done()}}(this)))}}.call(this),function(g,H,T){g.BookingTemplates={booking_frontend_templates_deal_booker:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.s(_.f("error",c,p,1),c,p,1,0,0,"")||(_.s(_.f("isOpen",c,p,1),c,p,1,0,0,"")||(_.b('    <div class="open">'),_.b("\n"+i),_.b("      <small>"),_.s(_.f("t",c,p,1),c,p,0,67,129,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.please_note, "noteOpen": "<strong>", "noteClose": "</strong>"')}),c.pop()),_.b("</small>"),_.b("\n"+i),_.b('      <input type="button" class="btn" value="'),_.s(_.f("t",c,p,1),c,p,0,196,215,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".check_availability")}),c.pop()),_.b('">'),_.b("\n"+i),_.b("    </div>"),_.b("\n")),_.s(_.f("isOpen",c,p,1),c,p,0,262,785,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('    <form class="booking-component">'),_.b("\n"+i),_.s(_.f("isLocked",c,p,1),c,p,1,0,0,"")||(_.b('        <span class="icon-close close"><span>X</span></span>'),_.b("\n")),_.b('      <div data-info-content class="info"></div>'),_.b("\n"+i),_.b('      <div data-pickers-content class="pickers"></div>'),_.b("\n"+i),_.s(_.f("questionRequired",c,p,1),c,p,0,532,594,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('        <div data-question-content class="text"></div>'),_.b("\n")}),c.pop()),_.s(_.f("phoneRequired",c,p,1),c,p,0,640,699,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('        <div data-phone-content class="text"></div>'),_.b("\n")}),c.pop()),_.b('      <div data-book-now-content class="book"></div>'),_.b("\n"+i),_.b("    </form>"),_.b("\n")}),c.pop())),_.s(_.f("error",c,p,1),c,p,0,818,1373,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('  <div class="open" data-bhw="BookingEngineDealBookerError">'),_.b("\n"+i),_.b('    <div class="notification error" data-bhc="error:'),_.b(_.v(_.f("error",c,p,0))),_.b('">'),_.b("\n"+i),_.s(_.f("errorLoading",c,p,1),c,p,0,967,1009,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("        "),_.s(_.f("t",c,p,1),c,p,0,982,996,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".error.loading")}),c.pop()),_.b("\n")}),c.pop()),_.s(_.f("errorBooking",c,p,1),c,p,0,1050,1109,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("        "),_.s(_.f("t",c,p,1),c,p,0,1065,1096,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.error.booking, "break": "<br>"')}),c.pop()),_.b("\n")}),c.pop()),_.s(_.f("errorSegmentNotAvailable",c,p,1),c,p,0,1162,1218,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("        "),_.s(_.f("t",c,p,1),c,p,0,1177,1205,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".error.segment_not_available")}),c.pop()),_.b("\n")}),c.pop()),_.s(_.f("errorSegmentExpired",c,p,1),c,p,0,1278,1328,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("        "),_.s(_.f("t",c,p,1),c,p,0,1293,1315,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".error.segment_expired")}),c.pop()),_.b("\n")}),c.pop()),_.b("    </div>"),_.b("\n"+i),_.b("  </div>"),_.b("\n")}),c.pop()),_.fl()},'{{^error}}\n  {{^isOpen}}\n    <div class="open">\n      <small>{{#t}}.please_note, "noteOpen": "<strong>", "noteClose": "</strong>"{{/t}}</small>\n      <input type="button" class="btn" value="{{#t}}.check_availability{{/t}}">\n    </div>\n  {{/isOpen}}\n  {{#isOpen}}\n    <form class="booking-component">\n      {{^isLocked}}\n        <span class="icon-close close"><span>X</span></span>\n      {{/isLocked}}\n      <div data-info-content class="info"></div>\n      <div data-pickers-content class="pickers"></div>\n      {{#questionRequired}}\n        <div data-question-content class="text"></div>\n      {{/questionRequired}}\n      {{#phoneRequired}}\n        <div data-phone-content class="text"></div>\n      {{/phoneRequired}}\n      <div data-book-now-content class="book"></div>\n    </form>\n  {{/isOpen}}\n{{/error}}\n{{#error}}\n  <div class="open" data-bhw="BookingEngineDealBookerError">\n    <div class="notification error" data-bhc="error:{{error}}">\n      {{#errorLoading}}\n        {{#t}}.error.loading{{/t}}\n      {{/errorLoading}}\n      {{#errorBooking}}\n        {{#t}}.error.booking, "break": "<br>"{{/t}}\n      {{/errorBooking}}\n      {{#errorSegmentNotAvailable}}\n        {{#t}}.error.segment_not_available{{/t}}\n      {{/errorSegmentNotAvailable}}\n      {{#errorSegmentExpired}}\n        {{#t}}.error.segment_expired{{/t}}\n      {{/errorSegmentExpired}}\n    </div>\n  </div>\n{{/error}}\n',H,{}),booking_frontend_templates_book:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b("<"),_.s(_.f("bookAndBuy",c,p,1),c,p,0,16,22,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("button")}),c.pop()),_.s(_.f("bookAndBuy",c,p,1),c,p,1,0,0,"")||_.b("input"),_.b("\n"+i),_.b('  type="submit"'),_.b("\n"+i),_.b('  class="'),_.s(_.f("bookAndBuy",c,p,1),c,p,0,113,169,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("btn-buy-big "),_.s(_.f("isDisabled",c,p,1),c,p,0,140,154,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("state-disabled")}),c.pop())}),c.pop()),_.s(_.f("bookAndBuy",c,p,1),c,p,1,0,0,"")||_.b("btn"),_.b('"'),_.b("\n"+i),_.b("  "),_.s(_.f("isDisabled",c,p,1),c,p,0,236,244,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("disabled")}),c.pop()),_.b("\n"+i),_.b("  "),_.s(_.f("bookAndBuy",c,p,1),c,p,1,0,0,"")||(_.b('value="'),_.s(_.f("reschedule",c,p,1),c,p,0,299,322,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("t",c,p,1),c,p,0,305,316,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".reschedule")}),c.pop())}),c.pop()),_.s(_.f("reschedule",c,p,1),c,p,1,0,0,"")||(_.s(_.f("requestAppointment",c,p,1),c,p,1,0,0,"")||_.s(_.f("t",c,p,1),c,p,0,381,390,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".schedule")}),c.pop()),_.s(_.f("requestAppointment",c,p,1),c,p,0,442,462,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("t",c,p,1),c,p,0,448,456,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".request")}),c.pop())}),c.pop())),_.b('"')),_.b(">"),_.b("\n"+i),_.b("  "),_.s(_.f("bookAndBuy",c,p,1),c,p,0,535,629,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("notYet",c,p,1),c,p,1,0,0,"")||_.s(_.f("t",c,p,1),c,p,0,552,561,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".book_buy")}),c.pop()),_.s(_.f("notYet",c,p,1),c,p,0,589,609,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("t",c,p,1),c,p,0,595,603,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".not_yet")}),c.pop())}),c.pop()),_.b("</button>")}),c.pop()),_.b("\n"),_.fl()},'<{{#bookAndBuy}}button{{/bookAndBuy}}{{^bookAndBuy}}input{{/bookAndBuy}}\n  type="submit"\n  class="{{#bookAndBuy}}btn-buy-big {{#isDisabled}}state-disabled{{/isDisabled}}{{/bookAndBuy}}{{^bookAndBuy}}btn{{/bookAndBuy}}"\n  {{#isDisabled}}disabled{{/isDisabled}}\n  {{^bookAndBuy}}value="{{#reschedule}}{{#t}}.reschedule{{/t}}{{/reschedule}}{{^reschedule}}{{^requestAppointment}}{{#t}}.schedule{{/t}}{{/requestAppointment}}{{#requestAppointment}}{{#t}}.request{{/t}}{{/requestAppointment}}{{/reschedule}}"{{/bookAndBuy}}>\n  {{#bookAndBuy}}{{^notYet}}{{#t}}.book_buy{{/t}}{{/notYet}}{{#notYet}}{{#t}}.not_yet{{/t}}{{/notYet}}</button>{{/bookAndBuy}}\n',H,{}),booking_frontend_templates_calendar:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<table class="calendar">'),_.b("\n"+i),_.b("  <thead>"),_.b("\n"+i),_.b("    <tr>"),_.b("\n"+i),_.b('      <th colspan="7">'),_.b("\n"+i),_.b('        <span class="previous icon-arrow-left-large'),_.s(_.f("lastMonthAvailable",c,p,1),c,p,1,0,0,"")||_.b(" disabled"),_.b('"><span>&lt;</span></span>'),_.b("\n"+i),_.b('        <span class="next icon-arrow-right-large'),_.s(_.f("nextMonthAvailable",c,p,1),c,p,1,0,0,"")||_.b(" disabled"),_.b('"><span>&gt;</span></span>'),_.b("\n"+i),_.b("        "),_.b(_.v(_.f("month",c,p,0))),_.b("\n"+i),_.b("      </th>"),_.b("\n"+i),_.b("    </tr>"),_.b("\n"+i),_.b("  </thead>"),_.b("\n"+i),_.b("  <tbody>"),_.b("\n"+i),_.b('    <tr class="week-titles">'),_.b("\n"+i),_.s(_.f("daysOfTheWeek",c,p,1),c,p,0,444,472,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("      <td>"),_.b(_.v(_.d(".",c,p,0))),_.b("</td>"),_.b("\n")}),c.pop()),_.b("    </tr>"),_.b("\n"+i),_.s(_.f("rows",c,p,1),c,p,0,514,778,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('    <tr class="week">'),_.b("\n"+i),_.s(_.f("days",c,p,1),c,p,0,552,754,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('      <td class="'),_.b(_.v(_.f("classes",c,p,0))),_.b(" "),_.s(_.d("events.length",c,p,1),c,p,0,600,609,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("available")}),c.pop()),_.s(_.d("events.length",c,p,1),c,p,1,0,0,"")||_.b("unavailable"),_.b('" data-bhc="'),_.b(_.v(_.f("bhc",c,p,0))),_.b('">'),_.b("\n"+i),_.b("        <div><span>"),_.b(_.v(_.f("day",c,p,0))),_.b("</span></div>"),_.b("\n"+i),_.b("      </td>"),_.b("\n")}),c.pop()),_.b("    </tr>"),_.b("\n")}),c.pop()),_.b("  </tbody>"),_.b("\n"+i),_.b("</table>"),_.b("\n"+i),_.s(_.f("loaded",c,p,1),c,p,1,0,0,"")||(_.b('<div class="loading csspseudoanimations">'),_.b("\n"+i),_.b('  <div class="overlay"></div>'),_.b("\n"+i),_.b('  <div class="icon-g-loader"></div>'),_.b("\n"+i),_.b("</div>"),_.b("\n")),_.fl()},'<table class="calendar">\n  <thead>\n    <tr>\n      <th colspan="7">\n        <span class="previous icon-arrow-left-large{{^lastMonthAvailable}} disabled{{/lastMonthAvailable}}"><span>&lt;</span></span>\n        <span class="next icon-arrow-right-large{{^nextMonthAvailable}} disabled{{/nextMonthAvailable}}"><span>&gt;</span></span>\n        {{month}}\n      </th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr class="week-titles">\n      {{#daysOfTheWeek}}\n      <td>{{.}}</td>\n      {{/daysOfTheWeek}}\n    </tr>\n    {{#rows}}\n    <tr class="week">\n      {{#days}}\n      <td class="{{classes}} {{#events.length}}available{{/events.length}}{{^events.length}}unavailable{{/events.length}}" data-bhc="{{bhc}}">\n        <div><span>{{day}}</span></div>\n      </td>\n      {{/days}}\n    </tr>\n    {{/rows}}\n  </tbody>\n</table>\n{{^loaded}}\n<div class="loading csspseudoanimations">\n  <div class="overlay"></div>\n  <div class="icon-g-loader"></div>\n</div>\n{{/loaded}}\n',H,{}),booking_frontend_templates_datepicker:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<div class="wrapper">'),_.b("\n"+i),_.b('  <div class="dropdown'),_.s(_.f("selectable",c,p,1),c,p,0,59,70,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(" selectable")}),c.pop()),_.b('">'),_.b("\n"+i),_.b('    <span class="icon-calendar icon"></span>'),_.b("\n"+i),_.b('    <span class="selection'),_.s(_.f("loading",c,p,1),c,p,0,171,179,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(" loading")}),c.pop()),_.b('">'),_.b("\n"+i),_.b("      "),_.s(_.f("loading",c,p,1),c,p,0,212,232,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("t",c,p,1),c,p,0,218,226,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".loading")}),c.pop())}),c.pop()),_.b("\n"+i),_.s(_.f("loading",c,p,1),c,p,1,0,0,"")||(_.b("        "),_.s(_.f("selectedDate",c,p,1),c,p,1,0,0,"")||_.s(_.f("t",c,p,1),c,p,0,295,302,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".select")}),c.pop()),_.b("\n"+i),_.b("        "),_.s(_.f("selectedDate",c,p,1),c,p,0,351,428,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("t",c,p,1),c,p,0,357,422,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.selected, "month": '),_.b(_.v(_.f("month",c,p,0))),_.b(', "date": '),_.b(_.v(_.f("date",c,p,0))),_.b(', "year": '),_.b(_.v(_.f("year",c,p,0)))}),c.pop())}),c.pop()),_.b("\n")),_.b("    </span>"),_.b("\n"+i),_.s(_.f("selectable",c,p,1),c,p,0,496,636,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('    <span class="arrow">'),_.b("\n"+i),_.b('      <span class="icon-arrow-down-large"></span>'),_.b("\n"+i),_.b('      <span class="icon-arrow-up-large"></span>'),_.b("\n"+i),_.b("    </span>"),_.b("\n")}),c.pop()),_.b("  </div>"),_.b("\n"+i),_.b('  <div class="content"></div>'),_.b("\n"+i),_.b("</div>"),_.b("\n"),_.fl()},'<div class="wrapper">\n  <div class="dropdown{{#selectable}} selectable{{/selectable}}">\n    <span class="icon-calendar icon"></span>\n    <span class="selection{{#loading}} loading{{/loading}}">\n      {{#loading}}{{#t}}.loading{{/t}}{{/loading}}\n      {{^loading}}\n        {{^selectedDate}}{{#t}}.select{{/t}}{{/selectedDate}}\n        {{#selectedDate}}{{#t}}.selected, "month": {{month}}, "date": {{date}}, "year": {{year}}{{/t}}{{/selectedDate}}\n      {{/loading}}\n    </span>\n    {{#selectable}}\n    <span class="arrow">\n      <span class="icon-arrow-down-large"></span>\n      <span class="icon-arrow-up-large"></span>\n    </span>\n    {{/selectable}}\n  </div>\n  <div class="content"></div>\n</div>\n',H,{}),booking_frontend_templates_info:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<span class="price-label">'),_.b("\n"+i),_.s(_.f("optionSelected",c,p,1),c,p,0,46,67,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("t",c,p,1),c,p,0,52,61,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".subtotal")}),c.pop())}),c.pop()),_.b("\n"+i),_.s(_.f("optionSelected",c,p,1),c,p,1,0,0,"")||_.s(_.f("t",c,p,1),c,p,0,112,117,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".from")}),c.pop()),_.b("\n"+i),_.b("</span>"),_.b("\n"+i),_.b('<span class="price">'),_.b("\n"+i),_.b(_.v(_.f("price",c,p,0))),_.b("\n"+i),_.b("</span>"),_.b("\n"),_.fl()},'<span class="price-label">\n{{#optionSelected}}{{#t}}.subtotal{{/t}}{{/optionSelected}}\n{{^optionSelected}}{{#t}}.from{{/t}}{{/optionSelected}}\n</span>\n<span class="price">\n{{price}}\n</span>\n',H,{}),booking_frontend_templates_option:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<div class="'),_.s(_.f("isSoldOut",c,p,1),c,p,0,26,34,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("sold-out")}),c.pop()),_.b(" "),_.s(_.f("selected",c,p,1),c,p,0,62,70,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("selected")}),c.pop()),_.b('" data-bhc="booking:deal-option-'),_.b(_.v(_.f("optionId",c,p,0))),_.b('">'),_.b("\n"+i),_.b("  <div>"),_.b("\n"+i),_.b('    <span class="option-price">'),_.b(_.v(_.f("price",c,p,0))),_.b("</span>"),_.b("\n"+i),_.b('    <span class="option-price-original">'),_.b(_.v(_.f("value",c,p,0))),_.b("</span>"),_.b("\n"+i),_.b("  </div>"),_.b("\n"+i),_.b('  <div class="description">'),_.b(_.v(_.f("title",c,p,0))),_.b("</div>"),_.b("\n"+i),_.b('  <span class="option-info">'),_.b("\n"+i),_.s(_.f("isSoldOut",c,p,1),c,p,0,342,384,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("      <em>"),_.s(_.f("t",c,p,1),c,p,0,359,368,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".sold_out")}),c.pop()),_.b("</em>"),_.b("\n")}),c.pop()),_.s(_.f("isSoldOut",c,p,1),c,p,1,0,0,"")||(_.b("      "),_.s(_.f("t",c,p,1),c,p,0,430,517,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.discount_percent, "discountPercent": "'),_.b(_.v(_.f("discount",c,p,0))),_.b('", "em": "<em>",  "emClose": "</em>"')}),c.pop()),_.b("\n")),_.b("  </span>"),_.b("\n"+i),_.b("</div>"),_.b("\n"),_.fl()},'<div class="{{#isSoldOut}}sold-out{{/isSoldOut}} {{#selected}}selected{{/selected}}" data-bhc="booking:deal-option-{{optionId}}">\n  <div>\n    <span class="option-price">{{price}}</span>\n    <span class="option-price-original">{{value}}</span>\n  </div>\n  <div class="description">{{title}}</div>\n  <span class="option-info">\n    {{#isSoldOut}}\n      <em>{{#t}}.sold_out{{/t}}</em>\n    {{/isSoldOut}}\n    {{^isSoldOut}}\n      {{#t}}.discount_percent, "discountPercent": "{{discount}}", "em": "<em>",  "emClose": "</em>"{{/t}}\n    {{/isSoldOut}}\n  </span>\n</div>\n',H,{}),booking_frontend_templates_optionpicker:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<div class="wrapper">'),_.b("\n"+i),_.b('  <div class="dropdown'),_.s(_.f("selectable",c,p,1),c,p,0,59,70,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(" selectable")}),c.pop()),_.b('">'),_.b("\n"+i),_.b('    <span class="icon-tag icon"></span>'),_.b("\n"+i),_.b('    <span class="selection">'),_.b("\n"+i),_.b("      "),_.s(_.f("selectedOption",c,p,1),c,p,1,0,0,"")||_.s(_.f("t",c,p,1),c,p,0,188,195,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".select")}),c.pop()),_.b("\n"+i),_.b("      "),_.s(_.f("selectedOption",c,p,1),c,p,0,246,255,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(_.v(_.f("title",c,p,0)))}),c.pop()),_.b("\n"+i),_.b("    </span>"),_.b("\n"+i),_.s(_.f("selectable",c,p,1),c,p,0,306,446,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('    <span class="arrow">'),_.b("\n"+i),_.b('      <span class="icon-arrow-down-large"></span>'),_.b("\n"+i),_.b('      <span class="icon-arrow-up-large"></span>'),_.b("\n"+i),_.b("    </span>"),_.b("\n")}),c.pop()),_.b("  </div>"),_.b("\n"+i),_.b('  <div class="content"></div>'),_.b("\n"+i),_.b("</div>"),_.b("\n"),_.fl()},'<div class="wrapper">\n  <div class="dropdown{{#selectable}} selectable{{/selectable}}">\n    <span class="icon-tag icon"></span>\n    <span class="selection">\n      {{^selectedOption}}{{#t}}.select{{/t}}{{/selectedOption}}\n      {{#selectedOption}}{{title}}{{/selectedOption}}\n    </span>\n    {{#selectable}}\n    <span class="arrow">\n      <span class="icon-arrow-down-large"></span>\n      <span class="icon-arrow-up-large"></span>\n    </span>\n    {{/selectable}}\n  </div>\n  <div class="content"></div>\n</div>\n',H,{}),booking_frontend_templates_time:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.s(_.f("time",c,p,1),c,p,0,9,457,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("  <div"),_.s(_.f("selected",c,p,1),c,p,0,29,46,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(' class="selected"')}),c.pop()),_.b(">"),_.b("\n"+i),_.s(_.f("isRange",c,p,1),c,p,1,0,0,"")||(_.b("      "),_.s(_.f("t",c,p,1),c,p,0,90,191,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.default, "fromHours": '),_.b(_.v(_.d("from.hours",c,p,0))),_.b(', "fromMinutes": '),_.b(_.v(_.d("from.minutes",c,p,0))),_.b(', "fromPeriod": '),_.b(_.v(_.d("from.period",c,p,0)))}),c.pop()),_.b("\n")),_.s(_.f("isRange",c,p,1),c,p,0,231,435,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("      "),_.s(_.f("t",c,p,1),c,p,0,244,424,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.range, "fromHours": '),_.b(_.v(_.d("from.hours",c,p,0))),_.b(', "fromMinutes": '),_.b(_.v(_.d("from.minutes",c,p,0))),_.b(', "fromPeriod": '),_.b(_.v(_.d("from.period",c,p,0))),_.b(', "toHours": '),_.b(_.v(_.d("to.hours",c,p,0))),_.b(', "toMinutes": '),_.b(_.v(_.d("to.minutes",c,p,0))),_.b(', "toPeriod": '),_.b(_.v(_.d("to.period",c,p,0)))}),c.pop()),_.b("\n")}),c.pop()),_.b("  </div>"),_.b("\n")}),c.pop()),_.fl()},'{{#time}}\n  <div{{#selected}} class="selected"{{/selected}}>\n    {{^isRange}}\n      {{#t}}.default, "fromHours": {{from.hours}}, "fromMinutes": {{from.minutes}}, "fromPeriod": {{from.period}}{{/t}}\n    {{/isRange}}\n    {{#isRange}}\n      {{#t}}.range, "fromHours": {{from.hours}}, "fromMinutes": {{from.minutes}}, "fromPeriod": {{from.period}}, "toHours": {{to.hours}}, "toMinutes": {{to.minutes}}, "toPeriod": {{to.period}}{{/t}}\n    {{/isRange}}\n  </div>\n{{/time}}\n',H,{}),booking_frontend_templates_timepicker:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<div class="wrapper">'),_.b("\n"+i),_.b('  <div class="dropdown'),_.s(_.f("selectable",c,p,1),c,p,0,59,70,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(" selectable")}),c.pop()),_.b('">'),_.b("\n"+i),_.b('    <span class="icon-now icon"></span>'),_.b("\n"+i),_.b('    <span class="selection'),_.s(_.f("loading",c,p,1),c,p,0,166,174,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(" loading")}),c.pop()),_.b('">'),_.b("\n"+i),_.b("      "),_.s(_.f("loading",c,p,1),c,p,0,207,227,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("t",c,p,1),c,p,0,213,221,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".loading")}),c.pop())}),c.pop()),_.b("\n"+i),_.s(_.f("loading",c,p,1),c,p,1,0,0,"")||(_.s(_.f("isRange",c,p,1),c,p,1,0,0,"")||(_.b("          "),_.s(_.f("selection",c,p,1),c,p,1,0,0,"")||_.s(_.f("t",c,p,1),c,p,0,310,322,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".select_time")}),c.pop()),_.b("\n"+i),_.b("          "),_.s(_.f("selection",c,p,1),c,p,0,367,486,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("t",c,p,1),c,p,0,373,480,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.selected_time, "fromHours": '),_.b(_.v(_.d("from.hours",c,p,0))),_.b(', "fromMinutes": '),_.b(_.v(_.d("from.minutes",c,p,0))),_.b(', "fromPeriod": '),_.b(_.v(_.d("from.period",c,p,0)))}),c.pop())}),c.pop()),_.b("\n")),_.s(_.f("isRange",c,p,1),c,p,0,542,855,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("          "),_.s(_.f("selection",c,p,1),c,p,1,0,0,"")||_.s(_.f("t",c,p,1),c,p,0,573,586,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".select_range")}),c.pop()),_.b("\n"+i),_.b("          "),_.s(_.f("selection",c,p,1),c,p,0,631,832,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.s(_.f("t",c,p,1),c,p,0,637,826,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.selected_range, "fromHours": '),_.b(_.v(_.d("from.hours",c,p,0))),_.b(', "fromMinutes": '),_.b(_.v(_.d("from.minutes",c,p,0))),_.b(', "fromPeriod": '),_.b(_.v(_.d("from.period",c,p,0))),_.b(', "toHours": '),_.b(_.v(_.d("to.hours",c,p,0))),_.b(', "toMinutes": '),_.b(_.v(_.d("to.minutes",c,p,0))),_.b(', "toPeriod": '),_.b(_.v(_.d("to.period",c,p,0)))}),c.pop())}),c.pop()),_.b("\n")}),c.pop())),_.b("    </span>"),_.b("\n"+i),_.s(_.f("selectable",c,p,1),c,p,0,918,1058,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('    <span class="arrow">'),_.b("\n"+i),_.b('      <span class="icon-arrow-down-large"></span>'),_.b("\n"+i),_.b('      <span class="icon-arrow-up-large"></span>'),_.b("\n"+i),_.b("    </span>"),_.b("\n")}),c.pop()),_.b("  </div>"),_.b("\n"+i),_.b('  <div class="content"></div>'),_.b("\n"+i),_.b("</div>"),_.b("\n"),_.fl()},'<div class="wrapper">\n  <div class="dropdown{{#selectable}} selectable{{/selectable}}">\n    <span class="icon-now icon"></span>\n    <span class="selection{{#loading}} loading{{/loading}}">\n      {{#loading}}{{#t}}.loading{{/t}}{{/loading}}\n      {{^loading}}\n        {{^isRange}}\n          {{^selection}}{{#t}}.select_time{{/t}}{{/selection}}\n          {{#selection}}{{#t}}.selected_time, "fromHours": {{from.hours}}, "fromMinutes": {{from.minutes}}, "fromPeriod": {{from.period}}{{/t}}{{/selection}}\n        {{/isRange}}\n        {{#isRange}}\n          {{^selection}}{{#t}}.select_range{{/t}}{{/selection}}\n          {{#selection}}{{#t}}.selected_range, "fromHours": {{from.hours}}, "fromMinutes": {{from.minutes}}, "fromPeriod": {{from.period}}, "toHours": {{to.hours}}, "toMinutes": {{to.minutes}}, "toPeriod": {{to.period}}{{/t}}{{/selection}}\n        {{/isRange}}\n      {{/loading}}\n    </span>\n    {{#selectable}}\n    <span class="arrow">\n      <span class="icon-arrow-down-large"></span>\n      <span class="icon-arrow-up-large"></span>\n    </span>\n    {{/selectable}}\n  </div>\n  <div class="content"></div>\n</div>\n',H,{}),booking_frontend_templates_times:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b("<ul yield></ul>"),_.b("\n"),_.fl()},"<ul yield></ul>\n",H,{}),booking_frontend_templates_partysize:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b("<div"),_.s(_.f("selected",c,p,1),c,p,0,17,34,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(' class="selected"')}),c.pop()),_.b(">"),_.b("\n"+i),_.b("  "),_.s(_.f("t",c,p,1),c,p,0,57,91,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.partySize, "count": '),_.b(_.v(_.f("partySize",c,p,0)))}),c.pop()),_.b("\n"+i),_.b("</div>"),_.b("\n"),_.fl()},'<div{{#selected}} class="selected"{{/selected}}>\n  {{#t}}.partySize, "count": {{partySize}}{{/t}}\n</div>\n',H,{}),booking_frontend_templates_partysizepicker:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<div class="wrapper">'),_.b("\n"+i),_.b('  <div class="dropdown'),_.s(_.f("selectable",c,p,1),c,p,0,59,70,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(" selectable")}),c.pop()),_.b('">'),_.b("\n"+i),_.b('    <span class="icon-user icon"></span>'),_.b("\n"+i),_.b('    <span class="selection">'),_.b("\n"+i),_.b("      "),_.s(_.f("selectedpartySize",c,p,1),c,p,1,0,0,"")||_.s(_.f("t",c,p,1),c,p,0,192,199,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".select")}),c.pop()),_.b("\n"+i),_.s(_.f("selectedpartySize",c,p,1),c,p,0,256,318,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b("        "),_.s(_.f("t",c,p,1),c,p,0,271,305,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('.partySize, "count": '),_.b(_.v(_.f("partySize",c,p,0)))}),c.pop()),_.b("\n")}),c.pop()),_.b("    </span>"),_.b("\n"+i),_.s(_.f("selectable",c,p,1),c,p,0,372,512,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b('    <span class="arrow">'),_.b("\n"+i),_.b('      <span class="icon-arrow-down-large"></span>'),_.b("\n"+i),_.b('      <span class="icon-arrow-up-large"></span>'),_.b("\n"+i),_.b("    </span>"),_.b("\n")}),c.pop()),_.b("  </div>"),_.b("\n"+i),_.b('  <div class="content"></div>'),_.b("\n"+i),_.b("</div>"),_.b("\n"),_.fl()},'<div class="wrapper">\n  <div class="dropdown{{#selectable}} selectable{{/selectable}}">\n    <span class="icon-user icon"></span>\n    <span class="selection">\n      {{^selectedpartySize}}{{#t}}.select{{/t}}{{/selectedpartySize}}\n      {{#selectedpartySize}}\n        {{#t}}.partySize, "count": {{partySize}}{{/t}}\n      {{/selectedpartySize}}\n    </span>\n    {{#selectable}}\n    <span class="arrow">\n      <span class="icon-arrow-down-large"></span>\n      <span class="icon-arrow-up-large"></span>\n    </span>\n    {{/selectable}}\n  </div>\n  <div class="content"></div>\n</div>\n',H,{}),booking_frontend_templates_partysizes:new T(function(c,p,i){var _=this;
return _.b(i=i||""),_.b("<ul yield></ul>"),_.b("\n"),_.fl()},"<ul yield></ul>\n",H,{}),booking_frontend_templates_phone:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<div class="wrapper">'),_.b("\n"+i),_.b('  <span class="icon-mobile icon"></span>'),_.b("\n"+i),_.b('  <span class="phone-container">'),_.b("\n"+i),_.b('    <input type="tel" name="phone" placeholder="'),_.s(_.f("t",c,p,1),c,p,0,150,158,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".caption")}),c.pop()),_.b('" autocomplete="off" value="'),_.b(_.v(_.f("customerPhone",c,p,0))),_.b('" data-bhw="'),_.b(_.v(_.f("bhw",c,p,0))),_.b('" maxlength="'),_.b(_.v(_.f("maxLength",c,p,0))),_.b('">'),_.b("\n"+i),_.b("  </span>"),_.b("\n"+i),_.b('  <span class="icon-close icon clear"></span>'),_.b("\n"+i),_.b("</div>"),_.b("\n"),_.fl()},'<div class="wrapper">\n  <span class="icon-mobile icon"></span>\n  <span class="phone-container">\n    <input type="tel" name="phone" placeholder="{{#t}}.caption{{/t}}" autocomplete="off" value="{{customerPhone}}" data-bhw="{{bhw}}" maxlength="{{maxLength}}">\n  </span>\n  <span class="icon-close icon clear"></span>\n</div>\n',H,{}),booking_frontend_templates_question:new T(function(c,p,i){var _=this;return _.b(i=i||""),_.b('<div class="wrapper row">'),_.b("\n"+i),_.b('  <span class="icon-pencil icon"></span>'),_.b("\n"+i),_.b('  <span class="text-content">'),_.b("\n"+i),_.b('    <span class="label">'),_.b(_.v(_.f("question",c,p,0))),_.b("</span>"),_.b("\n"+i),_.b('    <textarea name="question" placeholder="'),_.s(_.f("t",c,p,1),c,p,0,190,198,"{{ }}")&&(_.rs(c,p,function(c,p,_){_.b(".caption")}),c.pop()),_.b('" autocomplete="off" rows="1" data-bhw="'),_.b(_.v(_.f("bhw",c,p,0))),_.b('" maxlength="'),_.b(_.v(_.f("maxLength",c,p,0))),_.b('">'),_.b(_.v(_.f("answer",c,p,0))),_.b("</textarea>"),_.b("\n"+i),_.b("  </span>"),_.b("\n"+i),_.b('  <span class="icon-close icon clear"></span>'),_.b("\n"+i),_.b("</div>"),_.b("\n"),_.fl()},'<div class="wrapper row">\n  <span class="icon-pencil icon"></span>\n  <span class="text-content">\n    <span class="label">{{question}}</span>\n    <textarea name="question" placeholder="{{#t}}.caption{{/t}}" autocomplete="off" rows="1" data-bhw="{{bhw}}" maxlength="{{maxLength}}">{{answer}}</textarea>\n  </span>\n  <span class="icon-close icon clear"></span>\n</div>\n',H,{})}}(this,Hogan,Hogan.Template),// license : MIT
function(){function onload(moment){function parseMinutes(input){input+="";var output=input.split(":"),sign=~input.indexOf("-")?-1:1,hour=Math.abs(+output[0]),minute=parseInt(output[1],10)||0,second=parseInt(output[2],10)||0;return sign*(60*hour+minute+second/60)}function Rule(name,startYear,endYear,month,day,dayRule,time,timeRule,offset,letters){this.name=name,this.startYear=+startYear,this.endYear=+endYear,this.month=+month,this.day=+day,this.dayRule=+dayRule,this.time=parseMinutes(time),this.timeRule=+timeRule,this.offset=parseMinutes(offset),this.letters=letters||"",this.date=memoize(this.date),this.weekdayAfter=memoize(this.weekdayAfter),this.lastWeekday=memoize(this.lastWeekday)}function RuleYear(year,rule){this.rule=rule,this.start=rule.start(year)}function sortRuleYears(a,b){return a.isLast?-1:b.isLast?1:b.start-a.start}function RuleSet(name){this.name=name,this.rules=[],this.lastYearRule=memoize(this.lastYearRule)}function Zone(name,offset,ruleSet,letters,until,untilOffset){var i,untilArray="string"==typeof until?until.split("_"):[9999];for(this.name=name,this.offset=parseMinutes(offset),this.ruleSet=ruleSet,this.letters=letters,this.lastRule=memoize(this.lastRule),i=0;i<untilArray.length;i++)untilArray[i]=+untilArray[i];this.until=moment.utc(untilArray).subtract("m",parseMinutes(untilOffset))}function sortZones(a,b){return a.until-b.until}function ZoneSet(name){this.name=normalizeName(name),this.displayName=name,this.zones=[],this.zoneAndRule=memoize(this.zoneAndRule,function(mom){return+mom})}function memoize(fn,keyFn){var cache={};return function(first){var key=keyFn?keyFn.apply(this,arguments):first;return key in cache?cache[key]:cache[key]=fn.apply(this,arguments)}}function addRules(rules){var i,j,rule;for(i in rules)for(rule=rules[i],j=0;j<rule.length;j++)addRule(i+"	"+rule[j])}function addRule(ruleString){if(rules[ruleString])return rules[ruleString];var p=ruleString.split(/\s/),name=normalizeName(p[0]),rule=new Rule(name,p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],p[9],p[10]);return rules[ruleString]=rule,getRuleSet(name).add(rule),rule}function normalizeName(name){return(name||"").toLowerCase().replace(/\//g,"_")}function addZones(zones){var i,j,zone;for(i in zones)for(zone=zones[i],j=0;j<zone.length;j++)addZone(i+"	"+zone[j])}function addLinks(linksToAdd){var i;for(i in linksToAdd)links[normalizeName(i)]=normalizeName(linksToAdd[i])}function addZone(zoneString){if(zones[zoneString])return zones[zoneString];var p=zoneString.split(/\s/),name=normalizeName(p[0]),zone=new Zone(name,p[1],getRuleSet(p[2]),p[3],p[4],p[5]);return zones[zoneString]=zone,getZoneSet(p[0]).add(zone),zone}function getRuleSet(name){return name=normalizeName(name),ruleSets[name]||(ruleSets[name]=new RuleSet(name)),ruleSets[name]}function getZoneSet(name){var machineName=normalizeName(name);return links[machineName]&&(machineName=links[machineName]),zoneSets[machineName]||(zoneSets[machineName]=new ZoneSet(name)),zoneSets[machineName]}function add(data){data&&(data.zones&&addZones(data.zones),data.rules&&addRules(data.rules),data.links&&addLinks(data.links))}function getZoneSets(){var zoneName,sets=[];for(zoneName in zoneSets)sets.push(zoneSets[zoneName]);return sets}var defaultRule,oldZoneName=moment.fn.zoneName,oldZoneAbbr=moment.fn.zoneAbbr,rules={},ruleSets={},zones={},zoneSets={},links={},TIME_RULE_UTC=1,TIME_RULE_STANDARD=2,DAY_RULE_DAY_OF_MONTH=7,DAY_RULE_LAST_WEEKDAY=8;return void 0!==moment.tz?moment:(Rule.prototype={contains:function(year){return year>=this.startYear&&year<=this.endYear},start:function(year){return year=Math.min(Math.max(year,this.startYear),this.endYear),moment.utc([year,this.month,this.date(year),0,this.time])},date:function(year){return this.dayRule===DAY_RULE_DAY_OF_MONTH?this.day:this.dayRule===DAY_RULE_LAST_WEEKDAY?this.lastWeekday(year):this.weekdayAfter(year)},weekdayAfter:function(year){for(var day=this.day,firstDayOfWeek=moment([year,this.month,1]).day(),output=this.dayRule+1-firstDayOfWeek;day>output;)output+=7;return output},lastWeekday:function(year){var day=this.day,dow=day%7,lastDowOfMonth=moment([year,this.month+1,1]).day(),daysInMonth=moment([year,this.month,1]).daysInMonth(),output=daysInMonth+(dow-(lastDowOfMonth-1))-7*~~(day/7);return dow>=lastDowOfMonth&&(output-=7),output}},RuleYear.prototype={equals:function(other){return other&&other.rule===this.rule?Math.abs(other.start-this.start)<864e5:!1}},RuleSet.prototype={add:function(rule){this.rules.push(rule)},ruleYears:function(mom,lastZone){var i,rule,lastZoneRule,year=mom.year(),rules=[];for(i=0;i<this.rules.length;i++)rule=this.rules[i],rule.contains(year)?rules.push(new RuleYear(year,rule)):rule.contains(year+1)&&rules.push(new RuleYear(year+1,rule));return rules.push(new RuleYear(year-1,this.lastYearRule(year-1))),lastZone&&(lastZoneRule=new RuleYear(year-1,lastZone.lastRule()),lastZoneRule.start=lastZone.until.clone().utc(),lastZoneRule.isLast=lastZone.ruleSet!==this,rules.push(lastZoneRule)),rules.sort(sortRuleYears),rules},rule:function(mom,offset,lastZone){var rule,lastZoneOffset,lastZoneOffsetAbs,lastRule,i,rules=this.ruleYears(mom,lastZone),lastOffset=0;for(lastZone&&(lastZoneOffset=lastZone.offset+lastZone.lastRule().offset,lastZoneOffsetAbs=9e4*Math.abs(lastZoneOffset)),i=rules.length-1;i>-1;i--)lastRule=rule,rule=rules[i],rule.equals(lastRule)||(lastZone&&!rule.isLast&&Math.abs(rule.start-lastZone.until)<=lastZoneOffsetAbs&&(lastOffset+=lastZoneOffset-offset),rule.rule.timeRule===TIME_RULE_STANDARD&&(lastOffset=offset),rule.rule.timeRule!==TIME_RULE_UTC&&rule.start.add("m",-lastOffset),lastOffset=rule.rule.offset+offset);for(i=0;i<rules.length;i++)if(rule=rules[i],mom>=rule.start&&!rule.isLast)return rule.rule;return defaultRule},lastYearRule:function(year){var i,rule,start,bestRule=defaultRule,largest=-1e30;for(i=0;i<this.rules.length;i++)rule=this.rules[i],year>=rule.startYear&&(start=rule.start(year),start>largest&&(largest=start,bestRule=rule));return bestRule}},Zone.prototype={rule:function(mom,lastZone){return this.ruleSet.rule(mom,this.offset,lastZone)},lastRule:function(){return this.rule(this.until)},format:function(rule){return this.letters.replace("%s",rule.letters)}},ZoneSet.prototype={zoneAndRule:function(mom){var i,zone,lastZone;for(mom=mom.clone().utc(),i=0;i<this.zones.length&&(zone=this.zones[i],!(mom<zone.until));i++)lastZone=zone;return[zone,zone.rule(mom,lastZone)]},add:function(zone){this.zones.push(zone),this.zones.sort(sortZones)},format:function(mom){var zoneAndRule=this.zoneAndRule(mom);return zoneAndRule[0].format(zoneAndRule[1])},offset:function(mom){var zoneAndRule=this.zoneAndRule(mom);return-(zoneAndRule[0].offset+zoneAndRule[1].offset)}},moment.updateOffset=function(mom,keepTime){var offset;mom._z&&(offset=mom._z.offset(mom),Math.abs(offset)<16&&(offset/=60),mom.zone(offset,keepTime))},moment.fn.tz=function(name){return name?(this._z=getZoneSet(name),this._z&&moment.updateOffset(this),this):this._z?this._z.displayName:void 0},moment.fn.zoneName=function(){return this._z?this._z.format(this):oldZoneName.call(this)},moment.fn.zoneAbbr=function(){return this._z?this._z.format(this):oldZoneAbbr.call(this)},moment.momentProperties._z=null,moment.tz=function(){var i,args=[],len=arguments.length-1;for(i=0;len>i;i++)args[i]=arguments[i];var m=moment.apply(null,args),preTzOffset=m.zone();return m.tz(arguments[len]),m.add("minutes",m.zone()-preTzOffset)},moment.tz.add=add,moment.tz.addRule=addRule,moment.tz.addZone=addZone,moment.tz.zones=getZoneSets,moment.tz.version=VERSION,moment.tz.zoneExists=function(name){return getZoneSet(name).zones.length>0},defaultRule=addRule("- 0 9999 0 0 0 0 0 0"),moment)}var VERSION="0.0.6";"function"==typeof define&&define.amd?define("moment-timezone",["moment"],onload):"undefined"!=typeof module?module.exports=onload(require("moment")):"undefined"!=typeof window&&window.moment&&onload(window.moment)}.apply(this),null!=window.Booking?window.Booking:window.Booking={},null!=window.Booking.rootUrl?window.Booking.rootUrl:window.Booking.rootUrl="/booking",null!=window.Booking.Collections?window.Booking.Collections:window.Booking.Collections={},null!=window.Booking.Models?window.Booking.Models:window.Booking.Models={},null!=window.Booking.Presenters?window.Booking.Presenters:window.Booking.Presenters={},null!=window.Booking.Views?window.Booking.Views:window.Booking.Views={},Booking.Collections.Base=function(super$){function Base(){Backbone.Collection.apply(this,arguments),this._meta={},this.on("request",this.loading),this.on("sync",this.loaded),this.on("error",this.loaded)}return extends$(Base,super$),Base.prototype.meta=function(prop,value){return void 0!==value&&(this._meta[prop]=value),this._meta[prop]},Base.prototype.loading=function(){return this.meta("loaded",!1)},Base.prototype.loaded=function(){return this.meta("loaded",!0)},Base.prototype.isLoading=function(){return this.meta("loaded")===!1},Base.prototype.isLoaded=function(){return this.meta("loaded")===!0},Base}(Backbone.Collection),Booking.Models.Base=function(super$){function Base(){Backbone.Model.apply(this,arguments),"function"==typeof this.error&&this.on("error",this.error,this)}return extends$(Base,super$),Base.prototype.sync=function(method,model,options){return null==options&&(options={}),Booking.csrf&&(options.beforeSend=function(xhr){return xhr.setRequestHeader("x-csrf-token",Booking.csrf)}),Backbone.Model.prototype.sync.call(this,method,model,options)},Base}(Backbone.Model),Booking.Models.Place=function(super$){function Place(){super$.apply(this,arguments)}return extends$(Place,super$),Place.prototype.getTimezone=function(){return this.get("location").time_zone},Place.prototype.getTitle=function(){return this.get("name")},Place}(Booking.Models.Base),Booking.Collections.Places=function(super$){function Places(){super$.apply(this,arguments)}return extends$(Places,super$),Places.prototype.model=Booking.Models.Place,Places}(Booking.Collections.Base),Booking.Models.Option=function(super$){function Option(){super$.apply(this,arguments)}return extends$(Option,super$),Option.prototype.getTitle=function(){return this.get("title")||this.get("deal").service_option.title},Option.prototype.getPrice=function(){return this.get("price").amount},Option.prototype.getFormattedPrice=function(){return this.get("price").formattedAmount},Option.prototype.getFormattedValue=function(){return this.get("value").formattedAmount},Option.prototype.isSoldOut=function(){return this.get("isSoldOut")},Option.prototype.getDiscount=function(){return this.get("discount")},Option.prototype.isFoodAndDrink=function(){return this.get("bookable")},Option}(Booking.Models.Base),Booking.Collections.Options=function(super$){function Options(){super$.apply(this,arguments)}return extends$(Options,super$),Options.prototype.model=Booking.Models.Option,Options.prototype.selectable=function(){return this.filter(function(option){return option.isSoldOut()===!1})},Options.prototype.firstSelectable=function(){return this.selectable()[0]},Options.prototype.cheapest=function(){return this.sortBy(function(option){return option.getPrice()})[0]},Options.prototype.isFoodAndDrink=function(){return this.some(function(option){return option.isFoodAndDrink()})},Options}(Booking.Collections.Base),Booking.Models.Time=function(super$){function Time(){var clndrTimeMoment,finalTimeMoment,initialTimeMoment;Booking.Models.Base.apply(this,arguments),initialTimeMoment=clndrTimeMoment=moment.unix(this.get("initial_time")),finalTimeMoment=moment.unix(this.get("final_time")),this.collection.meta("browserInMerchantTimezone")||(initialTimeMoment=initialTimeMoment.tz(this.collection.getTimezone()),finalTimeMoment=finalTimeMoment.tz(this.collection.getTimezone())),this.set({initialTimeMoment:initialTimeMoment,finalTimeMoment:finalTimeMoment,clndrTimeMoment:clndrTimeMoment})}return extends$(Time,super$),Time.prototype.start=function(){return this.get("initialTimeMoment")},Time.prototype.end=function(){return this.get("initialTimeMoment")},Time}(Booking.Models.Base),Booking.Collections.Availability=function(super$){function Availability(){super$.apply(this,arguments)}return extends$(Availability,super$),Availability.prototype.model=Booking.Models.Time,Availability.prototype.url=function(){return""+Booking.rootUrl+"/availability"},Availability.prototype.parse=function(param$){var cache$,max_party_size,min_party_size,segments,time_zone;return cache$=param$,segments=cache$.segments,time_zone=cache$.time_zone,min_party_size=cache$.min_party_size,max_party_size=cache$.max_party_size,this.meta("timezone",time_zone),this.meta("browserInMerchantTimezone",moment().zone()===moment().tz(time_zone).zone()),segments},Availability.prototype.getTimesByDate=function(day){var endOfDay,startOfDay;return startOfDay=day.startOf("day").unix(),endOfDay=day.endOf("day").unix(),this.filter(function(time){var cache$;return startOfDay<=(cache$=time.start().unix())&&endOfDay>=cache$})},Availability}(Booking.Collections.Base),Booking.Collections.Times=function(super$){function Times(){super$.apply(this,arguments)}return extends$(Times,super$),Times.prototype.model=Booking.Models.Time,Times}(Booking.Collections.Base),Booking.Models.PartySize=function(super$){function PartySize(){arguments[0]={partySize:parseInt(arguments[0],10)},Booking.Models.Base.apply(this,arguments)}return extends$(PartySize,super$),PartySize.prototype.getPartySize=function(){return this.get("partySize")},PartySize}(Booking.Models.Base),Booking.Collections.PartySizes=function(super$){function PartySizes(){super$.apply(this,arguments)}return extends$(PartySizes,super$),PartySizes.prototype.model=Booking.Models.PartySize,PartySizes}(Booking.Collections.Base),Booking.Models.Nested=function(super$){function Nested(attributes,options){null==options&&(options={}),Booking.Models.Base.apply(this,arguments),options.parent&&(this.parent=options.parent,this.bubbleEventsToParent())}return extends$(Nested,super$),Nested.prototype.bubblableEvents=["error"],Nested.prototype.bubbleEventsToParent=function(){return function(accum$){for(var event,i$=0,length$=this.bubblableEvents.length;length$>i$;++i$)event=this.bubblableEvents[i$],accum$.push(function(this$){return function(event){return this$.on(event,function(this$1){return function(){var args;return args=_.toArray(arguments),args.unshift(event),this$1.parent.trigger.apply(this$1.parent,args)}}(this$))}}(this)(event));return accum$}.call(this,[])},Nested}(Booking.Models.Base),Booking.Models.ReservationMetas=function(super$){function ReservationMetas(){super$.apply(this,arguments)}return extends$(ReservationMetas,super$),ReservationMetas.prototype.url=function(){return""+this.parent.url()+"/metas"},ReservationMetas.prototype.getPhone=function(){return this.get("phone")},ReservationMetas.prototype.getQuestions=function(){return this.get("questions")},ReservationMetas.prototype.getPartySize=function(){return this.get("partySize")},ReservationMetas}(Booking.Models.Nested),Booking.Models.ReservationRequest=function(super$){function ReservationRequest(){super$.apply(this,arguments)}return extends$(ReservationRequest,super$),ReservationRequest.prototype.getStatus=function(){return this.get("status")},ReservationRequest.prototype.getStartDatetime=function(){return this.get("start_datetime")},ReservationRequest.prototype.getEndDatetime=function(){return this.get("end_datetime")},ReservationRequest.prototype.getDuration=function(){return this.get("duration")},ReservationRequest}(Booking.Models.Nested),Booking.Collections.ReservationRequests=function(super$){function ReservationRequests(){super$.apply(this,arguments)}return extends$(ReservationRequests,super$),ReservationRequests.prototype.model=Booking.Models.ReservationRequest,ReservationRequests.prototype.current=function(){return this.last()},ReservationRequests}(Booking.Collections.Base),Booking.Models.Reservation=function(super$){function Reservation(attributes){Booking.Models.Base.apply(this,arguments),this.set(this.prepareSubModels(attributes)),this.on("error",this.handleError,this),this.on("request",this.loading,this),this.on("sync",this.loaded,this)}return extends$(Reservation,super$),Reservation.prototype.statuses={locked:"locked",requested:"requested",confirmed:"confirmed",expired:"expired",canceled:"user_declined"},Reservation.prototype.prepareSubModels=function(attributes){var cache$,id,metas,option,place,requests;if(attributes)return cache$=attributes,requests=cache$.requests,metas=cache$.metas,place=cache$.place,option=cache$.option,id=cache$.id,requests=new Booking.Collections.ReservationRequests(requests),metas=new Booking.Models.ReservationMetas(metas,{reservationId:id,parent:this}),place=new Booking.Models.Place(place),option=new Booking.Models.Option(option),{requests:requests,metas:metas,place:place,option:option}},Reservation.prototype.parse=function(response){return _.extend(response,this.prepareSubModels(response))},Reservation.prototype.handleError=function(model,response){var error,errors;return errors={0:"timeout",404:"not_found",409:"conflict",410:"gone",504:"timeout"},error=errors[response.status]||"server",this.setError(error)},Reservation.prototype.setError=function(error){return this.set({error:error})},Reservation.prototype.getError=function(){return this.get("error")},Reservation.prototype.clearError=function(){return this.unset("error")},Reservation.prototype.getRequests=function(){return this.get("requests")},Reservation.prototype.getCurrentRequest=function(){var cache$;return null!=(cache$=this.getRequests())?cache$.current():void 0},Reservation.prototype.getMetas=function(){return this.get("metas")},Reservation.prototype.getPlace=function(){return this.get("place")},Reservation.prototype.getOption=function(){return this.get("option")},Reservation.prototype.getUserId=function(){return this.get("userId")},Reservation.prototype.getStatus=function(){var cache$;return null!=(cache$=this.getCurrentRequest())?cache$.getStatus():void 0},Reservation.prototype.getStartDatetime=function(){var cache$;return null!=(cache$=this.getCurrentRequest())?cache$.getStartDatetime():void 0},Reservation.prototype.getStartDatetimeMoment=function(){var cache$;return null!=(cache$=moment.unix(this.getStartDatetime()))?cache$.tz(this.getTimezone()):void 0},Reservation.prototype.getEndDatetime=function(){var cache$;return null!=(cache$=this.getCurrentRequest())?cache$.getEndDatetime():void 0},Reservation.prototype.getEndDatetimeMoment=function(){var cache$;return null!=(cache$=moment.unix(this.getEndDatetime()))?cache$.tz(this.getTimezone()):void 0},Reservation.prototype.getDuration=function(){var cache$;return null!=(cache$=this.getCurrentRequest())?cache$.getDuration():void 0},Reservation.prototype.getCalendar=function(){return this.get("calendar")},Reservation.prototype.isAppointmentRequest=function(){var cache$;return null!=(cache$=this.getCalendar())?cache$.isARSE():void 0},Reservation.prototype.getPartySize=function(){var cache$;return null!=(cache$=this.getMetas())&&"function"==typeof cache$.getPartySize?cache$.getPartySize():void 0},Reservation.prototype.getQuestions=function(){var cache$;return null!=(cache$=this.getMetas())&&"function"==typeof cache$.getQuestions?cache$.getQuestions():void 0},Reservation.prototype.getPhone=function(){var cache$;return null!=(cache$=this.getMetas())&&"function"==typeof cache$.getPhone?cache$.getPhone():void 0},Reservation.prototype.getTimezone=function(){var cache$,cache$1;return(null!=(cache$=this.getCalendar())?cache$.getTimezone():void 0)||(null!=(cache$1=this.getPlace())?cache$1.getTimezone():void 0)},Reservation.prototype.isLocked=function(){return this.getStatus()===this.statuses.locked},Reservation.prototype.isRequested=function(){return this.getStatus()===this.statuses.requested},Reservation.prototype.isConfirmed=function(){return this.getStatus()===this.statuses.confirmed},Reservation.prototype.isExpired=function(){return this.getStatus()===this.statuses.expired},Reservation.prototype.isCanceled=function(){return this.getStatus()===this.statuses.canceled},Reservation.prototype.isBooked=function(){return this.isRequested()||this.isConfirmed()||this.isLocked()},Reservation.prototype.loaded=function(){return this.set("loaded",!0)},Reservation.prototype.loading=function(){return this.set("loaded",!1)},Reservation.prototype.isLoaded=function(){return this.get("loaded")===!0},Reservation.prototype.isLoading=function(){return this.get("loaded")===!1},Reservation.prototype.cancel=function(){var type,url;return this.getCurrentRequest().set({status:this.statuses.canceled}),type="post",url=""+this.url()+"/cancel",this.save({},{url:url,type:type})},Reservation}(Booking.Models.Base),Booking.Collections.Reservations=function(super$){function Reservations(){super$.apply(this,arguments)}return extends$(Reservations,super$),Reservations.prototype.model=Booking.Models.Reservation,Reservations.prototype.url=function(){return""+Booking.rootUrl+"/reservations"},Reservations}(Booking.Collections.Base),Booking.Models.Calendar=function(super$){function Calendar(){super$.apply(this,arguments)}return extends$(Calendar,super$),Calendar.prototype.isARSE=function(){return this.get("duration")&&this.get("tentative_window_duration")&&0!==this.get("duration")-this.get("tentative_window_duration")},Calendar.prototype.getTimezone=function(){return this.get("time_zone")},Calendar.prototype.getMinPartySize=function(){return this.get("min_party_size")},Calendar.prototype.getMaxPartySize=function(){return this.get("max_party_size")},Calendar.prototype.getPhoneNumber=function(){return this.get("phone_number")},Calendar.prototype.getQuestion=function(){return this.get("question")},Calendar}(Booking.Models.Base),Booking.Models.Booker=function(super$){function Booker(){Booking.Models.Base.apply(this,arguments),null!=this.get("timezoneData")&&moment.tz.add(this.get("timezoneData")),this.set({places:new Booking.Collections.Places,options:new Booking.Collections.Options,availability:new Booking.Collections.Availability,times:new Booking.Collections.Times,reservations:new Booking.Collections.Reservations,partySizes:new Booking.Collections.PartySizes,calendar:new Booking.Models.Calendar(this.getCalendar())}),this.getAvailability().meta("calendar",this.getCalendar()),this.getAvailability().getTimezone=function(this$){return function(){return this$.getTimezone()}}(this),this.getTimes().meta("calendar",this.getCalendar()),this.getTimes().getTimezone=function(this$){return function(){return this$.getTimezone()}}(this),this.getReservations().on("request",this.booking,this).on("sync",this.notBooking,this).on("error",this.notBooking,this),this.getPlaces().on("reset",function(this$){return function(){return this$.selectPlace()}}(this)),this.getOptions().on("reset",function(this$){return function(){return this$.resetOption()}}(this)),this.on("change:selectedOption",this.loadAvailability,this),this.resetPartySize()}return extends$(Booker,super$),Booker.prototype.loaded=!1,Booker.prototype.setError=function(error){return this.set({error:error})},Booker.prototype.clearError=function(){return this.unset("error")},Booker.prototype.getError=function(){return this.get("error")},Booker.prototype.getMerchant=function(){return this.get("merchant")},Booker.prototype.getOrderId=function(){return this.get("orderId")},Booker.prototype.getGrouponId=function(){return this.get("grouponId")},Booker.prototype.getUserId=function(){return this.get("userId")},Booker.prototype.getConsumerId=function(){return this.get("consumerId")},Booker.prototype.getPlaces=function(){return this.get("places")},Booker.prototype.getDeal=function(){return this.get("deal")},Booker.prototype.getOptions=function(){return this.get("options")},Booker.prototype.getTimes=function(){return this.get("times")},Booker.prototype.getAvailability=function(){return this.get("availability")},Booker.prototype.getReservations=function(){return this.get("reservations")},Booker.prototype.resetReservations=function(reservations){return null==reservations&&(reservations=[]),this.getReservations().reset(reservations),this},Booker.prototype.getReservation=function(){return this.getReservations().first()},Booker.prototype.createReservation=function(){return this.setReservation(new Booking.Models.Reservation),this.getReservation()},Booker.prototype.setReservation=function(reservation){return this.resetReservations([reservation]),this},Booker.prototype.unsetReservation=function(){return this.resetReservations(),this},Booker.prototype.getCalendar=function(){return this.get("calendar")},Booker.prototype.getTimezone=function(){var cache$,cache$1,cache$2;return(null!=(cache$=this.getCalendar())?cache$.getTimezone():void 0)||(null!=(cache$1=this.getAvailability())?cache$1.meta("timezone"):void 0)||(null!=(cache$2=this.getDeal())?cache$2.timezone:void 0)},Booker.prototype.minPartySize=function(){var cache$;return null!=(cache$=this.getCalendar())?cache$.getMinPartySize():void 0},Booker.prototype.maxPartySize=function(){var cache$;return null!=(cache$=this.getCalendar())?cache$.getMaxPartySize():void 0},Booker.prototype.selectedPlace=function(){return this.get("selectedPlace")},Booker.prototype.selectPlace=function(place){return null!=place||(place=this.selectedPlace()||this.getPlaces().first()),this.set({selectedPlace:place})},Booker.prototype.hasMultipleOptions=function(){return this.getOptions().length>1},Booker.prototype.preSelectedOption=function(){return this.getOptions().get(this.get("optionId"))},Booker.prototype.requirePartySize=function(){return this.minPartySize()&&this.maxPartySize()},Booker.prototype.requirePhone=function(){return!0},Booker.prototype.requireQuestion=function(){return null!=this.getQuestion()},Booker.prototype.reset=function(){return this.resetOption(),this.resetTime()},Booker.prototype.resetPlaces=function(places){return this.getPlaces().reset(places),this},Booker.prototype.resetOptions=function(options){return this.getOptions().reset(options),this},Booker.prototype.resetOption=function(){var defaultOption;return defaultOption=this.hasMultipleOptions()?null:this.getOptions().firstSelectable(),this.selectOption(this.preSelectedOption()||defaultOption)},Booker.prototype.resetPartySize=function(){return this.requirePartySize()?this.get("partySizes").reset(function(){var accum$;accum$=[];for(var i$=this.minPartySize();this.minPartySize()<=this.maxPartySize()?i$<=this.maxPartySize():i$>=this.maxPartySize();this.minPartySize()<=this.maxPartySize()?++i$:--i$)accum$.push(i$);return accum$}.apply(this,arguments)):void 0},Booker.prototype.resetDate=function(){return this.selectDate(null),this},Booker.prototype.resetTime=function(){return this.selectTime(null),this},Booker.prototype.selectOption=function(option){return this.set({selectedOption:option})},Booker.prototype.selectedOption=function(){return this.get("selectedOption")},Booker.prototype.selectDate=function(selection){var cache$,date,events,selectedDate;return events=[],selectedDate=null,null!=selection&&(cache$=selection,events=cache$.events,date=cache$.date,selectedDate={date:date}),this.resetTime(),this.getTimes().reset(events),this.set({selectedDate:selectedDate})},Booker.prototype.selectTime=function(time){return this.set({selectedTime:time})},Booker.prototype.selectedTime=function(){return this.get("selectedTime")},Booker.prototype.selectPartySize=function(partySize){return partySize instanceof Booking.Models.PartySize||(partySize=new Booking.Models.PartySize(partySize)),this.set({selectedPartySize:partySize})},Booker.prototype.selectedPartySize=function(){return this.get("selectedPartySize").getPartySize()},Booker.prototype.setPhoneNumber=function(phoneNumber){return this.set({phoneNumber:phoneNumber})},Booker.prototype.getPhoneNumber=function(){return this.get("phoneNumber")},Booker.prototype.getQuestion=function(){return this.getCalendar().getQuestion()},Booker.prototype.setQuestionsAnswer=function(questionsAnswer){return this.set({questionsAnswer:questionsAnswer})},Booker.prototype.getQuestionsAnswer=function(){return this.get("questionsAnswer")},Booker.prototype.isDealNotYetOpen=function(){var cache$;return"not_yet"===(null!=(cache$=this.get("deal"))?cache$.status:void 0)||!1},Booker.prototype.loadAvailability=function(){return this.selectedOption()?(this.getTimes().reset(),this.getAvailability().fetch({reset:!0,data:{initial_time:moment().unix(),final_time:moment().endOf("month").add("months",3).unix(),deal_id:this.getDeal().id,deal_option_id:this.selectedOption().id}}),this):void 0},Booker.prototype.preset=function(param$){var cache$,datetime,option,optionId,partySize,phoneNumber,questionsAnswer;return cache$=param$,datetime=cache$.datetime,optionId=cache$.optionId,partySize=cache$.partySize,questionsAnswer=cache$.questionsAnswer,phoneNumber=cache$.phoneNumber,datetime&&(this.selectDate({events:[],date:!0}),this.selectTime(!0),this.getAvailability().once("sync",function(this$){return function(){var date,events;return date=moment.unix(datetime).tz(this$.getTimezone()),events=this$.getAvailability().getTimesByDate(date),events.length?(this$.selectDate({date:date,events:events}),this$.selectTime(_.find(events,function(event){return event.get("initialTimeMoment").unix()===parseInt(datetime,10)}))):(this$.resetDate(),this$.resetTime())}}(this))),optionId&&(option=this.getOptions().findWhere({id:parseInt(optionId,10)}),option&&this.selectOption(option)),partySize&&this.selectPartySize(partySize),phoneNumber&&this.setPhoneNumber(phoneNumber),questionsAnswer?this.setQuestionsAnswer(questionsAnswer):void 0},Booker.prototype.booking=function(){return this.set({isBooking:!0})},Booker.prototype.notBooking=function(){return this.set({isBooking:!1})},Booker.prototype.isBooking=function(){return this.get("isBooking")===!0},Booker.prototype.isReadyToBook=function(){return null!=this.selectedTime()&&null!=this.selectedOption()},Booker.prototype.book=function(){var consumerId,grouponId,merchant,metas,orderId,reservation,userId;return this.isReadyToBook()?(this.booking(),reservation=this.getReservation()||this.createReservation(),reservation.set({segmentId:this.selectedTime().id,dealId:this.getDeal().id,dealOptionId:this.selectedOption().id}),merchant=this.getMerchant(),orderId=this.getOrderId(),grouponId=this.getGrouponId(),userId=this.getUserId(),consumerId=this.getConsumerId(),reservation.set({merchant:merchant,orderId:orderId,grouponId:grouponId,userId:userId,consumerId:consumerId}),(this.requirePartySize()||this.requirePhone()||this.requireQuestion())&&(metas={},this.requirePartySize()&&(metas.partySize=this.selectedPartySize()),this.requirePhone()&&(metas.phone=this.getPhoneNumber()),this.requireQuestion()&&(metas.questions={},metas.questions[this.getQuestion()]=this.getQuestionsAnswer()),reservation.set({metas:metas})),reservation.unset("id"),reservation.save()):void 0},Booker}(Booking.Models.Base),Booking.Presenters.Base=function(){function Base(param$,param$1){this.options=param$,this.templateName=param$1,null!=this.module?this.module:this.module=null!=this.options?this.options.module:void 0,this.model=null!=this.options?this.options.model:void 0,this.collection=null!=this.options?this.options.collection:void 0,this.localesBasePath="modules."+this.module+"."+this.templateName}return Base.prototype.module="booking",Base.prototype.toHash=function(){},Base.prototype.getI18n=function(scope){return null==scope&&(scope=this.localesBasePath),null!=scope?I18n.scoped(scope):I18n},Base.prototype.toHashWithHelpers=function(){return I18n.mixin(this.toHash(),this.getI18n())},Base.prototype.generateLink=function(i18nKey,href){var label;return label=this.getI18n().t(i18nKey),"<a href='"+href+"'>"+label+"</a>"},Base}(),Booking.Presenters.Booker=function(super$){function Booker(){var cache$;Booking.Presenters.Base.apply(this,arguments),this.isARSE=null!=(cache$=this.model.getCalendar())?cache$.isARSE():void 0,this.isARSE&&(this.localesBasePath=""+this.localesBasePath+"_arse")}return extends$(Booker,super$),Booker.prototype.userPageHref=function(page){return"/users/"+this.model.getUserId()+"/"+page
},Booker.prototype.toHash=function(){var cache$,error,hash;return error=this.model.getError(),hash={error:error,errorLoading:"loading"===error||"timeout"===error,errorBooking:"server"===error||"not_found"===error,errorSegmentNotAvailable:"conflict"===error,errorSegmentExpired:"gone"===error,myReservationsLink:this.generateLink(".my_reservations",this.userPageHref("reservations")),myGrouponsLink:this.generateLink(".my_groupons",this.userPageHref("groupons")),isOpen:this.options.isOpen,isLocked:this.options.isLocked,phoneRequired:this.model.requirePhone(),questionRequired:this.model.requireQuestion(),isARSE:this.isARSE,showNewOverlay:this.options.showNewOverlay,hasReservation:null!=(null!=(cache$=this.model.getReservation())?cache$.id:void 0)},this.isARSE&&null!=this.model.getCalendar()&&(hash.merchantPhone=this.model.getCalendar().getPhoneNumber()),hash},Booker}(Booking.Presenters.Base),Booking.Views.Base=function(super$){function Base(param$){null==param$&&(param$={}),this.options=param$,_.extend(this,_.pick(this.options,["templateName","module","presenter"])),Backbone.View.apply(this,arguments)}return extends$(Base,super$),Base.prototype.module="booking",Base.prototype.template=function(){return window.BookingTemplates[""+this.module+"_frontend_templates_"+this.templateName]},Base.prototype.getPresenter=function(){return this.presenter?(null!=this._presenter?this._presenter:this._presenter=new this.presenter(this.options,this.templateName),this._presenter):void 0},Base.prototype.templateAttributes=function(){return this.presenter?this.getPresenter().toHashWithHelpers():this.options},Base.prototype.toHtml=function(){return this.template()?this.template().render(this.templateAttributes()):""},Base.prototype.render=function(){return this.$el.html(this.toHtml()),this},Base.prototype.bhw=function(widget){return null!=this.$el?this.$el.attr("data-bhw",widget):void 0},Base.prototype.translate=function(){var i18n;return i18n=this.getPresenter().getI18n(),i18n.translate.apply(i18n,arguments)},Base}(Backbone.View),Booking.Presenters.Info=function(super$){function Info(){super$.apply(this,arguments)}return extends$(Info,super$),Info.prototype.toHash=function(){var option,selectedOption;return selectedOption=this.model.selectedOption(),option=selectedOption||this.model.getOptions().cheapest(),{optionSelected:null!=selectedOption,price:option.getFormattedPrice()}},Info}(Booking.Presenters.Base),Booking.Views.Info=function(super$){function Info(){super$.apply(this,arguments)}return extends$(Info,super$),Info.prototype.presenter=Booking.Presenters.Info,Info.prototype.templateName="info",Info}(Booking.Views.Base),Booking.Views.Pickers=function(super$){function Pickers(){super$.apply(this,arguments)}return extends$(Pickers,super$),Pickers.prototype.add=function(param$){var cache$,collection,model,picker,selected,selection,view;return cache$=param$,view=cache$.view,model=cache$.model,collection=cache$.collection,selection=cache$.selection,selected=cache$.selected,null!=this.pickers?this.pickers:this.pickers=[],picker=new view({model:model,collection:model.get(collection),selected:selection,previous:this.pickers[this.pickers.length-1]}),picker.on("select",function(this$){return function(selection){var nextPicker;return selected(selection),nextPicker=this$.nextUnselectedPicker(),nextPicker?(this$.collapse(!0),this$.expand(nextPicker)):(this$.trigger("collapse"),picker.once("collapsed",function(this$1){return function(){return this$1.trigger("collapsed")}}(this$)),this$.collapse(!1))}}(this)),picker.on("expand",function(this$){return function(picker){return this$.picker&&this$.collapse(!0),this$.setActivePicker(picker)}}(this)),picker.on("collapse",this.unsetActivePicker,this),this.pickers.push(picker),picker},Pickers.prototype.expanded=function(){for(var picker,i$=0,length$=this.pickers.length;length$>i$;++i$)if(picker=this.pickers[i$],picker.isVisible)return!0;return!1},Pickers.prototype.render=function(){var picker;Booking.Views.Base.prototype.render.apply(this,arguments);for(var i$=0,length$=this.pickers.length;length$>i$;++i$)picker=this.pickers[i$],this.$el.append(picker.render().el);return setTimeout(function(this$){return function(){return this$.postRender()}}(this),1e3),this},Pickers.prototype.postRender=function(){var picker;return picker=this.firstNotSelected(),picker?this.expand(picker):void 0},Pickers.prototype.expand=function(picker){return picker.show(),picker.once("expanded",function(this$){return function(){return this$.trigger("expanded")}}(this))},Pickers.prototype.nextUnselectedPicker=function(){return _.find(this.pickers,function(picker){return!picker.selected()})},Pickers.prototype.collapse=function(){return this.picker.hide(!0)},Pickers.prototype.setActivePicker=function(picker){return picker&&(this.picker=picker),picker},Pickers.prototype.unsetActivePicker=function(){return delete this.picker},Pickers.prototype.firstNotSelected=function(){return _.find(this.pickers,function(picker){return!picker.selected()})},Pickers}(Booking.Views.Base),Booking.Presenters.Picker=function(super$){function Picker(){super$.apply(this,arguments)}return extends$(Picker,super$),Picker.prototype.selected=function(){return this.model.get(this.options.selected)},Picker.prototype.isSelectable=function(){return this.collection.length>1},Picker.prototype.toHash=function(){return{icon:this.options.icon,expanded:this.options.expanded,selectable:this.isSelectable()||!this.selected()}},Picker}(Booking.Presenters.Base),Booking.Presenters.OptionPicker=function(super$){function OptionPicker(){super$.apply(this,arguments)}return extends$(OptionPicker,super$),OptionPicker.prototype.toHash=function(){var hash;return hash=Booking.Presenters.Picker.prototype.toHash.apply(this,arguments),null!=this.selected()&&(hash.selectedOption={title:this.selected().getTitle()}),hash},OptionPicker}(Booking.Presenters.Picker),Booking.Views.Picker=function(super$){function Picker(){Booking.Views.Base.apply(this,arguments),this.collection.on("reset",this.clearSelection,this),this.collection.on("request",this.clearSelection,this),this.model.on("change:"+this.options.selected,function(this$){return function(model,selection){return this$.content().options.selected=selection,this$.render()}}(this))}return extends$(Picker,super$),Picker.prototype.templateName="picker",Picker.prototype.expandedClassName="expanded",Picker.prototype.selectEvent="select",Picker.prototype.renderedEvent="rendered",Picker.prototype.events={"click .dropdown":"toggle"},Picker.prototype.transitionDuration=300,Picker.prototype.className=function(){var className;return className="picker "+this.styleClassName},Picker.prototype.render=function(){return this.content().$el.detach(),Booking.Views.Base.prototype.render.apply(this,arguments),this.appendContent(),this.trigger(this.renderedEvent),!this.isSelectable()&&this.collection.first()&&this.setSelection(this.collection.first()),this},Picker.prototype.content=function(){return this._content||(this._content=new this.contentView({collection:this.collection,selected:this.selected()}),this._content.on("select",this.select,this),this._content.render()),this._content},Picker.prototype.select=function(selection){return this.setSelection(selection),this.render(),this.trigger(this.selectEvent,selection)},Picker.prototype.selected=function(){return this.model.get(this.options.selected)},Picker.prototype.isSelectable=function(){return this.collection.length>1},Picker.prototype.setSelection=function(selection){return this.model.set(this.options.selected,selection)},Picker.prototype.clearSelection=function(){return this.setSelection(null),this.render()},Picker.prototype.container=function(){return this.$el.find(".content")},Picker.prototype.appendContent=function(){return this.content().$el.appendTo(this.container())},Picker.prototype.isPreviousSelected=function(){return this.options.previous?this.options.previous.selected():!0},Picker.prototype.toggle=function(){return this.collection.length&&this.isSelectable()?this.isVisible()?this.hide():this.show():void 0},Picker.prototype.isVisible=function(){return this.$el.hasClass(this.expandedClassName)},Picker.prototype.show=function(){var transitionEndHandler;return this.isPreviousSelected()?(this.redraw(),this.trigger("expand",this),transitionEndHandler=function(this$){return function(){return this$.trigger("expanded",this$)}}(this),setTimeout(transitionEndHandler,this.transitionDuration),this.$el.addClass(this.expandedClassName)):void 0},Picker.prototype.hide=function(force){var transitionEndHandler;return this.isPreviousSelected()&&this.selected()||force===!0?(this.redraw(),this.trigger("collapse",this),transitionEndHandler=function(this$){return function(){return this$.trigger("collapsed",this$)}}(this),setTimeout(transitionEndHandler,this.transitionDuration),this.$el.removeClass(this.expandedClassName)):void 0},Picker.prototype.redraw=function(){return this.$el.get(0).offsetHeight},Picker}(Booking.Views.Base),Booking.Views.Collection=function(super$){function Collection(){Booking.Views.Base.apply(this,arguments),null!=this.collection&&this.collection.on("add",function(this$){return function(model){return this$.appendChildView(model)}}(this)),null!=this.collection&&this.collection.on("remove",function(this$){return function(model){return this$.removeChildView(model)}}(this)),null!=this.collection&&this.collection.on("reset",this.render,this),null!=this.collection&&this.collection.on("sort",this.render,this)}return extends$(Collection,super$),Collection.prototype.containerSelector="[yield]",Collection.prototype.container=function(){var container;return container=this.$el.find(this.containerSelector),container.length?container:this.$el},Collection.prototype.render=function(){var i,limit,models;if(Booking.Views.Base.prototype.render.apply(this,arguments),this.collection)for(models=this.collection.models,limit=this.options.limit&&models.length>this.options.limit?this.options.limit:models.length,i=0;limit>i;)this.appendChildView(models[i]),i++;return this},Collection.prototype.appendChildView=function(model){return this.renderChildView("append",model)},Collection.prototype.prependChildView=function(model){return this.renderChildView("prepend",model)},Collection.prototype.renderChildView=function(insert,model){var childView,options;return options={model:model,id:null!=model?model.id:void 0},childView=new this.childView(_.extend(options,_.omit(this.options,"el"))),childView.on("all",this.bubbleUpEvent,this),this.container()[insert](childView.render().el),this},Collection.prototype.removeChildView=function(model){return this.container().find("#"+model.id).remove()},Collection.prototype.bubbleUpEvent=function(){return this.trigger.apply(this,arguments)},Collection}(Booking.Views.Base),Booking.Presenters.Option=function(super$){function Option(){super$.apply(this,arguments)}return extends$(Option,super$),Option.prototype.toHash=function(){var optionId,selectedOptionId;return optionId=this.model.id,selectedOptionId=null!=this.options.selected?this.options.selected.id:void 0,{optionId:optionId,title:this.model.getTitle(),selected:selectedOptionId===optionId,price:this.model.getFormattedPrice(),value:this.model.getFormattedValue(),isSoldOut:this.model.isSoldOut(),discount:this.model.getDiscount()}},Option.prototype.bhc=function(){return"dealoption:"+this.model.getTitle()},Option}(Booking.Presenters.Base),Booking.Views.Option=function(super$){function Option(){super$.apply(this,arguments)}return extends$(Option,super$),Option.prototype.presenter=Booking.Presenters.Option,Option.prototype.templateName="option",Option.prototype.tagName="li",Option.prototype.events={click:"select"},Option.prototype.attributes=function(){var cache$;return{"data-bhc":null!=(cache$=this.getPresenter())?cache$.bhc():void 0}},Option.prototype.select=function(){return this.model.isSoldOut()?void 0:this.trigger("select",this.model)},Option}(Booking.Views.Base),Booking.Views.Options=function(super$){function Options(){Booking.Views.Collection.apply(this,arguments),this.on("select",this.select,this)}return extends$(Options,super$),Options.prototype.tagName="ul",Options.prototype.childView=Booking.Views.Option,Options.prototype.select=function(option){return this.options.selected=option,setTimeout(function(this$){return function(){return this$.render()}}(this),0)},Options}(Booking.Views.Collection),Booking.Views.OptionPicker=function(super$){function OptionPicker(){super$.apply(this,arguments)}return extends$(OptionPicker,super$),OptionPicker.prototype.presenter=Booking.Presenters.OptionPicker,OptionPicker.prototype.contentView=Booking.Views.Options,OptionPicker.prototype.templateName="optionpicker",OptionPicker.prototype.attributes=function(){return{"data-bhw":""+Booking.bhw+"DealOptions"}},OptionPicker.prototype.styleClassName="options",OptionPicker}(Booking.Views.Picker),Booking.Presenters.DatePicker=function(super$){function DatePicker(){super$.apply(this,arguments)}return extends$(DatePicker,super$),DatePicker.prototype.toHash=function(){var date,hash,loading,selected;return selected=this.selected(),date=null!=selected?selected.date:void 0,loading=date===!0,hash=Booking.Presenters.Picker.prototype.toHash.apply(this,arguments),hash.loading=loading,!loading&&date&&(hash.selectedDate={month:date.format("MMMM"),date:date.format("D"),year:date.format("YYYY")}),hash},DatePicker}(Booking.Presenters.Picker),function($,window,document,undefined){function Clndr(element,options){if(this.element=element,this.options=$.extend(!0,{},defaults,options),this.options.events.length&&(this.options.events=this.options.multiDayEvents?this.addMultiDayMomentObjectsToEvents(this.options.events):this.addMomentObjectToEvents(this.options.events)),this.month=this.options.startWithMonth?moment(this.options.startWithMonth).startOf("month"):moment().startOf("month"),this.options.constraints){if(this.options.constraints.startDate){var startMoment=moment(this.options.constraints.startDate);this.month.isBefore(startMoment,"month")&&(this.month.set("month",startMoment.month()),this.month.set("year",startMoment.year()))}if(this.options.constraints.endDate){var endMoment=moment(this.options.constraints.endDate);this.month.isAfter(endMoment,"month")&&this.month.set("month",endMoment.month()).set("year",endMoment.year())}}this._defaults=defaults,this._name=pluginName,this.init()}var clndrTemplate="<div class='clndr-controls'><div class='clndr-control-button'><span class='clndr-previous-button'>previous</span></div><div class='month'><%= month %> <%= year %></div><div class='clndr-control-button rightalign'><span class='clndr-next-button'>next</span></div></div><table class='clndr-table' border='0' cellspacing='0' cellpadding='0'><thead><tr class='header-days'><% for(var i = 0; i < daysOfTheWeek.length; i++) { %><td class='header-day'><%= daysOfTheWeek[i] %></td><% } %></tr></thead><tbody><% for(var i = 0; i < numberOfRows; i++){ %><tr><% for(var j = 0; j < 7; j++){ %><% var d = j + i * 7; %><td class='<%= days[d].classes %>'><div class='day-contents'><%= days[d].day %></div></td><% } %></tr><% } %></tbody></table>",pluginName="clndr",defaults={template:clndrTemplate,weekOffset:0,startWithMonth:null,clickEvents:{click:null,nextMonth:null,previousMonth:null,nextYear:null,previousYear:null,today:null,onMonthChange:null,onYearChange:null},targets:{nextButton:"clndr-next-button",previousButton:"clndr-previous-button",nextYearButton:"clndr-next-year-button",previousYearButton:"clndr-previous-year-button",todayButton:"clndr-today-button",day:"day",empty:"empty"},events:[],extras:null,dateParameter:"date",multiDayEvents:null,doneRendering:null,render:null,daysOfTheWeek:null,showAdjacentMonths:!0,adjacentDaysChangeMonth:!1,ready:null,constraints:null,forceSixRows:null};Clndr.prototype.init=function(){if(this.daysOfTheWeek=this.options.daysOfTheWeek||[],!this.options.daysOfTheWeek){this.daysOfTheWeek=[];for(var i=0;7>i;i++)this.daysOfTheWeek.push(moment().weekday(i).format("dd").charAt(0))}if(this.options.weekOffset&&(this.daysOfTheWeek=this.shiftWeekdayLabels(this.options.weekOffset)),!$.isFunction(this.options.render)){if(this.options.render=null,"undefined"==typeof _)throw new Error("Underscore was not found. Please include underscore.js OR provide a custom render function.");this.compiledClndrTemplate=_.template(this.options.template)}$(this.element).html("<div class='clndr'></div>"),this.calendarContainer=$(".clndr",this.element),this.bindEvents(),this.render(),this.options.ready&&this.options.ready.apply(this,[])},Clndr.prototype.shiftWeekdayLabels=function(offset){for(var days=this.daysOfTheWeek,i=0;offset>i;i++)days.push(days.shift());return days},Clndr.prototype.createDaysObject=function(currentMonth){daysArray=[];var date=currentMonth.startOf("month");if(this.eventsLastMonth=[],this.eventsThisMonth=[],this.eventsNextMonth=[],this.options.events.length)if(this.options.multiDayEvents){if(this.eventsThisMonth=$(this.options.events).filter(function(){return this._clndrStartDateObject.format("YYYY-MM")<=currentMonth.format("YYYY-MM")||currentMonth.format("YYYY-MM")<=this._clndrEndDateObject.format("YYYY-MM")}).toArray(),this.options.showAdjacentMonths){var lastMonth=currentMonth.clone().subtract("months",1),nextMonth=currentMonth.clone().add("months",1);this.eventsLastMonth=$(this.options.events).filter(function(){return this._clndrStartDateObject.format("YYYY-MM")<=lastMonth.format("YYYY-MM")||lastMonth.format("YYYY-MM")<=this._clndrEndDateObject.format("YYYY-MM")}).toArray(),this.eventsNextMonth=$(this.options.events).filter(function(){return this._clndrStartDateObject.format("YYYY-MM")<=nextMonth.format("YYYY-MM")||nextMonth.format("YYYY-MM")<=this._clndrEndDateObject.format("YYYY-MM")}).toArray()}}else if(this.eventsThisMonth=$(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==currentMonth.format("YYYY-MM")}).toArray(),this.options.showAdjacentMonths){var lastMonth=currentMonth.clone().subtract("months",1),nextMonth=currentMonth.clone().add("months",1);this.eventsLastMonth=$(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==lastMonth.format("YYYY-MM")}).toArray(),this.eventsNextMonth=$(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==nextMonth.format("YYYY-MM")}).toArray()}var diff=date.weekday()-this.options.weekOffset;if(0>diff&&(diff+=7),this.options.showAdjacentMonths)for(var i=0;diff>i;i++){var day=moment([currentMonth.year(),currentMonth.month(),i-diff+1]);daysArray.push(this.createDayObject(day,this.eventsLastMonth))}else for(var i=0;diff>i;i++)daysArray.push(this.calendarDay({classes:this.options.targets.empty+" last-month"}));for(var numOfDays=date.daysInMonth(),i=1;numOfDays>=i;i++){var day=moment([currentMonth.year(),currentMonth.month(),i]);daysArray.push(this.createDayObject(day,this.eventsThisMonth))}for(var i=1;0!==daysArray.length%7;){if(this.options.showAdjacentMonths){var day=moment([currentMonth.year(),currentMonth.month(),numOfDays+i]);daysArray.push(this.createDayObject(day,this.eventsNextMonth))}else daysArray.push(this.calendarDay({classes:this.options.targets.empty+" next-month"}));i++}if(this.options.forceSixRows&&42!==daysArray.length)for(var start=moment(daysArray[daysArray.length-1].date).add("days",1);daysArray.length<42;)this.options.showAdjacentMonths?(daysArray.push(this.createDayObject(moment(start),this.eventsNextMonth)),start.add("days",1)):daysArray.push(this.calendarDay({classes:this.options.targets.empty+" next-month"}));return daysArray},Clndr.prototype.createDayObject=function(day,monthEvents){var eventsToday=[],now=moment(),self=this,j=0,l=monthEvents.length;for(j;l>j;j++)if(self.options.multiDayEvents){var start=monthEvents[j]._clndrStartDateObject,end=monthEvents[j]._clndrEndDateObject;(day.isSame(start,"day")||day.isAfter(start,"day"))&&(day.isSame(end,"day")||day.isBefore(end,"day"))&&eventsToday.push(monthEvents[j])}else monthEvents[j]._clndrDateObject.date()==day.date()&&eventsToday.push(monthEvents[j]);var extraClasses="";return now.format("YYYY-MM-DD")==day.format("YYYY-MM-DD")&&(extraClasses+=" today"),day.isBefore(now,"day")&&(extraClasses+=" past"),eventsToday.length&&(extraClasses+=" event"),this.month.month()>day.month()?(extraClasses+=" adjacent-month",extraClasses+=this.month.year()===day.year()?" last-month":" next-month"):this.month.month()<day.month()&&(extraClasses+=" adjacent-month",extraClasses+=this.month.year()===day.year()?" next-month":" last-month"),this.options.constraints&&(this.options.constraints.startDate&&day.isBefore(moment(this.options.constraints.startDate))&&(extraClasses+=" inactive"),this.options.constraints.endDate&&day.isAfter(moment(this.options.constraints.endDate))&&(extraClasses+=" inactive")),!day.isValid()&&day.hasOwnProperty("_d")&&day._d!=undefined&&(day=moment(day._d)),extraClasses+=" calendar-day-"+day.format("YYYY-MM-DD"),extraClasses+=" calendar-dow-"+day.weekday(),this.calendarDay({day:day.date(),classes:this.options.targets.day+extraClasses,events:eventsToday,date:day})},Clndr.prototype.render=function(){this.calendarContainer.children().remove();var days=this.createDaysObject(this.month);this.month;var data={daysOfTheWeek:this.daysOfTheWeek,numberOfRows:Math.ceil(days.length/7),days:days,month:this.month.format("MMMM"),year:this.month.year(),eventsThisMonth:this.eventsThisMonth,eventsLastMonth:this.eventsLastMonth,eventsNextMonth:this.eventsNextMonth,extras:this.options.extras};if(this.options.render?this.calendarContainer.html(this.options.render.apply(this,[data])):this.calendarContainer.html(this.compiledClndrTemplate(data)),this.options.constraints){for(target in this.options.targets)target!=this.options.targets.day&&this.element.find("."+this.options.targets[target]).toggleClass("inactive",!1);var start=null,end=null;this.options.constraints.startDate&&(start=moment(this.options.constraints.startDate)),this.options.constraints.endDate&&(end=moment(this.options.constraints.endDate)),start&&this.month.isSame(start,"month")&&this.element.find("."+this.options.targets.previousButton).toggleClass("inactive",!0),end&&this.month.isSame(end,"month")&&this.element.find("."+this.options.targets.nextButton).toggleClass("inactive",!0),start&&moment(start).subtract("years",1).isBefore(moment(this.month).subtract("years",1))&&this.element.find("."+this.options.targets.previousYearButton).toggleClass("inactive",!0),end&&moment(end).add("years",1).isAfter(moment(this.month).add("years",1))&&this.element.find("."+this.options.targets.nextYearButton).toggleClass("inactive",!0),(start&&start.isAfter(moment(),"month")||end&&end.isBefore(moment(),"month"))&&this.element.find("."+this.options.targets.today).toggleClass("inactive",!0)}this.options.doneRendering&&this.options.doneRendering.apply(this,[])},Clndr.prototype.bindEvents=function(){var $container=$(this.element),self=this;$container.on("click","."+this.options.targets.day,function(event){if(self.options.clickEvents.click){var target=self.buildTargetObject(event.currentTarget,!0);self.options.clickEvents.click.apply(self,[target])}self.options.adjacentDaysChangeMonth&&($(event.currentTarget).is(".last-month")?self.backActionWithContext(self):$(event.currentTarget).is(".next-month")&&self.forwardActionWithContext(self))}),$container.on("click","."+this.options.targets.empty,function(event){if(self.options.clickEvents.click){var target=self.buildTargetObject(event.currentTarget,!1);self.options.clickEvents.click.apply(self,[target])}self.options.adjacentDaysChangeMonth&&($(event.currentTarget).is(".last-month")?self.backActionWithContext(self):$(event.currentTarget).is(".next-month")&&self.forwardActionWithContext(self))}),$container.on("click","."+this.options.targets.previousButton,{context:this},this.backAction).on("click","."+this.options.targets.nextButton,{context:this},this.forwardAction).on("click","."+this.options.targets.todayButton,{context:this},this.todayAction).on("click","."+this.options.targets.nextYearButton,{context:this},this.nextYearAction).on("click","."+this.options.targets.previousYearButton,{context:this},this.previousYearAction)},Clndr.prototype.buildTargetObject=function(currentTarget,targetWasDay){var target={element:currentTarget,events:[],date:null};if(targetWasDay){var dateString,classNameIndex=currentTarget.className.indexOf("calendar-day-");0!==classNameIndex?(dateString=currentTarget.className.substring(classNameIndex+13,classNameIndex+23),target.date=moment(dateString)):target.date=null,this.options.events&&(target.events=this.options.multiDayEvents?$.makeArray($(this.options.events).filter(function(){return(target.date.isSame(this._clndrStartDateObject,"day")||target.date.isAfter(this._clndrStartDateObject,"day"))&&(target.date.isSame(this._clndrEndDateObject,"day")||target.date.isBefore(this._clndrEndDateObject,"day"))})):$.makeArray($(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM-DD")==dateString})))}return target},Clndr.prototype.forwardAction=function(event){var self=event.data.context;self.forwardActionWithContext(self)},Clndr.prototype.backAction=function(event){var self=event.data.context;self.backActionWithContext(self)},Clndr.prototype.backActionWithContext=function(self){if(!self.element.find("."+self.options.targets.previousButton).hasClass("inactive")){var yearChanged=!self.month.isSame(moment(self.month).subtract("months",1),"year");self.month.subtract("months",1),self.render(),self.options.clickEvents.previousMonth&&self.options.clickEvents.previousMonth.apply(self,[moment(self.month)]),self.options.clickEvents.onMonthChange&&self.options.clickEvents.onMonthChange.apply(self,[moment(self.month)]),yearChanged&&self.options.clickEvents.onYearChange&&self.options.clickEvents.onYearChange.apply(self,[moment(self.month)])}},Clndr.prototype.forwardActionWithContext=function(self){if(!self.element.find("."+self.options.targets.nextButton).hasClass("inactive")){var yearChanged=!self.month.isSame(moment(self.month).add("months",1),"year");self.month.add("months",1),self.render(),self.options.clickEvents.nextMonth&&self.options.clickEvents.nextMonth.apply(self,[moment(self.month)]),self.options.clickEvents.onMonthChange&&self.options.clickEvents.onMonthChange.apply(self,[moment(self.month)]),yearChanged&&self.options.clickEvents.onYearChange&&self.options.clickEvents.onYearChange.apply(self,[moment(self.month)])}},Clndr.prototype.todayAction=function(event){var self=event.data.context,monthChanged=!self.month.isSame(moment(),"month"),yearChanged=!self.month.isSame(moment(),"year");self.month=moment().startOf("month"),self.options.clickEvents.today&&self.options.clickEvents.today.apply(self,[moment(self.month)]),monthChanged&&(self.render(),self.month=moment(),self.options.clickEvents.onMonthChange&&self.options.clickEvents.onMonthChange.apply(self,[moment(self.month)]),yearChanged&&self.options.clickEvents.onYearChange&&self.options.clickEvents.onYearChange.apply(self,[moment(self.month)]))},Clndr.prototype.nextYearAction=function(event){var self=event.data.context;self.element.find("."+self.options.targets.nextYearButton).hasClass("inactive")||(self.month.add("years",1),self.render(),self.options.clickEvents.nextYear&&self.options.clickEvents.nextYear.apply(self,[moment(self.month)]),self.options.clickEvents.onMonthChange&&self.options.clickEvents.onMonthChange.apply(self,[moment(self.month)]),self.options.clickEvents.onYearChange&&self.options.clickEvents.onYearChange.apply(self,[moment(self.month)]))},Clndr.prototype.previousYearAction=function(event){var self=event.data.context;self.element.find("."+self.options.targets.previousYear).hasClass("inactive")||(self.month.subtract("years",1),self.render(),self.options.clickEvents.previousYear&&self.options.clickEvents.previousYear.apply(self,[moment(self.month)]),self.options.clickEvents.onMonthChange&&self.options.clickEvents.onMonthChange.apply(self,[moment(self.month)]),self.options.clickEvents.onYearChange&&self.options.clickEvents.onYearChange.apply(self,[moment(self.month)]))},Clndr.prototype.forward=function(options){return this.month.add("months",1),this.render(),options&&options.withCallbacks&&(this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)]),0===this.month.month()&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)])),this},Clndr.prototype.back=function(options){return this.month.subtract("months",1),this.render(),options&&options.withCallbacks&&(this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)]),11===this.month.month()&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)])),this},Clndr.prototype.next=function(options){return this.forward(options),this},Clndr.prototype.previous=function(options){return this.back(options),this},Clndr.prototype.setMonth=function(newMonth,options){return this.month.month(newMonth),this.render(),options&&options.withCallbacks&&this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)]),this},Clndr.prototype.nextYear=function(options){return this.month.add("year",1),this.render(),options&&options.withCallbacks&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]),this},Clndr.prototype.previousYear=function(options){return this.month.subtract("year",1),this.render(),options&&options.withCallbacks&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]),this},Clndr.prototype.setYear=function(newYear,options){return this.month.year(newYear),this.render(),options&&options.withCallbacks&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]),this},Clndr.prototype.setEvents=function(events){return this.options.events=this.options.multiDayEvents?this.addMultiDayMomentObjectsToEvents(events):this.addMomentObjectToEvents(events),this.render(),this},Clndr.prototype.addEvents=function(events){return this.options.events=this.options.multiDayEvents?$.merge(this.options.events,this.addMultiDayMomentObjectsToEvents(events)):$.merge(this.options.events,this.addMomentObjectToEvents(events)),this.render(),this},Clndr.prototype.addMomentObjectToEvents=function(events){var self=this,i=0,l=events.length;for(i;l>i;i++)events[i]._clndrDateObject=moment(events[i][self.options.dateParameter]);return events},Clndr.prototype.addMultiDayMomentObjectsToEvents=function(events){var self=this,i=0,l=events.length;for(i;l>i;i++)events[i]._clndrStartDateObject=moment(events[i][self.options.multiDayEvents.startDate]),events[i]._clndrEndDateObject=moment(events[i][self.options.multiDayEvents.endDate]);return events},Clndr.prototype.calendarDay=function(options){var defaults={day:"",classes:this.options.targets.empty,events:[],date:null};return $.extend({},defaults,options)},$.fn.clndr=function(options){if(1===this.length){if(!this.data("plugin_clndr")){var clndr_instance=new Clndr(this,options);return this.data("plugin_clndr",clndr_instance),clndr_instance}}else if(this.length>1)throw new Error("CLNDR does not support multiple elements yet. Make sure your clndr selector returns only one element.")}}(jQuery,window,document),Booking.Presenters.Calendar=function(super$){function Calendar(){super$.apply(this,arguments)}return extends$(Calendar,super$),Calendar.prototype.toHash=function(){var calendarData,days,firstDayIndex,lastDayIndex,lastMonthAvailable,momentEndOfMonth,momentStartOfMonth,nextMonthAvailable,now,numberOfColumns,numberOfRows,row,rows;calendarData=this.options.calendarData,numberOfColumns=calendarData.days.length/calendarData.numberOfRows,numberOfRows=calendarData.numberOfRows,rows=[],now=moment(),days=_.map(calendarData.days,function(day,i){var at,diff,label,value;
return label=day.events.length?"available":"unavailable",moment.isMoment(day.date)?(diff=day.date.diff(now,"days"),diff?(at=diff>0?"ahead":"behind",value=""+at+"-"+Math.abs(diff)):value="today"):value=i<calendarData.days.length/2?"last-month":"next-month",day.bhc=""+label+":"+value,day});for(var cache$=function(){var accum$;accum$=[];for(var i$=0;numberOfRows-1>=0?numberOfRows-1>=i$:i$>=numberOfRows-1;numberOfRows-1>=0?++i$:--i$)accum$.push(i$);return accum$}.apply(this,arguments),i$=0,length$=cache$.length;length$>i$;++i$)row=cache$[i$],firstDayIndex=row*numberOfColumns,lastDayIndex=(row+1)*numberOfColumns-1,rows[row]={days:days.slice(firstDayIndex,+lastDayIndex+1||9e9)};return momentStartOfMonth=moment(""+calendarData.month+" "+calendarData.year,"MMM YYYY").startOf("month"),momentEndOfMonth=moment(momentStartOfMonth).endOf("month"),lastMonthAvailable=!!this.collection.filter(function(time){return time.get("initialTimeMoment")<momentStartOfMonth}).length,nextMonthAvailable=!!this.collection.filter(function(time){return time.get("initialTimeMoment")>momentEndOfMonth}).length,{loaded:this.collection.isLoaded(),rows:rows,month:calendarData.month,daysOfTheWeek:calendarData.daysOfTheWeek,lastMonthAvailable:lastMonthAvailable,nextMonthAvailable:nextMonthAvailable}},Calendar}(Booking.Presenters.Base),Booking.Views.Calendar=function(super$){function Calendar(){Booking.Views.Base.apply(this,arguments),this.collection.on("request",this.setEvents,this),this.collection.on("sync",this.setEvents,this)}return extends$(Calendar,super$),Calendar.prototype.presenter=Booking.Presenters.Calendar,Calendar.prototype.templateName="calendar",Calendar.prototype.selectedClass="selected",Calendar.prototype.setEvents=function(){return null!=this.calendar&&this.calendar.setEvents(this.collection.toJSON()),this.select()},Calendar.prototype.render=function(){return this.calendar=this.$el.clndr(this.CLNDRparams()),this.select(),this},Calendar.prototype.detach=function(){return this.$el.detach()},Calendar.prototype.toggle=function(){return this.$el.toggle()},Calendar.prototype.hide=function(){return this.$el.hide()},Calendar.prototype.select=function(){return moment.isMoment(null!=this.options.selected?this.options.selected.date:void 0)&&null!=this.calendar?this.calendar.element.find(".calendar-day-"+this.options.selected.date.format("YYYY-MM-DD")).addClass(this.selectedClass):void 0},Calendar.prototype.unselect=function(){return this.calendar.element.find("."+this.selectedClass).removeClass(this.selectedClass)},Calendar.prototype.selectDate=function(selection){return selection.events.length?(this.unselect(),this.options.selected=selection,this.trigger("select",selection,this),this.select()):void 0},Calendar.prototype.renderCalendar=function(data){var presenter;return presenter=new this.presenter({calendarData:data,collection:this.collection}),this.template().render(presenter.toHashWithHelpers())},Calendar.prototype.CLNDRparams=function(){var cache$,startWithMonth,timeMomentField;return timeMomentField="clndrTimeMoment",startWithMonth=moment.isMoment(null!=this.options.selected?this.options.selected.date:void 0)?this.options.selected.date:null!=(cache$=this.collection.first())?cache$.get(timeMomentField):void 0,{showAdjacentMonths:!1,dateParameter:timeMomentField,startWithMonth:startWithMonth,events:this.collection.toJSON(),render:_.bind(this.renderCalendar,this),clickEvents:{click:_.bind(this.selectDate,this)},targets:{nextButton:"next",previousButton:"previous",day:"day",empty:"unavailable"}}},Calendar}(Booking.Views.Base),Booking.Views.DatePicker=function(super$){function DatePicker(){super$.apply(this,arguments)}return extends$(DatePicker,super$),DatePicker.prototype.presenter=Booking.Presenters.DatePicker,DatePicker.prototype.contentView=Booking.Views.Calendar,DatePicker.prototype.templateName="datepicker",DatePicker.prototype.attributes=function(){return{"data-bhw":""+Booking.bhw+"Dates"}},DatePicker.prototype.styleClassName="dates",DatePicker.prototype.isSelectable=function(){return!0},DatePicker}(Booking.Views.Picker),Booking.Presenters.Time=function(super$){function Time(){super$.apply(this,arguments)}return extends$(Time,super$),Time.prototype.timeHash=function(momentTime){return{hours:momentTime.format("h"),minutes:momentTime.format("mm"),period:momentTime.format("a")}},Time.prototype.isRange=function(){var cache$;return null!=this.collection&&null!=(cache$=this.collection.meta("calendar"))?cache$.isARSE():void 0},Time.prototype.modelToHash=function(model,selection){var from,id,isRange,selected,time,to;return id=model.id,isRange=this.isRange(),from=this.timeHash(model.start().tz(model.collection.getTimezone())),isRange&&(to=this.timeHash(model.end().tz(model.collection.getTimezone()))),selected=id===(null!=selection?selection.id:void 0),time={id:id,isRange:isRange,from:from,to:to,selected:selected},{time:time}},Time.prototype.toHash=function(){return this.model?this.modelToHash(this.model,null!=this.options?this.options.selected:void 0):void 0},Time.prototype.bhc=function(){var cache$,from,isRange,label,time,to,value;return cache$=this.toHash().time,from=cache$.from,to=cache$.to,isRange=cache$.isRange,time=function(t){return""+t.hours+"."+t.minutes+t.period},label="time",value=time(from),isRange&&(label="range",value=""+value+"-"+time(to)),""+label+":"+value},Time}(Booking.Presenters.Base),Booking.Presenters.TimePicker=function(super$){function TimePicker(options,templateName){Booking.Presenters.Picker.apply(this,arguments),this.timePresenter=new Booking.Presenters.Time(options,templateName)}return extends$(TimePicker,super$),TimePicker.prototype.toHash=function(){var hash,loading,selected,selection;return selected=this.selected(),loading=selected===!0,hash=Booking.Presenters.Picker.prototype.toHash.apply(this,arguments),hash.loading=loading,loading||(selected&&(selection=this.timePresenter.modelToHash(selected)),hash.selection=null!=selection?selection.time:void 0,hash.isRange=this.timePresenter.isRange()),hash},TimePicker}(Booking.Presenters.Picker),Booking.Views.Time=function(super$){function Time(){super$.apply(this,arguments)}return extends$(Time,super$),Time.prototype.presenter=Booking.Presenters.Time,Time.prototype.templateName="time",Time.prototype.tagName="li",Time.prototype.events={click:"select"},Time.prototype.select=function(){return this.trigger("select",this.model)},Time.prototype.attributes=function(){var cache$;return{"data-bhc":null!=(cache$=this.getPresenter())?cache$.bhc():void 0}},Time}(Booking.Views.Base),Booking.Views.Times=function(super$){function Times(){Booking.Views.Collection.apply(this,arguments),this.on("select",this.select,this)}return extends$(Times,super$),Times.prototype.templateName="times",Times.prototype.childView=Booking.Views.Time,Times.prototype.select=function(time){return this.options.selected=time,setTimeout(function(this$){return function(){return this$.render()}}(this),0)},Times}(Booking.Views.Collection),Booking.Views.TimePicker=function(super$){function TimePicker(){super$.apply(this,arguments)}return extends$(TimePicker,super$),TimePicker.prototype.presenter=Booking.Presenters.TimePicker,TimePicker.prototype.contentView=Booking.Views.Times,TimePicker.prototype.templateName="timepicker",TimePicker.prototype.attributes=function(){return{"data-bhw":""+Booking.bhw+"Times"}},TimePicker.prototype.styleClassName="times",TimePicker.prototype.isSelectable=function(){return!0},TimePicker}(Booking.Views.Picker),Booking.Presenters.PartyPicker=function(super$){function PartyPicker(){super$.apply(this,arguments)}return extends$(PartyPicker,super$),PartyPicker.prototype.toHash=function(){var hash;return hash=Booking.Presenters.Picker.prototype.toHash.apply(this,arguments),null!=this.selected()&&(hash.selectedpartySize={partySize:this.selected().getPartySize()}),hash},PartyPicker}(Booking.Presenters.Picker),Booking.Presenters.PartySize=function(super$){function PartySize(){super$.apply(this,arguments)}return extends$(PartySize,super$),PartySize.prototype.toHash=function(){var partySize,selected;return this.model?(partySize=this.model.getPartySize(),selected=(null!=this.options.selected?this.options.selected.getPartySize():void 0)===partySize,{partySize:partySize,selected:selected}):void 0},PartySize.prototype.bhc=function(){return"partysize:"+this.model.getPartySize()},PartySize}(Booking.Presenters.Base),Booking.Views.PartySize=function(super$){function PartySize(){super$.apply(this,arguments)}return extends$(PartySize,super$),PartySize.prototype.presenter=Booking.Presenters.PartySize,PartySize.prototype.templateName="partysize",PartySize.prototype.tagName="li",PartySize.prototype.events={click:"select"},PartySize.prototype.attributes=function(){var cache$;return{"data-bhc":null!=(cache$=this.getPresenter())?cache$.bhc():void 0}},PartySize.prototype.select=function(){return this.trigger("select",this.model)},PartySize}(Booking.Views.Base),Booking.Views.PartySizes=function(super$){function PartySizes(){Booking.Views.Collection.apply(this,arguments),this.on("select",this.select,this)}return extends$(PartySizes,super$),PartySizes.prototype.templateName="partysizes",PartySizes.prototype.childView=Booking.Views.PartySize,PartySizes.prototype.select=function(partySize){return this.options.selected=partySize,setTimeout(function(this$){return function(){return this$.render()}}(this),0)},PartySizes}(Booking.Views.Collection),Booking.Views.PartySizePicker=function(super$){function PartySizePicker(){super$.apply(this,arguments)}return extends$(PartySizePicker,super$),PartySizePicker.prototype.presenter=Booking.Presenters.PartyPicker,PartySizePicker.prototype.contentView=Booking.Views.PartySizes,PartySizePicker.prototype.templateName="partysizepicker",PartySizePicker.prototype.attributes=function(){return{"data-bhw":""+Booking.bhw+"PartySizes"}},PartySizePicker.prototype.styleClassName="party-sizes",PartySizePicker}(Booking.Views.Picker),/*!
	Autosize v1.18.9 - 2014-05-27
	Automatically adjust textarea height based on user input.
	(c) 2014 Jack Moore - http://www.jacklmoore.com/autosize
	license: http://www.opensource.org/licenses/mit-license.php
*/
function($){var mirrored,defaults={className:"autosizejs",id:"autosizejs",append:"\n",callback:!1,resizeDelay:10,placeholder:!0},copy='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',typographyStyles=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],mirror=$(copy).data("autosize",!0)[0];mirror.style.lineHeight="99px","99px"===$(mirror).css("lineHeight")&&typographyStyles.push("lineHeight"),mirror.style.lineHeight="",$.fn.autosize=function(options){return this.length?(options=$.extend({},defaults,options||{}),mirror.parentNode!==document.body&&$(document.body).append(mirror),this.each(function(){function setWidth(){var width,style=window.getComputedStyle?window.getComputedStyle(ta,null):!1;style?(width=ta.getBoundingClientRect().width,(0===width||"number"!=typeof width)&&(width=parseInt(style.width,10)),$.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(i,val){width-=parseInt(style[val],10)})):width=$ta.width(),mirror.style.width=Math.max(width,0)+"px"}function initMirror(){var styles={};if(mirrored=ta,mirror.className=options.className,mirror.id=options.id,maxHeight=parseInt($ta.css("maxHeight"),10),$.each(typographyStyles,function(i,val){styles[val]=$ta.css(val)}),$(mirror).css(styles).attr("wrap",$ta.attr("wrap")),setWidth(),window.chrome){var width=ta.style.width;ta.style.width="0px",ta.offsetWidth,ta.style.width=width}}function adjust(){var height,original;mirrored!==ta?initMirror():setWidth(),mirror.value=!ta.value&&options.placeholder?($ta.attr("placeholder")||"")+options.append:ta.value+options.append,mirror.style.overflowY=ta.style.overflowY,original=parseInt(ta.style.height,10),mirror.scrollTop=0,mirror.scrollTop=9e4,height=mirror.scrollTop,maxHeight&&height>maxHeight?(ta.style.overflowY="scroll",height=maxHeight):(ta.style.overflowY="hidden",minHeight>height&&(height=minHeight)),height+=boxOffset,original!==height&&(ta.style.height=height+"px",callback&&options.callback.call(ta,ta))}function resize(){clearTimeout(timeout),timeout=setTimeout(function(){var newWidth=$ta.width();newWidth!==width&&(width=newWidth,adjust())},parseInt(options.resizeDelay,10))}var maxHeight,minHeight,timeout,ta=this,$ta=$(ta),boxOffset=0,callback=$.isFunction(options.callback),originalStyles={height:ta.style.height,overflow:ta.style.overflow,overflowY:ta.style.overflowY,wordWrap:ta.style.wordWrap,resize:ta.style.resize},width=$ta.width(),taResize=$ta.css("resize");$ta.data("autosize")||($ta.data("autosize",!0),("border-box"===$ta.css("box-sizing")||"border-box"===$ta.css("-moz-box-sizing")||"border-box"===$ta.css("-webkit-box-sizing"))&&(boxOffset=$ta.outerHeight()-$ta.height()),minHeight=Math.max(parseInt($ta.css("minHeight"),10)-boxOffset||0,$ta.height()),$ta.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word"}),"vertical"===taResize?$ta.css("resize","none"):"both"===taResize&&$ta.css("resize","horizontal"),"onpropertychange"in ta?"oninput"in ta?$ta.on("input.autosize keyup.autosize",adjust):$ta.on("propertychange.autosize",function(){"value"===event.propertyName&&adjust()}):$ta.on("input.autosize",adjust),options.resizeDelay!==!1&&$(window).on("resize.autosize",resize),$ta.on("autosize.resize",adjust),$ta.on("autosize.resizeIncludeStyle",function(){mirrored=null,adjust()}),$ta.on("autosize.destroy",function(){mirrored=null,clearTimeout(timeout),$(window).off("resize",resize),$ta.off("autosize").off(".autosize").css(originalStyles).removeData("autosize")}),adjust())})):this}}(window.jQuery||window.$),Booking.Presenters.Question=function(super$){function Question(){super$.apply(this,arguments)}return extends$(Question,super$),Question.prototype.toHash=function(){return{question:this.options.question,answer:this.options.answer,maxLength:this.options.maxLength,bhw:""+Booking.bhw+"Question"}},Question}(Booking.Presenters.Base),Booking.Views.Question=function(super$){function Question(){super$.apply(this,arguments)}return extends$(Question,super$),Question.prototype.presenter=Booking.Presenters.Question,Question.prototype.templateName="question",Question.prototype.events={"click .label":"focus","blur textarea":"willBlur","change textarea":"refreshStatus","keyup textarea":"refreshStatus","keydown textarea":"refreshStatus","keypress textarea":"newText","paste textarea":"truncatePaste","click .clear":"clear"},Question.prototype.render=function(){return Booking.Views.Base.prototype.render.apply(this,arguments),this.$textarea=this.$el.find("textarea"),this.textarea=this.$textarea.get(0),this.$textarea.autosize(),this.updateLabel(this.$textarea.val()),this.refreshStatus()},Question.prototype.focus=function(){return clearTimeout(this.willBlurTimer),this.updateLabel(),this.$el.addClass("expanded"),this.$textarea.focus()},Question.prototype.willBlur=function(){return this.willBlurTimer=setTimeout(function(this$){return function(){return this$.blur()}}(this),10)},Question.prototype.blur=function(){return this.$el.removeClass("expanded"),this.updateLabel(this.$textarea.val()),this.triggerEvents()},Question.prototype.updateLabel=function(value){return value||(value=this.options.question),this.$el.find(".label").html(value)},Question.prototype.refreshStatus=function(){return this.clearable(),this.triggerEvents()},Question.prototype.newText=function(){var maxLength;return this.refreshStatus(),!in$("maxLength",this.textarea)&&(maxLength=this.textarea.attributes.maxLength.value,this.textarea.value.length>=maxLength)?(this.textarea.value=this.textarea.value.slice(0,maxLength),!1):void 0},Question.prototype.truncatePaste=function(e){var maxLength,paste;return this.clearable(),!in$("maxLength",this.textarea)&&(maxLength=this.textarea.attributes.maxLength.value,paste=e.originalEvent.clipboardData.getData("Text"),this.textarea.value.length+paste.length>=maxLength)?(this.textarea.value+=paste.slice(0,maxLength-this.textarea.value.length),!1):void 0},Question.prototype.clearable=function(){var method;return method=this.textarea.value.length?"addClass":"removeClass",this.$el[method]("clearable")},Question.prototype.clear=function(){return clearTimeout(this.willBlurTimer),this.textarea.value="",this.triggerEvents(),this.clearable(),this.focus()},Question.prototype.triggerEvents=function(){var event,value;return value=this.textarea.value,event=value.length?"complete":"incomplete",this.trigger(event,value)},Question}(Booking.Views.Base),Booking.Presenters.Phone=function(super$){function Phone(){super$.apply(this,arguments)}return extends$(Phone,super$),Phone.prototype.toHash=function(){return{customerPhone:this.options.customerPhone,maxLength:this.options.customerPhoneMaxLength,bhw:""+Booking.bhw+"Phone"}},Phone}(Booking.Presenters.Base),Booking.Views.Phone=function(super$){function Phone(){super$.apply(this,arguments)}return extends$(Phone,super$),Phone.prototype.presenter=Booking.Presenters.Phone,Phone.prototype.templateName="phone",Phone.prototype.maxDigitCount=10,Phone.prototype.events={"keypress input":"formatPhoneNumber","paste input":"dismissPasteEvent","keyup input":"triggerEvents","change input":"clearable","keydown input":"clearable","click .clear":"clear"},Phone.prototype.render=function(){return Booking.Views.Base.prototype.render.apply(this,arguments),this.$input=this.$el.find("input"),this.input=this.$input.get(0),this.$input.PlaceholderField(),this.clearable(),this},Phone.prototype.isntDigitOrControlKey=function(charCode){return charCode>31&&(48>charCode||charCode>57)},Phone.prototype.formatPhoneNumber=function(e){var digit,length,re,value;return this.isntDigitOrControlKey(e.which)?!1:(digit=String.fromCharCode(e.which),/^\d+$/.test(digit)?(value=this.input.value,length=(value.replace(/\D/g,"")+digit).length,length>this.maxDigitCount?(e.preventDefault(),this.input.value=value,void 0):null==this.$input.prop("selectionStart")||this.$input.prop("selectionStart")===value.length?(re=/^(\d{3}|\d{3}\-\d{3})$/,re.test(value)?(e.preventDefault(),this.input.value=""+value+"-"+digit):re.test(value+digit)?(e.preventDefault(),this.input.value=""+value+digit+"-"):void 0):void 0):!0)},Phone.prototype.triggerEvents=function(){var event,value;return value=this.$input.val(),event=value.length===this.options.customerPhoneMaxLength?"complete":"incomplete",this.trigger(event,value)},Phone.prototype.dismissPasteEvent=function(){return!1},Phone.prototype.focus=function(){return this.input.focus()},Phone.prototype.clearable=function(){var method;return method=this.input.value.length?"addClass":"removeClass",this.$el[method]("clearable")},Phone.prototype.clear=function(){return this.input.value="",this.triggerEvents(),this.clearable(),this.focus()},Phone}(Booking.Views.Base),Booking.Presenters.Book=function(super$){function Book(){super$.apply(this,arguments)}return extends$(Book,super$),Book.prototype.toHash=function(){var cache$,isBooking,notYet,phoneNumberRequiredAndNotFilledOut,questionNotAnswered,timeSelected;return timeSelected=this.model.selectedTime(),isBooking=this.model.isBooking()===!0,phoneNumberRequiredAndNotFilledOut=this.model.requirePhone()&&!this.model.getPhoneNumber(),questionNotAnswered=this.model.requireQuestion()&&!this.model.getQuestionsAnswer(),notYet=this.model.isDealNotYetOpen(),{isDisabled:!timeSelected||isBooking||phoneNumberRequiredAndNotFilledOut||questionNotAnswered||notYet,bookAndBuy:this.model.get("bookAndBuy"),reschedule:this.model.get("reschedule"),requestAppointment:null!=(cache$=this.model.getCalendar())?cache$.isARSE():void 0,notYet:notYet}},Book}(Booking.Presenters.Base),Booking.Views.Book=function(super$){function Book(){super$.apply(this,arguments)}return extends$(Book,super$),Book.prototype.presenter=Booking.Presenters.Book,Book.prototype.templateName="book",Book.prototype.attributes=function(){return{"data-bhw":""+Booking.bhw+"BookButton"}},Book}(Booking.Views.Base),Booking.Views.Booker=function(super$){function Booker(){var instance$;instance$=this,this.clearQuestionsAnswer=function(){return Booker.prototype.clearQuestionsAnswer.apply(instance$,arguments)},this.setQuestionsAnswer=function(){return Booker.prototype.setQuestionsAnswer.apply(instance$,arguments)},this.clearPhoneNumber=function(){return Booker.prototype.clearPhoneNumber.apply(instance$,arguments)},this.setPhoneNumber=function(){return Booker.prototype.setPhoneNumber.apply(instance$,arguments)},this.selectPartySize=function(){return Booker.prototype.selectPartySize.apply(instance$,arguments)},this.selectTime=function(){return Booker.prototype.selectTime.apply(instance$,arguments)},this.selectDate=function(){return Booker.prototype.selectDate.apply(instance$,arguments)},this.selectOption=function(){return Booker.prototype.selectOption.apply(instance$,arguments)},Booking.Views.Base.apply(this,arguments),this.model.getAvailability().on("error",this.errorLoading,this),this.model.getReservations().on("error",this.errorBooking,this),this.model.on("change:selectedOption",this.renderInfo,this),this.model.on("change:selectedTime",this.renderBookButton,this),this.model.on("change:phoneNumber",this.renderBookButton,this),this.model.on("change:questionsAnswer",this.renderBookButton,this),this.model.on("change:isBooking",this.renderBookButton,this)}return extends$(Booker,super$),Booker.prototype.presenter=Booking.Presenters.Booker,Booker.prototype.events={"submit form":"book","click .open .btn":"open","click form > .icon-close":"close"},Booker.prototype.className="booking-component",Booker.prototype.canRenderOptions=function(){return this.options.optionSelectable&&this.model.hasMultipleOptions()},Booker.prototype.canRenderPartySize=function(){return this.model.requirePartySize()},Booker.prototype.canRenderQuestion=function(){return this.model.requireQuestion()},Booker.prototype.canRenderPhone=function(){return this.model.requirePhone()},Booker.prototype.setOpen=function(){return this.options.overlapWith&&$(this.options.overlapWith).hide(),this.options.isOpen=!0},Booker.prototype.setOpenAndLocked=function(){return this.setOpen(),this.options.isLocked=!0},Booker.prototype.setClosed=function(){return this.options.isOpen=!1},Booker.prototype.open=function(){return OptimizeSuite.TrackingHub.add("booking-widget-opened",null),this.setOpen(),this.model.reset(),this.render({fadeIn:!0})},Booker.prototype.close=function(){return OptimizeSuite.TrackingHub.add("booking-widget-closed",null),this.setClosed(),this.$el.fadeOut(function(this$){return function(){return this$.render({show:!0}),this$.options.overlapWith&&$(this$.options.overlapWith).fadeIn(),this$.model.resetOption()}}(this))},Booker.prototype.canBeClosed=function(){return this.options.isOpen&&!this.options.keepOpen},Booker.prototype.render=function(){return Booking.Views.Base.prototype.render.apply(this,arguments),this.model.getError()||(this.options.isOpen||this.options.keepOpen)&&(this.renderInfo(),this.renderPickers(),this.canRenderQuestion()&&this.renderQuestion(),this.canRenderPhone()&&this.renderPhone(),this.renderBookButton()),(null!=arguments[0]?arguments[0].fadeIn:void 0)===!0&&this.$el.fadeIn(),(null!=arguments[0]?arguments[0].show:void 0)===!0&&this.$el.show(),this},Booker.prototype.renderInfo=function(){var infoContainer;return infoContainer=this.$el.find("[data-info-content]"),infoContainer.length?infoContainer.html(new Booking.Views.Info({model:this.model}).render().el):void 0},Booker.prototype.renderPickers=function(){var pickersView;return pickersView=new Booking.Views.Pickers({el:this.$el.find("[data-pickers-content]")}),this.canRenderOptions()&&pickersView.add({view:Booking.Views.OptionPicker,model:this.model,collection:"options",selection:"selectedOption",selected:this.selectOption}),this.canRenderPartySize()&&pickersView.add({view:Booking.Views.PartySizePicker,model:this.model,collection:"partySizes",selection:"selectedPartySize",selected:this.selectPartySize}),this.datePicker=pickersView.add({view:Booking.Views.DatePicker,model:this.model,collection:"availability",selection:"selectedDate",selected:this.selectDate}),this.timePicker=pickersView.add({view:Booking.Views.TimePicker,model:this.model,collection:"times",selection:"selectedTime",selected:this.selectTime}),pickersView.render(),pickersView.on("collapse",function(this$){return function(){return this$.pickersCollapsed()}}(this)),pickersView.once("expanded",function(this$){return function(){return this$.trigger("ready")}}(this))},Booker.prototype.renderQuestion=function(){return this.questionInput=new Booking.Views.Question({el:this.$el.find("[data-question-content]"),maxLength:this.options.metasSettings.answerMaxLength,question:this.model.getQuestion(),answer:this.model.getQuestionsAnswer()}),this.questionInput.render(),this.questionInput.on("complete",this.setQuestionsAnswer,this),this.questionInput.on("incomplete",this.clearQuestionsAnswer,this)},Booker.prototype.renderPhone=function(){return this.phoneInput=new Booking.Views.Phone({el:this.$el.find("[data-phone-content]"),customerPhoneMaxLength:this.options.metasSettings.customerPhoneMaxLength,customerPhone:this.model.getPhoneNumber()}),this.phoneInput.render(),this.phoneInput.on("complete",this.setPhoneNumber,this),this.phoneInput.on("incomplete",this.clearPhoneNumber,this)},Booker.prototype.pickersCollapsed=function(){return null==this.model.getQuestion()||this.model.getQuestionsAnswer()?this.model.getPhoneNumber()?void 0:this.phoneInput.focus():this.questionInput.focus()},Booker.prototype.renderBookButton=function(){var bookContainer;return bookContainer=this.$el.find("[data-book-now-content]"),bookContainer.length?bookContainer.html(new Booking.Views.Book({model:this.model}).render().el):void 0},Booker.prototype.selectOption=function(option){return this.model.selectOption(option)},Booker.prototype.selectDate=function(date){return this.model.selectDate(date)},Booker.prototype.selectTime=function(time){return this.model.selectTime(time)},Booker.prototype.selectPartySize=function(partySize){return this.model.selectPartySize(partySize)},Booker.prototype.setPhoneNumber=function(phoneNumber){return this.model.setPhoneNumber(phoneNumber)},Booker.prototype.clearPhoneNumber=function(){return this.setPhoneNumber(void 0)},Booker.prototype.setQuestionsAnswer=function(answer){return this.model.setQuestionsAnswer(answer)},Booker.prototype.clearQuestionsAnswer=function(){return this.setQuestionsAnswer(void 0)},Booker.prototype.book=function(event){return event.stopPropagation(),this.model.book(),!1},Booker.prototype.errorLoading=function(){return this.error("loading")},Booker.prototype.errorBooking=function(reservation){return this.error(reservation.getError())},Booker.prototype.error=function(error){return this.model.setError(error),this.canBeClosed()?this.close():this.render()},Booker}(Booking.Views.Base),Booking.dealBookerInit=function(payload,done){var cache$,calendar,datetime,deal,el,error,failed,metasSettings,model,optionId,overlapWith,partySize,phoneNumber,places,questionsAnswer,timezoneData,view;return null==done&&(done=function(){}),payload?(Booking.bhw="BookingEngineDealBooker",cache$=payload,calendar=cache$.calendar,deal=cache$.deal,places=cache$.places,timezoneData=cache$.timezoneData,el=cache$.el,failed=cache$.failed,error=cache$.error,overlapWith=cache$.overlapWith,metasSettings=cache$.metasSettings,optionId=cache$.optionId,partySize=cache$.partySize,datetime=cache$.datetime,questionsAnswer=cache$.questionsAnswer,phoneNumber=cache$.phoneNumber,moment.tz.add(timezoneData),model=new Booking.Models.Booker({bookAndBuy:!0,calendar:calendar,deal:deal}),model.get("places").reset(places),model.get("options").reset(deal.options),model.preset({optionId:optionId,partySize:partySize,datetime:datetime,questionsAnswer:questionsAnswer,phoneNumber:phoneNumber}),model.get("options").selectable().length?(view=new Booking.Views.Booker({optionSelectable:!0,el:el||"#deal-booker",overlapWith:overlapWith||"#purchase-cluster .buy, #purchase-cluster .buy-for-friend-module, #purchase-cluster .limited-time, #purchase-cluster .deal-status, #purchase-cluster .deal-discount, #purchase-cluster .gift-card",model:model,templateName:"deal_booker",metasSettings:metasSettings}),model.get("availability").on("error",function(){return null!=failed?failed.apply(this,arguments):void 0}),model.get("reservations").on("error",function(){return null!=error?error.apply(this,arguments):void 0}),model.get("reservations").on("sync",function(reservation){var option;return option=model.get("options").get(reservation.get("dealOptionId")),view.trigger("buy",option,reservation)}),view.on("buy",function(option,reservation){var buyUrl,separator;return buyUrl=option.get("buyUrl"),reservation&&(separator=buyUrl.match(/\?/)?"&":"?",buyUrl+=""+separator+"booking_reservation_id="+reservation.get("id")),window.location=buyUrl}),$(function(){return $("#purchase-cluster .buy").length||view.setOpenAndLocked(),view.render(),done()})):done()):done()},null!=window.BookingWrapper?window.BookingWrapper:window.BookingWrapper={},BookingWrapper.init=function(param$,done){var booker;return booker=param$.booker,$(function(){return Booking.dealBookerInit(booker),done()})},null!=window.DeliveryEstimates?window.DeliveryEstimates:window.DeliveryEstimates={},DeliveryEstimates.Model=Backbone.Model.extend({url:function(){return""+this.get("rootUrl")+"/proxy/v2/deals/"+this.get("dealUuid")+"/delivery_estimation"},parse:function(response){var cache$,deliveryEstimates,error;return null==response?null:(cache$=response,deliveryEstimates=cache$.deliveryEstimates,error=cache$.error,error?null:{estimate:this.formatDate(deliveryEstimates)})},formatDate:function(response){var days,estimate;days=null;for(var cache$=response||[],i$=0,length$=cache$.length;length$>i$;++i$)estimate=cache$[i$],"standard_delivery_time"===estimate.id&&(days=estimate.days),"maximum_delivery_time"===estimate.id&&null===days&&(days=estimate.days);return days?moment().add("days",days).format("dddd, MMM Do"):null}}),null!=window.DeliveryEstimates?window.DeliveryEstimates:window.DeliveryEstimates={},DeliveryEstimates.View=Backbone.View.extend({initialize:function(){return this.banner=$(".free-shipping"),this.inline=this.$(".delivery-shipping"),this.freeShipping=this.model.get("freeShipping"),this.experimentFlags=this.model.get("experimentFlags"),this.validDeal=!1,DealEventPipe.on("priceUpdate",function(this$){return function(priceData){return this$.updateFreeShipping(priceData,this$.experimentFlags)}}(this))},render:function(){var cache$,cache$1,deliveryEstimate,inline;return this.estimate=this.model.get("estimate"),this.estimate&&this.experimentFlags?(this.validDeal=!0,inline=this.experimentFlags.inline,inline&&this.banner.hide(),deliveryEstimate=this.$(".delivery-estimate"),0===(null!=(cache$=deliveryEstimate.html())?cache$.length:void 0)&&deliveryEstimate.html(this.estimate),(null!=(cache$1=deliveryEstimate.html())?cache$1.length:void 0)?void 0:(this.validDeal=!1,this.$el.hide())):(this.validDeal=!1,this.$el.hide())},updateFreeShipping:function(param$,param$1){var banner,cache$,inline,uuid;return uuid=param$.uuid,cache$=param$1,banner=cache$.banner,inline=cache$.inline,this.validDeal?(banner&&(this.freeShipping[uuid]?this.banner.show():this.banner.hide()),inline?this.freeShipping[uuid]?this.inline.show():this.inline.hide():void 0):void 0}}),null!=window.DeliveryEstimates?window.DeliveryEstimates:window.DeliveryEstimates={},DeliveryEstimates.init=function(param$,done){var cache$,deliveryEstimates,rootUrl;return cache$=param$,deliveryEstimates=cache$.deliveryEstimates,rootUrl=cache$.rootUrl,null==deliveryEstimates||null==rootUrl?done():$(function(){var cache$1,dealUuid,freeShipping,model,options,view;return cache$1=deliveryEstimates,dealUuid=cache$1.dealUuid,options=cache$1.options,freeShipping=cache$1.freeShipping,model=new DeliveryEstimates.Model({rootUrl:rootUrl,dealUuid:dealUuid,freeShipping:freeShipping,experimentFlags:options}),view=new DeliveryEstimates.View({model:model,el:".delivery-estimates"}),model.fetch({data:{dealUuid:dealUuid},success:function(){return view.render()},error:function(){return view.render()}}),done()})},null!=window.SubtitleTooltip?window.SubtitleTooltip:window.SubtitleTooltip={},SubtitleTooltip.init=function(payload,done){return $(function(){return $("#show-all-locations-subtitle").click(function(){var subtitletooltip;return subtitletooltip=$("#subtitle-locations-tooltip"),subtitletooltip.css("opacity",0),subtitletooltip.hide()}),done()})},$(function(){var $tips;return $tips=$(".tip"),$tips.on("click",".show-more-btn",function(){var $tip;return $tip=$(this).parents(".tip"),$tip.addClass("tip-open")}),$tips.on("click",".show-less-btn",function(){var $tip;return $tip=$(this).parents(".tip"),$tip.removeClass("tip-open")})}),null!=window.OneClickBuy?window.OneClickBuy:window.OneClickBuy={},OneClickBuy.Model=Backbone.Model.extend({url:function(){return"/deals/new/orders"},toJSON:function(){return{_csrf:this.get("_csrf"),billing_record:this.get("billingRecord"),instant_buy:!0,ioBlackBox:this.get("ioBlackBox"),items:[{deal_id:this.get("dealId"),option_id:this.get("optionId"),quantity:this.get("quantity")}]}},isNew:function(){return!0}}),null!=window.OneClickBuy?window.OneClickBuy:window.OneClickBuy={},jQuery.fn.outerHTML=function(){return jQuery("<div />").append(this.eq(0).clone()).html()},OneClickBuy.View=Backbone.View.extend({el:"#purchase-cluster",events:{"change .quantity-selector":"handleQuantityChange"},initialize:function(){var makeOrder;return BuyButton.view.multiOptionEnabled||(makeOrder=function(this$){return function(){return this$.makeOrder()}}(this),BuyButton.eventBus.board("buy_button_clicked",makeOrder)(996)),this.fixPossiblePriceOverflow()},makeOrder:function(){var data,ioBlackBox;return BuyButton.view.hasBeenClicked||BuyButton.view.offersClicked||BuyButton.view.giftButtonClicked?!1:(BuyButton.view.disableBuyButton(),data={},(ioBlackBox=$("#ioBlackBox").val())&&(data={ioBlackBox:ioBlackBox}),this.model.save(data,{success:this.orderFollow,error:this.orderFollow}),{stopTheBus:!0})},orderFollow:function(model,response){return(null!=response?response.url:void 0)?window.location.assign(response.url):(BuyButton.view.enableBuyButton(),BuyButton.view.processLink())},handleQuantityChange:function(e){var value;return(value=$(null!=e?e.currentTarget:void 0).val())?this.model.set("quantity",value):void 0},fixPossiblePriceOverflow:function(){var $dealHeroPrice,$oneClickCluster,$oneClickQuantity,$price,noOverFlowHtml;return $price=$(".price"),$price.height()>parseInt($price.css("line-height"),10)?($oneClickCluster=$("#one-click-cluster"),$dealHeroPrice=$("#deal-hero-price"),$oneClickQuantity=$("#one-click-quantity"),noOverFlowHtml=""+$dealHeroPrice.outerHTML()+'\n<div class="full-width-quantity">\n  '+$oneClickQuantity.outerHTML()+"\n</div>",$oneClickCluster.html(noOverFlowHtml)):void 0}}),null!=window.OneClickBuy?window.OneClickBuy:window.OneClickBuy={},OneClickBuy.init=function(param$,done){var model,oneClickBuyData;return(oneClickBuyData=param$.oneClickBuyData)?(model=new OneClickBuy.Model(oneClickBuyData),$(function(){return new OneClickBuy.View({model:model}),done()})):done()},void function(){function isOwn$(o,p){return{}.hasOwnProperty.call(o,p)}function extends$(child,parent){function ctor(){this.constructor=child}for(var key in parent)isOwn$(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child}var CountdownTimerView,FourPackCarouselView,RightRailView,VideoWidgetView;FourPackCarouselView=function(super$){function FourPackCarouselView(){super$.apply(this,arguments)}return extends$(FourPackCarouselView,super$),FourPackCarouselView.prototype.events={"click .carousel-previous":"moveLeft","click .carousel-next":"moveRight"},FourPackCarouselView.prototype.initialize=function(){return this.$carousel=this.$(".carousel"),this.$leftButton=this.$(".carousel-previous"),this.$rightButton=this.$(".carousel-next"),this.currentPosition=0,this.maxPosition=this.$(".deal-card").length-1,this.visibleCards=4,this.$(".lazy-load").lazyload({event:"in-carousel"}),this.loadCardsInCarousel(this.currentPosition)},FourPackCarouselView.prototype.moveLeft=function(){return this.canMoveLeft()&&!this.$leftButton.hasClass("inactive")?this.currentPosition-this.visibleCards<0?this.animate(0):this.animate(this.currentPosition-this.visibleCards):void 0},FourPackCarouselView.prototype.moveRight=function(){return this.canMoveRight()&&!this.$rightButton.hasClass("inactive")?this.currentPosition+(this.visibleCards-1)+this.visibleCards>this.maxPosition?this.animate(this.maxPosition-(this.visibleCards-1)):this.animate(this.currentPosition+this.visibleCards):void 0},FourPackCarouselView.prototype.canMoveRight=function(){return this.currentPosition+this.visibleCards<=this.maxPosition},FourPackCarouselView.prototype.canMoveLeft=function(){return this.currentPosition>=1},FourPackCarouselView.prototype.showButton=function($button){return $button.removeClass("inactive")},FourPackCarouselView.prototype.hideButton=function($button){return $button.addClass("inactive")},FourPackCarouselView.prototype.animate=function(newPosition){return Modernizr.csstransitions?(this.$carousel.css({left:-(239*newPosition)}),this.finishAnimation(newPosition)):this.$carousel.animate({left:-(239*newPosition)},{duration:250,complete:function(this$){return function(){return this$.finishAnimation(newPosition)}}(this)})},FourPackCarouselView.prototype.loadCardsInCarousel=function(startingIndex){return this.$(".lazy-load").slice(startingIndex,startingIndex+this.visibleCards).trigger("in-carousel")},FourPackCarouselView.prototype.finishAnimation=function(newPosition){return this.loadCardsInCarousel(newPosition),this.currentPosition=newPosition,this.canMoveLeft()?this.showButton(this.$leftButton):this.hideButton(this.$leftButton),this.canMoveRight()?this.showButton(this.$rightButton):this.hideButton(this.$rightButton)},FourPackCarouselView}(Backbone.View),RightRailView=function(super$){function RightRailView(){var instance$;instance$=this,this.setFixPoint=function(){return RightRailView.prototype.setFixPoint.apply(instance$,arguments)},this.shouldFix=function(){return RightRailView.prototype.shouldFix.apply(instance$,arguments)},this.atBottom=function(){return RightRailView.prototype.atBottom.apply(instance$,arguments)},this.floatView=function(){return RightRailView.prototype.floatView.apply(instance$,arguments)},super$.apply(this,arguments)}return extends$(RightRailView,super$),RightRailView.prototype.initialize=function(){return this.container=$(window),this.document=$(document),this.header=$(".header"),this.banner=$(".in-app-msg-banner"),this.bannerCloseBtn=$(".in-app-msg-banner .hide-link"),this.footer=$(".footer-i18n"),this.fixedTopMargin=50,this.fixPoint=0,this.setFixPoint(),this.floatView(),this.container.scroll(this.floatView),this.bannerCloseBtn.click(this.setFixPoint)},RightRailView.prototype.floatView=function(){return this.$el.removeClass("fixed top bottom"),this.shouldFix()?this.$el.addClass("fixed"):this.atBottom()?this.$el.addClass("bottom"):this.$el.addClass("top")},RightRailView.prototype.atBottom=function(){return this.container.scrollTop()+this.$el.outerHeight()+this.fixedTopMargin>this.document.height()-this.footer.outerHeight()},RightRailView.prototype.shouldFix=function(){return this.container.scrollTop()>this.fixPoint&&!this.atBottom()},RightRailView.prototype.setFixPoint=function(){return this.fixPoint=this.header.position().top+this.outerHeightWithMargin(this.header)+this.outerHeightWithMargin(this.banner)-this.fixedTopMargin},RightRailView.prototype.outerHeightWithMargin=function(element){return element.is(":visible")?element.outerHeight(!0):0},RightRailView}(Backbone.View),VideoWidgetView=function(super$){function VideoWidgetView(){var instance$;instance$=this,this.resetVideoPlayer=function(){return VideoWidgetView.prototype.resetVideoPlayer.apply(instance$,arguments)},this.onCreate=function(){return VideoWidgetView.prototype.onCreate.apply(instance$,arguments)},super$.apply(this,arguments)}return extends$(VideoWidgetView,super$),VideoWidgetView.prototype.events={"click .image-container":"playVideo"},VideoWidgetView.videoIsloaded=!1,VideoWidgetView.prototype.initialize=function(){return null!=this.$el?this.$el:this.$el=$(this.el),this.video=this.$(".video-container"),this.imageContainer=this.$(".image-container"),this.previewImageAndPlayButton=this.$(".image-container img"),this.videoId=this.video.data("video-id"),this.videoIsloaded?void 0:this.loadVideoPlayer()},VideoWidgetView.prototype.onCreate=function(player){return player.subscribe("played","myPage",this.resetVideoPlayer)},VideoWidgetView.prototype.resetVideoPlayer=function(){return this.imageContainer.removeClass("hidden"),this.previewImageAndPlayButton.animate({opacity:.8,duration:100}),this.videoPlayer.seek(0)},VideoWidgetView.prototype.fetchVideoPlayer=function(){return OO.ready(function(this$){return function(){var options;return options={flashParams:{hide:"info,endscreen"},onCreate:this$.onCreate},this$.videoPlayer=OO.Player.create("ooyala-player",this$.videoId,options)}}(this))},VideoWidgetView.prototype.loadVideoPlayer=function(){var script;script=document.createElement("script"),script.type="text/javascript",script.src="//player.ooyala.com/v3/4e60e82cdbc14def8b05623206f02388",script.readyState?script.onreadystatechange=function(){("loaded"===script.readyState||"complete"===script.readyState)&&(this.videoIsloaded=!0)}:script.onload=function(){this.videoIsloaded=!0},$("head").append(script)},VideoWidgetView.prototype.playVideo=function(){return this.videoPlayer||this.fetchVideoPlayer(),this.videoPlayer.play(),this.imageContainer.addClass("hidden"),this.previewImageAndPlayButton.css({opacity:0})
},VideoWidgetView}(Backbone.View),CountdownTimerView=function(super$){function CountdownTimerView(){var instance$;instance$=this,this.getNewTimeStamp=function(){return CountdownTimerView.prototype.getNewTimeStamp.apply(instance$,arguments)},this.updateCountdown=function(){return CountdownTimerView.prototype.updateCountdown.apply(instance$,arguments)},super$.apply(this,arguments)}return extends$(CountdownTimerView,super$),CountdownTimerView.prototype.initialize=function(){return null!=this.$el?this.$el:this.$el=$(this.el),this.offerEndTime=$(".steals-timer").data("offer-end-time"),this.tick=1e3,this.getNewTimeStamp(),this.updateCountdown()},CountdownTimerView.prototype.updateCountdown=function(){return setInterval(this.getNewTimeStamp,this.tick)},CountdownTimerView.prototype.timeRemaining=function(timeRemainingMilliseconds){var days,hours,millisecondsLeft,minutes,seconds;return null==timeRemainingMilliseconds?{days:0,hours:0,minutes:0,seconds:0}:(days=Math.floor(timeRemainingMilliseconds/864e5),millisecondsLeft=Math.floor(timeRemainingMilliseconds-864e5*days),hours=Math.floor(millisecondsLeft/36e5),millisecondsLeft=Math.floor(millisecondsLeft-36e5*hours),minutes=Math.floor(millisecondsLeft/6e4),millisecondsLeft=Math.floor(millisecondsLeft-60*1e3*minutes),seconds=Math.floor(millisecondsLeft/1e3),{days:days,hours:hours,minutes:minutes,seconds:seconds})},CountdownTimerView.prototype.millisRemaining=function(endTime){var millsRemaining,rightNow;return null==endTime?0:(rightNow=(new Date).getTime(),millsRemaining=endTime-rightNow,0>millsRemaining?0:millsRemaining)},CountdownTimerView.prototype.countdownTimestamp=function(timeLeft){var hh,mm,ss;return hh=this.addLeadingZero(timeLeft.hours),mm=this.addLeadingZero(timeLeft.minutes),ss=this.addLeadingZero(timeLeft.seconds)," "+hh+":"+mm+":"+ss},CountdownTimerView.prototype.addLeadingZero=function(number){return 0>number?void 0:10>number?"0"+number:""+number},CountdownTimerView.prototype.getNewTimeStamp=function(){var endTime,millisLeft,newTimeStamp;return(null!=this.offerEndTime?this.offerEndTime.length:void 0)<1&&(this.offerEndTime=this.getEndOfDayTime()),endTime=Date.parse(this.offerEndTime),millisLeft=this.millisRemaining(endTime),newTimeStamp=this.countdownTimestamp(this.timeRemaining(millisLeft)),this.$el.html(newTimeStamp)},CountdownTimerView.prototype.getEndOfDayTime=function(){var date;return date=new Date,date.setDate(date.getDate()+1),date.setHours(0),date.setMinutes(0),date.setSeconds(0),date},CountdownTimerView}(Backbone.View),null!=window.WLS?window.WLS:window.WLS={},null!=window.WLS.Views?window.WLS.Views:window.WLS.Views={},window.WLS.Views.FourPackCarousel=FourPackCarouselView,window.WLS.Views.RightRail=RightRailView,window.WLS.Views.VideoWidget=VideoWidgetView,window.WLS.Views.CountdownTimer=CountdownTimerView,WLS.init=function(options){return null==options&&(options={}),_.defaults(options),$(".right-rail").each(function(index,el){return new WLS.Views.RightRail({el:el})}),$(".carousel-widget").each(function(index,el){return new WLS.Views.FourPackCarousel({el:el})}),$(".video-widget").each(function(index,el){return new WLS.Views.VideoWidget({el:el})}),$(".steals-timer").each(function(index,el){return new WLS.Views.CountdownTimer({el:el})})},$(function(){return WLS.init()})}.call(this);