function selectFeaturedPhotoGalleryImage(e) { FeaturedPhotoGalleryAnimationRunning = true; $("#fp_th_" + e).attr("src", "/images/2.1/icons/button_on.gif"); if (FeaturedPhotoGalleryPreviousIndex != e) { $("#fp_th_" + FeaturedPhotoGalleryPreviousIndex).attr("src", "/images/2.1/icons/button_off.gif") } FeaturedPhotoGalleryCurrentZ++; $("#fp_img_" + e).css("z-index", FeaturedPhotoGalleryCurrentZ); $("#fp_img_" + e).fadeIn(FeaturedPhotoGalleryTransDuration, function () { if (FeaturedPhotoGalleryPreviousIndex != null && FeaturedPhotoGalleryPreviousIndex != e) { $("#fp_img_" + FeaturedPhotoGalleryPreviousIndex).hide() } FeaturedPhotoGalleryPreviousIndex = e; FeaturedPhotoGalleryCurrentIndex = e }); $("#DisplayedPhotoCaptionBlock").html($("#fp_img_" + e).attr("alt")); FeaturedPhotoGalleryAnimationRunning = false } function clickTheFeaturedPhotoGalleryImage(e) { FeaturedPhotoGallerySlideshowRunning = false; clearInterval(FeaturedPhotoGallerySlideshow); $("#FeaturedPhotoGalleryPausePlayButton").attr("src", "/images/2.1/icons/button_play.gif"); selectFeaturedPhotoGalleryImage(e) } function advanceFeaturedPhotoGalleryImage() { FeaturedPhotoGalleryCurrentIndex = parseInt(FeaturedPhotoGalleryCurrentIndex, 10) + 1 == FeaturedPhotoGalleryArrayLength ? 0 : parseInt(FeaturedPhotoGalleryCurrentIndex, 10) + 1; selectFeaturedPhotoGalleryImage(FeaturedPhotoGalleryCurrentIndex) } function beginFeaturedPhotoGallerySlideShow() { selectFeaturedPhotoGalleryImage(FeaturedPhotoGalleryCurrentIndex); if (FeaturedPhotoGalleryArrayLength > 1) { clearInterval(FeaturedPhotoGallerySlideshow); FeaturedPhotoGallerySlideshow = setInterval(advanceFeaturedPhotoGalleryImage, FeaturedPhotoGallerySlideDuration); FeaturedPhotoGallerySlideshowRunning = true } } function startStopFeaturedPhotoGallerySlideshow() { if (FeaturedPhotoGalleryAnimationRunning == false) { if (FeaturedPhotoGallerySlideshowRunning) { FeaturedPhotoGallerySlideshowRunning = false; clearInterval(FeaturedPhotoGallerySlideshow); $("#FeaturedPhotoGalleryPausePlayButton").attr("src", "/images/2.1/icons/button_play.gif") } else { $("#FeaturedPhotoGalleryPausePlayButton").attr("src", "/images/2.1/icons/button_pause.gif"); beginFeaturedPhotoGallerySlideShow() } } } function InitializeFeaturedPhotoGallery() { FeaturedPhotoGalleryArrayLength = parseInt($("#FeaturedPhotoGalleryArrayCount").val(), 10); var e = 0; for (e = 0; e <= FeaturedPhotoGalleryArrayLength; e++) { $("#fp_img_" + e).hide(); $("#fp_img_" + e).css("z-index", FeaturedPhotoGalleryCurrentZ); $("#fp_img_" + e).attr("src", $("#fp_img_" + e).attr("other")); FeaturedPhotoGalleryCurrentIndex = 0; clickTheFeaturedPhotoGalleryImage(FeaturedPhotoGalleryCurrentIndex) } $(".FeaturedPhotoGalleryBannerMenuBox").show() } var FeaturedPhotoGalleryAnimationRunning = false; var FeaturedPhotoGalleryArrayLength = 0; var FeaturedPhotoGalleryCurrentIndex = 0; var FeaturedPhotoGalleryCurrentZ = 0; var FeaturedPhotoGalleryPreviousIndex = 0; var FeaturedPhotoGallerySlideshow; var FeaturedPhotoGallerySlideshowRunning; var FeaturedPhotoGallerySlideDuration = 5e3; var FeaturedPhotoGalleryTransDuration = 0; if (typeof $ == "function") { $(document).ready(function () { if ($.support.boxModel) { $("#PhotoGalleryList").after('<div id="DisplayedPhotoCaptionBlock"></div><div id="DisplayedPhotoCaptionButton">Caption</div>'); $("#DisplayedPhotoCaptionButton").css("opacity", "0.6"); $("#DisplayedPhotoCaptionButton").click(function () { var e = $(this); if (e.text() == "Caption") { e.text("Close").hide().prev().slideDown(400, function () { e.css("bottom", "122px").show() }) } else { e.text("Caption").hide().prev().slideUp(400, function () { e.css("bottom", "25px").show() }) } }); $("#DisplayedPhotoCaptionBlock").css("opacity", "0.8").prev().load(function () { $(this).fadeIn(200).show() }); $("#PhotoGalleryList").children("li").mouseenter(function () { startStopFeaturedPhotoGallerySlideshow() }).mouseleave(function () { startStopFeaturedPhotoGallerySlideshow() }) } }) } this.imagePreview = function (e) { xOffset = 89; yOffset = -24; $("img.PhotoGalleryToolTip").hover(function (e) { var t = this.getAttribute("rel"); $("body").append("<div id='PhotoGalleryToolTipPreviewWrapper'><p id='PhotoGalleryToolTipPreview'><img width='82' height='54' src='" + t + "' alt='" + this.alt + "' /></p><p id='PhotoGalleryToolTipArrows'></p></div>"); $("#PhotoGalleryToolTipPreviewWrapper").css("top", e.pageY - xOffset + "px").css("left", e.pageX + yOffset + "px").fadeIn("fast") }, function () { $("#PhotoGalleryToolTipPreviewWrapper").remove() }) }; $(document).ready(function () { imagePreview() })