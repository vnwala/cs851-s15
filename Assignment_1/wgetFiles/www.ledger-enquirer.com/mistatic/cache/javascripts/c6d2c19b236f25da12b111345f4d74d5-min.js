(function($){$.fn.placehold=function(options){var opts=$.extend({},$.fn.placehold.defaults,options);return this.each(function(){if(!("placeholder"in document.createElement("input"))){var placeholder_attr=$(this).attr("placeholder");if(placeholder_attr){var elem=$(this);if(!elem.val()||elem.val()==placeholder_attr){elem.addClass(opts.placeholderClassName).val(placeholder_attr)}elem.focus(function(){if(elem.val()==placeholder_attr){elem.removeClass(opts.placeholderClassName).val("")}});elem.blur(function(){if(!elem.val()){elem.addClass(opts.placeholderClassName).val(placeholder_attr)}});elem.closest("form").submit(function(){if(elem.val()==placeholder_attr){elem.val("")}return true})}}})};$.fn.placehold.defaults={placeholderClassName:"placeholder"}})(jQuery);jQuery.cookie=function(name,value,options){if(typeof value!='undefined'){options=options||{};if(value===null){value='';options.expires=-1;}
var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var date;if(typeof options.expires=='number'){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000));}else{date=options.expires;}
expires='; expires='+date.toUTCString();}
var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('');}else{var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}};(function($){$.ceebox={version:"2.1.5"};$.fn.ceebox=function(opts){opts=$.extend({selector:$(this).selector},$.fn.ceebox.defaults,opts);var elem=this;var selector=$(this).selector;if(opts.videoJSON){$.getJSON(opts.videoJSON,function(json){$.extend($.fn.ceebox.videos,json);init(elem,opts,selector);});}else{init(elem,opts,selector);}
return this;};$.fn.ceebox.defaults={html:true,image:true,video:true,modal:false,titles:true,htmlGallery:true,imageGallery:true,videoGallery:true,videoWidth:false,videoHeight:false,videoRatio:"16:9",htmlWidth:false,htmlHeight:false,htmlRatio:false,imageWidth:600,imageHeight:600,animSpeed:"normal",easing:"swing",fadeOut:400,fadeIn:400,overlayColor:"#000",overlayOpacity:0.8,boxColor:"",textColor:"",borderColor:"",borderWidth:"3px",padding:15,margin:150,onload:null,unload:null,videoJSON:null,iPhoneRedirect:true};$.fn.ceebox.ratios={"4:3":1.333,"3:2":1.5,"16:9":1.778,"1:1":1,"square":1};$.fn.ceebox.relMatch={width:/(?:width:)([0-9]+)/i,height:/(?:height:)([0-9]+)/i,ratio:/(?:ratio:)([0-9\.:]+)/i,modal:/modal:true/i,nonmodal:/modal:false/i,videoSrc:/(?:videoSrc:)(http:[\/\-\._0-9a-zA-Z:]+)/i,videoId:/(?:videoId:)([\-\._0-9a-zA-Z:]+)/i};$.fn.ceebox.loader="<div id='cee_load' style='z-index:105;top:50%;left:50%;position:fixed'></div>";$.fn.ceebox.videos={base:{param:{wmode:"transparent",allowFullScreen:"true",allowScriptAccess:"always"},flashvars:{autoplay:true}},facebook:{siteRgx:/facebook\.com\/video/i,idRgx:/(?:v=)([a-zA-Z0-9_]+)/i,src:"http://www.facebook.com/v/[id]"},youtube:{siteRgx:/youtube\.com\/watch/i,idRgx:/(?:v=)([a-zA-Z0-9_\-]+)/i,src:"http://www.youtube.com/v/[id]&hl=en&fs=1&autoplay=1"},metacafe:{siteRgx:/metacafe\.com\/watch/i,idRgx:/(?:watch\/)([a-zA-Z0-9_]+)/i,src:"http://www.metacafe.com/fplayer/[id]/.swf"},google:{siteRgx:/google\.com\/videoplay/i,idRgx:/(?:id=)([a-zA-Z0-9_\-]+)/i,src:"http://video.google.com/googleplayer.swf?docId=[id]&hl=en&fs=true",flashvars:{playerMode:"normal",fs:true}},spike:{siteRgx:/spike\.com\/video|ifilm\.com\/video/i,idRgx:/(?:\/)([0-9]+)/i,src:"http://www.spike.com/efp",flashvars:{flvbaseclip:"[id]"}},vimeo:{siteRgx:/vimeo\.com\/[0-9]+/i,idRgx:/(?:\.com\/)([a-zA-Z0-9_]+)/i,src:"http://www.vimeo.com/moogaloop.swf?clip_id=[id]&server=vimeo.com&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1"},dailymotion:{siteRgx:/dailymotion\.com\/video/i,idRgx:/(?:video\/)([a-zA-Z0-9_]+)/i,src:"http://www.dailymotion.com/swf/[id]&related=0&autoplay=1"},cnn:{siteRgx:/cnn\.com\/video/i,idRgx:/(?:\?\/video\/)([a-zA-Z0-9_\/\.]+)/i,src:"http://i.cdn.turner.com/cnn/.element/apps/cvp/3.0/swf/cnn_416x234_embed.swf?context=embed&videoId=[id]",width:416,height:374}};$.fn.ceebox.overlay=function(opts){opts=$.extend({width:60,height:30,type:"html"},$.fn.ceebox.defaults,opts);if($("#cee_overlay").size()===0){$("<div id='cee_overlay'></div>").css({opacity:opts.overlayOpacity,position:"absolute",top:0,left:0,backgroundColor:opts.overlayColor,width:"100%",height:$(document).height(),zIndex:2147483645,}).appendTo($("body"));}
if($("#cee_box").size()===0){var pos=boxPos(opts);var boxCSS={position:pos.position,zIndex:2147483647,top:"50%",left:"50%",height:opts.height+"px",width:opts.width+"px",marginLeft:pos.mleft+'px',marginTop:pos.mtop+'px',opacity:0,borderWidth:opts.borderWidth,borderColor:opts.borderColor,backgroundColor:opts.boxColor,color:opts.textColor};$("<div id='cee_box'></div>").css(boxCSS).appendTo("body").animate({opacity:1},opts.animSpeed,function(){$("#cee_overlay").addClass("cee_close");});}
$("#cee_box").removeClass().addClass("cee_"+opts.type);if($("#cee_load").size()===0){$($.fn.ceebox.loader).appendTo("body");}
$("#cee_load").show("fast").animate({opacity:1},"fast");};$.fn.ceebox.popup=function(content,opts){var page=pageSize(opts.margin);opts=$.extend({width:page.width,height:page.height,modal:false,type:"html",onload:null},$.fn.ceebox.defaults,opts);var gallery,family;if($(content).is("a,area,input")&&(opts.type=="html"||opts.type=="image"||opts.type=="video")){if(opts.gallery){family=$(opts.selector).eq(opts.gallery.parentId).find("a[href],area[href],input[href]");}
Build[opts.type].prototype=new BoxAttr(content,opts);var cb=new Build[opts.type]();content=cb.content;opts.action=cb.action;opts.modal=cb.modal;if(opts.titles){opts.titleHeight=$(cb.titlebox).contents().contents().wrap("<div></div>").parent().attr("id","ceetitletest").css({position:"absolute",top:"-300px",width:cb.width+"px"}).appendTo("body").height();$("#ceetitletest").remove();opts.titleHeight=(opts.titleHeight>=10)?opts.titleHeight+20:30;}else{opts.titleHeight=0;}
opts.width=cb.width+2*opts.padding;opts.height=cb.height+opts.titleHeight+2*opts.padding;}
$.fn.ceebox.overlay(opts);base.action=opts.action;base.onload=opts.onload;base.unload=opts.unload;var pos=boxPos(opts);var animOpts={marginLeft:pos.mleft,marginTop:pos.mtop,width:opts.width+"px",height:opts.height+"px",borderWidth:opts.borderWidth};if(opts.borderColor){var reg=/#[1-90a-f]+/gi;var borderColor=cssParse(opts.borderColor,reg);animOpts=$.extend(animOpts,{borderTopColor:borderColor[0],borderRightColor:borderColor[1],borderBottomColor:borderColor[2],borderLeftColor:borderColor[3]});}
animOpts=(opts.textColor)?$.extend(animOpts,{color:opts.textColor}):animOpts;animOpts=(opts.boxColor)?$.extend(animOpts,{backgroundColor:opts.boxColor}):animOpts;$("#cee_box").animate(animOpts,opts.animSpeed,opts.easing,function(){var children=$(this).append(content).children().hide();var len=children.length;var onloadcall=true;children.fadeIn(opts.fadeIn,function(){if($(this).is("#cee_iframeContent")){onloadcall=false;}
if(onloadcall&&this==children[len-1]){$.fn.ceebox.onload();}});if(opts.modal===true){$("#cee_overlay").removeClass("cee_close");}else{$("<a href='#' id='cee_closeBtn' class='cee_close' title='Close'>close</a>").prependTo("#cee_box");if(opts.gallery){addGallery(opts.gallery,family,opts);}
keyEvents(gallery,family,opts.fadeOut);}});};$.fn.ceebox.closebox=function(fade,unload){fade=fade||400;$("#cee_box").fadeOut(fade);$("#cee_overlay").fadeOut((typeof fade=='number')?fade*2:"slow",function(){$('#cee_box,#cee_overlay,#cee_HideSelect,#cee_load').unbind().trigger("unload").remove();if(isFunction(unload)){unload();}else if(isFunction(base.unload)){base.unload();}
base.unload=null;});document.onkeydown=null;};$.fn.ceebox.onload=function(opts){$("#cee_load").hide(300).fadeOut(600,function(){$(this).remove();});if(isFunction(base.action)){base.action();base.action=null;}
if(isFunction(base.onload)){base.onload();base.onload=null;}};var base={};function init(elem,opts,selector){base.vidRegex=function(){var regStr="";$.each($.fn.ceebox.videos,function(i,v){if(v.siteRgx!==null&&typeof v.siteRgx!=='string'){var tmp=String(v.siteRgx);regStr=regStr+tmp.slice(1,tmp.length-2)+"|";}});return new RegExp(regStr+"\\.swf$","i");}();base.userAgent=navigator.userAgent;$(".cee_close").die().live("click",function(){$.fn.ceebox.closebox();return false;});if(selector!=false){$(elem).each(function(i){ceeboxLinkSort(this,i,opts,selector);});}
$(elem).live("click",function(e){var tgt=$(e.target).closest("[href]");var tgtData=tgt.data("ceebox");if(tgtData){var linkOpts=(tgtData.opts)?$.extend({},opts,tgtData.opts):opts;$.fn.ceebox.overlay(linkOpts);if(tgtData.type=="image"){var imgPreload=new Image();imgPreload.onload=function(){var w=imgPreload.width,h=imgPreload.height;linkOpts.imageWidth=getSmlr(w,$.fn.ceebox.defaults.imageWidth);linkOpts.imageHeight=getSmlr(h,$.fn.ceebox.defaults.imageHeight);linkOpts.imageRatio=w/h;$.fn.ceebox.popup(tgt,$.extend(linkOpts,{type:tgtData.type},{gallery:tgtData.gallery}));};imgPreload.src=$(tgt).attr("href");}else{$.fn.ceebox.popup(tgt,$.extend(linkOpts,{type:tgtData.type},{gallery:tgtData.gallery}));}
return false;}});}
var ceeboxLinkSort=function(parent,parentId,opts,selector){var family,cbLinks=[],galleryLinks=[],gNum=0;($(parent).is("[href]"))?family=$(parent):family=$(parent).find("[href]");var urlMatch={image:function(h,r){if(r&&r.match(/\bimage\b/i)){return true;}else{return h.match(/\.jpg$|\.jpeg$|\.png$|\.gif$|\.bmp$/i)||false;}},video:function(h,r){if(r&&r.match(/\bvideo\b/i)){return true;}else{return h.match(base.vidRegex)||false;}},html:function(h){return true;}};var familyLen=family.length;family.each(function(i){var alink=this;var metadata=$.metadata?$(alink).metadata():false;var linkOpts=metadata?$.extend({},opts,metadata):opts;$.each(urlMatch,function(type){if(urlMatch[type]($(alink).attr("href"),$(alink).attr("rel"))&&linkOpts[type]){var gallery=false;if(linkOpts[type+"Gallery"]===true){galleryLinks[galleryLinks.length]=i;gallery=true;}
cbLinks[cbLinks.length]={linkObj:alink,type:type,gallery:gallery,linkOpts:linkOpts};return false;}});});var gLen=galleryLinks.length;$.each(cbLinks,function(i){if(cbLinks[i].gallery){var gallery={parentId:parentId,gNum:gNum,gLen:gLen};if(gNum>0){gallery.prevId=galleryLinks[gNum-1];}
if(gNum<gLen-1){gallery.nextId=galleryLinks[gNum+1];}
gNum++;}
if(!$.support.opacity&&$(parent).is("map")){$(cbLinks[i].linkObj).click(function(e){e.preventDefault();});}
$.data(cbLinks[i].linkObj,"ceebox",{type:cbLinks[i].type,opts:cbLinks[i].linkOpts,gallery:gallery});});};var BoxAttr=function(cblink,o){var w=o[o.type+"Width"];var h=o[o.type+"Height"];var r=o[o.type+"Ratio"]||w/h;var rel=$(cblink).attr("rel");if(rel&&rel!==""){var m={};$.each($.fn.ceebox.relMatch,function(i,v){m[i]=v.exec(rel);});if(m.modal){o.modal=true;}
if(m.nonmodal){o.modal=false;}
if(m.width){w=Number(lastItem(m.width));}
if(m.height){h=Number(lastItem(m.height));}
if(m.ratio){r=lastItem(m.ratio);r=(Number(r))?Number(r):String(r);}
if(m.videoSrc){this.videoSrc=String(lastItem(m.videoSrc));}
if(m.videoId){this.videoId=String(lastItem(m.videoId));}}
var p=pageSize(o.margin);w=getSmlr(w,p.width);h=getSmlr(h,p.height);if(r){if(!Number(r)){r=($.fn.ceebox.ratios[r])?Number($.fn.ceebox.ratios[r]):1;}
if(w/h>r){w=parseInt(h*r,10);}
if(w/h<r){h=parseInt(w/r,10);}}
this.modal=o.modal;this.href=$(cblink).attr("href");this.title=$(cblink).attr("title")||cblink.t||"";this.titlebox=(o.titles)?"<div id='cee_title'><h2>"+this.title+"</h2></div>":"";this.width=w;this.height=h;this.rel=rel;this.iPhoneRedirect=o.iPhoneRedirect;};var Build={image:function(){this.content="<img id='cee_img' src='"+this.href+"' width='"+this.width+"' height='"+this.height+"' alt='"+this.title+"'/>"+this.titlebox;},video:function(){var content="",cb=this;var vid=function(){var rtn=this,id=cb.videoId;rtn.flashvars=rtn.param={};rtn.src=cb.videoSrc||cb.href;rtn.width=cb.width;rtn.height=cb.height;$.each($.fn.ceebox.videos,function(i,v){if(v.siteRgx&&typeof v.siteRgx!='string'&&v.siteRgx.test(cb.href)){if(v.idRgx){v.idRgx=new RegExp(v.idRgx);id=String(lastItem(v.idRgx.exec(cb.href)));}
rtn.src=(v.src)?v.src.replace("[id]",id):rtn.src;if(v.flashvars){$.each(v.flashvars,function(ii,vv){if(typeof vv=='string'){rtn.flashvars[ii]=vv.replace("[id]",id);}});}
if(v.param){$.each(v.param,function(ii,vv){if(typeof vv=='string'){rtn.param[ii]=vv.replace("[id]",id);}});}
rtn.width=v.width||rtn.width;rtn.height=v.height||rtn.height;rtn.site=i;return;}});return rtn;}();if($.flash.hasVersion(8)){this.width=vid.width;this.height=vid.height;this.action=function(){$('#cee_vid').flash({swf:vid.src,params:$.extend($.fn.ceebox.videos.base.param,vid.param),flashvars:$.extend($.fn.ceebox.videos.base.flashvars,vid.flashvars),width:vid.width,height:vid.height});};}else{this.width=400;this.height=200;if(((base.userAgent.match(/iPhone/i))&&this.iPhoneRedirect)||((base.userAgent.match(/iPod/i))&&this.iPhoneRedirect)){var redirect=this.href;this.action=function(){$.fn.ceebox.closebox(400,function(){window.location=redirect;});};}else{vid.site=vid.site||"SWF file";content="<p style='margin:20px'>Adobe Flash 8 or higher is required to view this movie. You can either:</p><ul><li>Follow link to <a href='"+this.href+"'>"+vid.site+" </a></li><li>or <a href='http://www.adobe.com/products/flashplayer/'>Install Flash</a></li><li> or <a href='#' class='cee_close'>Close This Popup</a></li></ul>";}}
this.content="<div id='cee_vid' style='width:"+this.width+"px;height:"+this.height+"px;'>"+content+"</div>"+this.titlebox;},html:function(){var h=this.href,r=this.rel;var m=[h.match(/[a-zA-Z0-9_\.]+\.[a-zA-Z]{2,4}/i),h.match(/^http:+/),(r)?r.match(/^iframe/):false];if((document.domain==m[0]&&m[1]&&!m[2])||(!m[1]&&!m[2])){var id,ajx=(id=h.match(/#[a-zA-Z0-9_\-]+/))?String(h.split("#")[0]+" "+id):h;this.action=function(){$("#cee_ajax").load(ajx);};this.content=this.titlebox+"<div id='cee_ajax' style='width:"+(this.width-30)+"px;height:"+(this.height-20)+"px'></div>";}else{$("#cee_iframe").remove();this.content=this.titlebox+"<iframe frameborder='0' hspace='0' src='"+h+"' id='cee_iframeContent' name='cee_iframeContent"+Math.round(Math.random()*1000)+"' onload='jQuery.fn.ceebox.onload()' style='width:"+(this.width)+"px;height:"+(this.height)+"px;' > </iframe>";}}};function pageSize(margin){var de=document.documentElement;margin=margin||100;this.width=(window.innerWidth||self.innerWidth||(de&&de.clientWidth)||document.body.clientWidth)-margin;this.height=(window.innerHeight||self.innerHeight||(de&&de.clientHeight)||document.body.clientHeight)-margin;return this;}
function boxPos(opts){var pos="fixed",scroll=0,reg=/[0-9]+/g,b=cssParse(opts.borderWidth,reg);if(!window.XMLHttpRequest){if($("#cee_HideSelect")===null){$("body").append("<iframe id='cee_HideSelect'></iframe>");}
pos="absolute";scroll=parseInt((document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop),10);}
this.mleft=parseInt(-1*((opts.width)/2+173+Number(b[3])),10);this.mtop=parseInt(-1*((opts.height)/2+Number(b[0])),10)+scroll;this.position=pos;return this;}
function cssParse(css,reg){var temp=css.match(reg),rtn=[],l=temp.length;if(l>1){rtn[0]=temp[0];rtn[1]=temp[1];rtn[2]=(l==2)?temp[0]:temp[2];rtn[3]=(l==4)?temp[3]:temp[1];}else{rtn=[temp,temp,temp,temp];}
return rtn;}
function keyEvents(){document.onkeydown=function(e){e=e||window.event;var kc=e.keyCode||e.which;switch(kc){case 13:return false;case 27:$.fn.ceebox.closebox();document.onkeydown=null;break;case 188:case 37:$("#cee_prev").trigger("click");break;case 190:case 39:$("#cee_next").trigger("click");break;default:break;}
return true;};}
function addGallery(g,family,opts){var h=opts.height,w=opts.width,th=opts.titleHeight,p=opts.padding;var nav={image:{w:parseInt(w/2,10),h:h-th-2*p,top:p,bgtop:(h-th-2*p)/2},video:{w:60,h:80,top:parseInt(((h-th-10)-2*p)/2,10),bgtop:24}};nav.html=nav.video;function navLink(btn,id){var s,on=nav[opts.type].bgtop,off=(on-2000),px="px";(btn=="prev")?s=[{left:0},"left"]:s=[{right:0},x="right"];var style=function(y){return $.extend({zIndex:105,width:nav[opts.type].w+px,height:nav[opts.type].h+px,position:"absolute",top:nav[opts.type].top,backgroundPosition:s[1]+" "+y+px},s[0]);};$("<a href='#'></a>").text(btn).attr({id:"cee_"+btn}).css(style(off)).hover(function(){$(this).css(style(on));},function(){$(this).css(style(off));}).one("click",function(e){e.preventDefault();(function(f,id,fade){$("#cee_prev,#cee_next").unbind().click(function(){return false;});document.onkeydown=null;var content=$("#cee_box").children(),len=content.length;content.fadeOut(fade,function(){$(this).remove();if(this==content[len-1]){f.eq(id).trigger("click");}});})(family,id,opts.fadeOut);}).appendTo("#cee_box");}
if(g.prevId>=0){navLink("prev",g.prevId);}
if(g.nextId){navLink("next",g.nextId);}
$("#cee_title").append("<div id='cee_count'>Item "+(g.gNum+1)+" of "+g.gLen+"</div>");}
function getSmlr(a,b){return((a&&a<b)||!b)?a:b;}
function isFunction(a){return typeof a=='function';}
function lastItem(a){var l=a.length;return(l>1)?a[l-1]:a;}
function debug(a,tag,opts){if(debugging===true){var bugs="",header="[ceebox]("+(tag||"")+")";($.isArray(a)||typeof a=='object'||typeof a=='function')?$.each(a,function(i,val){bugs=bugs+i+":"+val+", ";}):bugs=a;if(window.console&&window.console.log){window.console.log(header+bugs);}else{if($("#debug").size()===0){$("<ul id='debug'></ul>").appendTo("body").css({border:"1px solid #ccf",position:"fixed",top:"10px",right:"10px",width:"300px",padding:"10px",listStyle:"square"});$("<li>").css({margin:"0 0 5px"}).appendTo("#debug").append(header).wrapInner("<b></b>").append(" "+bugs);}}}}})(jQuery);;window.Modernizr=(function(window,document,undefined){var version='2.7.1',Modernizr={},enableClasses=true,docElement=document.documentElement,mod='modernizr',modElem=document.createElement(mod),mStyle=modElem.style,inputElem,smile=':)',toString={}.toString,prefixes=' -webkit- -moz- -o- -ms- '.split(' '),omPrefixes='Webkit Moz O ms',cssomPrefixes=omPrefixes.split(' '),domPrefixes=omPrefixes.toLowerCase().split(' '),tests={},inputs={},attrs={},classes=[],slice=classes.slice,featureName,injectElementWithStyles=function(rule,callback,nodes,testnames){var style,ret,node,docOverflow,div=document.createElement('div'),body=document.body,fakeBody=body||document.createElement('body');if(parseInt(nodes,10)){while(nodes--){node=document.createElement('div');node.id=testnames?testnames[nodes]:mod+(nodes+1);div.appendChild(node);}}
style=['&#173;','<style id="s',mod,'">',rule,'</style>'].join('');div.id=mod;(body?div:fakeBody).innerHTML+=style;fakeBody.appendChild(div);if(!body){fakeBody.style.background='';fakeBody.style.overflow='hidden';docOverflow=docElement.style.overflow;docElement.style.overflow='hidden';docElement.appendChild(fakeBody);}
ret=callback(div,rule);if(!body){fakeBody.parentNode.removeChild(fakeBody);docElement.style.overflow=docOverflow;}else{div.parentNode.removeChild(div);}
return!!ret;},_hasOwnProperty=({}).hasOwnProperty,hasOwnProp;if(!is(_hasOwnProperty,'undefined')&&!is(_hasOwnProperty.call,'undefined')){hasOwnProp=function(object,property){return _hasOwnProperty.call(object,property);};}
else{hasOwnProp=function(object,property){return((property in object)&&is(object.constructor.prototype[property],'undefined'));};}
if(!Function.prototype.bind){Function.prototype.bind=function bind(that){var target=this;if(typeof target!="function"){throw new TypeError();}
var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F();var result=target.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result){return result;}
return self;}else{return target.apply(that,args.concat(slice.call(arguments)));}};return bound;};}
function setCss(str){mStyle.cssText=str;}
function setCssAll(str1,str2){return setCss(prefixes.join(str1+';')+(str2||''));}
function is(obj,type){return typeof obj===type;}
function contains(str,substr){return!!~(''+str).indexOf(substr);}
function testProps(props,prefixed){for(var i in props){var prop=props[i];if(!contains(prop,"-")&&mStyle[prop]!==undefined){return prefixed=='pfx'?prop:true;}}
return false;}
function testDOMProps(props,obj,elem){for(var i in props){var item=obj[props[i]];if(item!==undefined){if(elem===false)return props[i];if(is(item,'function')){return item.bind(elem||obj);}
return item;}}
return false;}
function testPropsAll(prop,prefixed,elem){var ucProp=prop.charAt(0).toUpperCase()+prop.slice(1),props=(prop+' '+cssomPrefixes.join(ucProp+' ')+ucProp).split(' ');if(is(prefixed,"string")||is(prefixed,"undefined")){return testProps(props,prefixed);}else{props=(prop+' '+(domPrefixes).join(ucProp+' ')+ucProp).split(' ');return testDOMProps(props,prefixed,elem);}}tests['flexbox']=function(){return testPropsAll('flexWrap');};tests['flexboxlegacy']=function(){return testPropsAll('boxDirection');};tests['touch']=function(){var bool;if(('ontouchstart'in window)||window.DocumentTouch&&document instanceof DocumentTouch){bool=true;}else{injectElementWithStyles(['@media (',prefixes.join('touch-enabled),('),mod,')','{#modernizr{top:9px;position:absolute}}'].join(''),function(node){bool=node.offsetTop===9;});}
return bool;};tests['rgba']=function(){setCss('background-color:rgba(150,255,150,.5)');return contains(mStyle.backgroundColor,'rgba');};tests['hsla']=function(){setCss('background-color:hsla(120,40%,100%,.5)');return contains(mStyle.backgroundColor,'rgba')||contains(mStyle.backgroundColor,'hsla');};tests['multiplebgs']=function(){setCss('background:url(https://),url(https://),red url(https://)');return(/(url\s*\(.*?){3}/).test(mStyle.background);};tests['backgroundsize']=function(){return testPropsAll('backgroundSize');};tests['borderimage']=function(){return testPropsAll('borderImage');};tests['borderradius']=function(){return testPropsAll('borderRadius');};tests['boxshadow']=function(){return testPropsAll('boxShadow');};tests['textshadow']=function(){return document.createElement('div').style.textShadow==='';};tests['opacity']=function(){setCssAll('opacity:.55');return(/^0.55$/).test(mStyle.opacity);};tests['cssanimations']=function(){return testPropsAll('animationName');};tests['csscolumns']=function(){return testPropsAll('columnCount');};tests['cssgradients']=function(){var str1='background-image:',str2='gradient(linear,left top,right bottom,from(#9f9),to(white));',str3='linear-gradient(left top,#9f9, white);';setCss((str1+'-webkit- '.split(' ').join(str2+str1)+
prefixes.join(str3+str1)).slice(0,-str1.length));return contains(mStyle.backgroundImage,'gradient');};tests['cssreflections']=function(){return testPropsAll('boxReflect');};tests['csstransforms']=function(){return!!testPropsAll('transform');};tests['csstransforms3d']=function(){var ret=!!testPropsAll('perspective');if(ret&&'webkitPerspective'in docElement.style){injectElementWithStyles('@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}',function(node,rule){ret=node.offsetLeft===9&&node.offsetHeight===3;});}
return ret;};tests['csstransitions']=function(){return testPropsAll('transition');};tests['fontface']=function(){var bool;injectElementWithStyles('@font-face {font-family:"font";src:url("https://")}',function(node,rule){var style=document.getElementById('smodernizr'),sheet=style.sheet||style.styleSheet,cssText=sheet?(sheet.cssRules&&sheet.cssRules[0]?sheet.cssRules[0].cssText:sheet.cssText||''):'';bool=/src/i.test(cssText)&&cssText.indexOf(rule.split(' ')[0])===0;});return bool;};tests['generatedcontent']=function(){var bool;injectElementWithStyles(['#',mod,'{font:0/0 a}#',mod,':after{content:"',smile,'";visibility:hidden;font:3px/1 a}'].join(''),function(node){bool=node.offsetHeight>=3;});return bool;};for(var feature in tests){if(hasOwnProp(tests,feature)){featureName=feature.toLowerCase();Modernizr[featureName]=tests[feature]();classes.push((Modernizr[featureName]?'':'no-')+featureName);}}
Modernizr.addTest=function(feature,test){if(typeof feature=='object'){for(var key in feature){if(hasOwnProp(feature,key)){Modernizr.addTest(key,feature[key]);}}}else{feature=feature.toLowerCase();if(Modernizr[feature]!==undefined){return Modernizr;}
test=typeof test=='function'?test():test;if(typeof enableClasses!=="undefined"&&enableClasses){docElement.className+=' '+(test?'':'no-')+feature;}
Modernizr[feature]=test;}
return Modernizr;};setCss('');modElem=inputElem=null;;(function(window,document){var version='3.7.0';var options=window.html5||{};var reSkip=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i;var saveClones=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i;var supportsHtml5Styles;var expando='_html5shiv';var expanID=0;var expandoData={};var supportsUnknownElements;(function(){try{var a=document.createElement('a');a.innerHTML='<xyz></xyz>';supportsHtml5Styles=('hidden'in a);supportsUnknownElements=a.childNodes.length==1||(function(){(document.createElement)('a');var frag=document.createDocumentFragment();return(typeof frag.cloneNode=='undefined'||typeof frag.createDocumentFragment=='undefined'||typeof frag.createElement=='undefined');}());}catch(e){supportsHtml5Styles=true;supportsUnknownElements=true;}}());function addStyleSheet(ownerDocument,cssText){var p=ownerDocument.createElement('p'),parent=ownerDocument.getElementsByTagName('head')[0]||ownerDocument.documentElement;p.innerHTML='x<style>'+cssText+'</style>';return parent.insertBefore(p.lastChild,parent.firstChild);}
function getElements(){var elements=html5.elements;return typeof elements=='string'?elements.split(' '):elements;}
function getExpandoData(ownerDocument){var data=expandoData[ownerDocument[expando]];if(!data){data={};expanID++;ownerDocument[expando]=expanID;expandoData[expanID]=data;}
return data;}
function createElement(nodeName,ownerDocument,data){if(!ownerDocument){ownerDocument=document;}
if(supportsUnknownElements){return ownerDocument.createElement(nodeName);}
if(!data){data=getExpandoData(ownerDocument);}
var node;if(data.cache[nodeName]){node=data.cache[nodeName].cloneNode();}else if(saveClones.test(nodeName)){node=(data.cache[nodeName]=data.createElem(nodeName)).cloneNode();}else{node=data.createElem(nodeName);}
return node.canHaveChildren&&!reSkip.test(nodeName)&&!node.tagUrn?data.frag.appendChild(node):node;}
function createDocumentFragment(ownerDocument,data){if(!ownerDocument){ownerDocument=document;}
if(supportsUnknownElements){return ownerDocument.createDocumentFragment();}
data=data||getExpandoData(ownerDocument);var clone=data.frag.cloneNode(),i=0,elems=getElements(),l=elems.length;for(;i<l;i++){clone.createElement(elems[i]);}
return clone;}
function shivMethods(ownerDocument,data){if(!data.cache){data.cache={};data.createElem=ownerDocument.createElement;data.createFrag=ownerDocument.createDocumentFragment;data.frag=data.createFrag();}
ownerDocument.createElement=function(nodeName){if(!html5.shivMethods){return data.createElem(nodeName);}
return createElement(nodeName,ownerDocument,data);};ownerDocument.createDocumentFragment=Function('h,f','return function(){'+
'var n=f.cloneNode(),c=n.createElement;'+
'h.shivMethods&&('+
getElements().join().replace(/[\w\-]+/g,function(nodeName){data.createElem(nodeName);data.frag.createElement(nodeName);return'c("'+nodeName+'")';})+
');return n}')(html5,data.frag);}
function shivDocument(ownerDocument){if(!ownerDocument){ownerDocument=document;}
var data=getExpandoData(ownerDocument);if(html5.shivCSS&&!supportsHtml5Styles&&!data.hasCSS){data.hasCSS=!!addStyleSheet(ownerDocument,'article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}'+
'mark{background:#FF0;color:#000}'+
'template{display:none}');}
if(!supportsUnknownElements){shivMethods(ownerDocument,data);}
return ownerDocument;}
var html5={'elements':options.elements||'abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video','version':version,'shivCSS':(options.shivCSS!==false),'supportsUnknownElements':supportsUnknownElements,'shivMethods':(options.shivMethods!==false),'type':'default','shivDocument':shivDocument,createElement:createElement,createDocumentFragment:createDocumentFragment};window.html5=html5;shivDocument(document);}(this,document));Modernizr._version=version;Modernizr._prefixes=prefixes;Modernizr._domPrefixes=domPrefixes;Modernizr._cssomPrefixes=cssomPrefixes;Modernizr.testProp=function(prop){return testProps([prop]);};Modernizr.testAllProps=testPropsAll;Modernizr.testStyles=injectElementWithStyles;docElement.className=docElement.className.replace(/(^|\s)no-js(\s|$)/,'$1$2')+
(enableClasses?' js '+classes.join(' '):'');return Modernizr;})(this,this.document);;function padding(parent_container,target_elements,remainder_element,border_size,vertical){var link_size=0;var unpadded=0;if(vertical){var parent_size=parent_container.height();}else{var parent_size=parent_container.width();}
var link_count=target_elements.length;if(vertical){target_elements.each(function(){unpadded+=$(this).height();link_size=$(this).height();$(this).css('height',link_size+"px");});}else{target_elements.each(function(){unpadded+=$(this).width();link_size=$(this).width();$(this).css('width',link_size+"px");});}
unpadded+=border_size;var raw_padding=(parent_size-unpadded)/link_count;var padding=Math.floor(raw_padding);var remainder=Math.round((raw_padding-padding)*link_count);if(Math.floor(padding/2)<0){var math_floor=5;}else{var math_floor=Math.floor(padding/2);}
if(Math.ceil(padding/2)<0){var math_ceil=5;}else{var math_ceil=Math.ceil(padding/2);}
if(Math.floor(remainder/2)<0){var math_floor_r=5;}else{var math_floor_r=Math.ceil(remainder/2);}
if(Math.ceil(remainder/2)<0){var math_ceil_r=5;}else{var math_ceil_r=Math.ceil(remainder/2);}
if(vertical){target_elements.css({'padding-top':math_floor,'padding-bottom':math_ceil});remainder_element.css({'padding-top':math_floor_r+math_floor,'padding-bottom':math_ceil_r+math_ceil});}else{target_elements.css({'padding-left':math_floor,'padding-right':math_ceil});remainder_element.css({'padding-left':math_floor_r+math_floor,'padding-right':math_ceil_r+math_ceil});}}
function fix_params_on_submit(params){if(typeof(params)=='object'){jQuery.each(params,function(key,value){element=$(key);if(element.val()===value.from){element.val(value.to);}});}};jQuery.fn.hoverWithDelay=function(inCallback,outCallback,delay){this.each(function(i,el){var timer;$(this).hover(function(){timer=setTimeout(function(){timer=null;inCallback.call(el);},delay);},function(){if(timer){clearTimeout(timer);timer=null;}else
outCallback.call(el);});});};$(document).ready(function(){$('.options_button').click(function(){$('.search_options').slideToggle();});$("input, textarea").placehold();$('.jobs input:first-child, .cars input:first-child, .homes input:first-child').focus(function(){$(this).val('');$(this).parent().parent('li.form').css('height','auto');});$('.caption').click(function(){$(this).toggleClass('active');});$("#detail_page .scrollable").scrollable({size:1,clickable:false}).navigator();$("#blog_post .scrollable").scrollable({size:1,clickable:false}).navigator();$("#gallery_detail .scrollable").scrollable({size:12,clickable:false}).navigator();$(".ceebox_image").ceebox({onload:function(){var text=$("#cee_count").text();var item=text.split(" ")[1];var id="#item"+item;var buy_link=$(id).data('buy_link');$("#cee_title h2").after(buy_link).fadeIn();}});$(".ceebox_video").ceebox({titles:false,htmlGallery:false,htmlWidth:445,htmlHeight:340});$(".login").ceebox({titles:false,htmlGallery:false});function start_radar_loop(image_div){$('#cee_box '+image_div).cycle({fx:'fade',speed:10,timeout:700});};$.each(['smallRadarImages','largeRadarImages'],function(){var image_div=this;console.log(image_div);$(".ceebox_radar_"+image_div).ceebox({titles:false,htmlGallery:false,htmlWidth:640,htmlHeight:480,onload:function(){var images_loaded=false;var wait_for_seconds=5;var wait=setInterval(function(){if($('#cee_box #'+image_div).length>0){images_loaded=true;start_radar_loop('#'+image_div);clearInterval(wait);}
else if(wait_for_seconds--==0){clearInterval(wait);}},1000);}});});$('#topJobKeywords')
.focus(function(){if(this.value=='Search by Keyword...')this.value='';})
.blur(function(){if(this.value=='')this.value='Search by Keyword...';});$('#topJobCity')
.focus(function(){if(this.value=='Enter a City')this.value='';})
.blur(function(){if(this.value=='')this.value='Enter a City';});$('#carszip')
.focus(function(){if(this.value=='Zip Code')this.value='';})
.blur(function(){if(this.value=='')this.value='Zip Code';});$('#homeszip')
.focus(function(){if(this.value=='City or Zip')this.value='';})
.blur(function(){if(this.value=='')this.value='City or Zip';});$('#homes_location')
.focus(function(){if(this.value=='City, State, or Zip')this.value='';})
.blur(function(){if(this.value=='')this.value='City, State, or Zip';});$('.widget.homes .home_carousel .prev').click(function(){var home_array=$(this).parent().parent().children('.homefinder_home');if(home_array.length>1){var current_home=0;home_array.each(function(index){if($(this).css('display')==='block'){current_home=index;}});if(current_home===0){home_array.last().css('display','block');}
else{home_array.eq(current_home-1).css('display','block');}
home_array.eq(current_home).css('display','none');}
return false;});$('.widget.homes .home_carousel .next').click(function(){var home_array=$(this).parent().parent().children('.homefinder_home');if(home_array.length>1){var current_home=0;home_array.each(function(index){if($(this).css('display')==='block'){current_home=index;}});if(current_home===home_array.length-1){home_array.first().css('display','block');}
else{home_array.eq(current_home+1).css('display','block');}
home_array.eq(current_home).css('display','none');}
return false;});$("#price_range").change(function(){var value=$(this).val();set_min_max(value);});function equal_block_height(parent_container,target_element,target_class){var parent_height=parent_container.height();var equal_height=60;var has_target_class=false;parent_container.each(function(){$(this).children(target_element).each(function(){equal_height=($(this).height()>equal_height)?$(this).height():equal_height;});});parent_container.children(target_element).height(equal_height);if(has_target_class){parent_container.children(target_element+":first").css('border-right','1px solid #CCC');}}
var parent_container=$('div#main #highlights.two');equal_block_height(parent_container,'article','no_figure');var parent_container=$('#main #buyingCar');equal_block_height(parent_container,'div.column','.column');var parent_container=$('#main #livingHere');equal_block_height(parent_container,'div.column','.column');var parent_container=$('#big_story .big');var target_elements=$('#big_story .details li');var remainder_element=$('#big_story .details li:last-child');var border_size=0;padding(parent_container,target_elements,remainder_element,border_size,true);$('.pagination').each(function(){$(this).parent('section').css('margin-bottom','40px');});function getItemsState(block_item){var columns=[];$(block_item+' div.sortable-list').each(function(){var classAttr=[];$(this).children().each(function(){if($(this).attr('id')){classAttr.push($(this).attr('id')+'-'+$(this).attr('class'));}});columns.push(classAttr);});return columns.join('|');}
function setItemState(block_item){var cookieArr=[];var classAttr=$(block_item).attr('class');if($.cookie('mipanelState0612'))
{var cookie_content=$.cookie('mipanelState0612').split(",");}else{var cookie_content=[];}
var section_is_set=0;for(var item in cookie_content){var panelIdClassPair=cookie_content[item].split("-");var panelId=panelIdClassPair[0];section_is_set=(panelId==$(block_item).attr('id'))?1:section_is_set;var item_array=new Array(panelId);if(panelId==$(block_item).attr('id'))
{item_array.push(classAttr);}
else
{item_array.push(panelIdClassPair[1]);}
cookieArr.push(item_array.join("-"));}
var new_cookie=cookieArr.join(",");if(!$.cookie('mipanelState0612'))
{new_cookie=$(block_item).attr('id')+"-"+classAttr;}else if(!section_is_set){new_cookie+=","+$(block_item).attr('id')+"-"+classAttr;}
return new_cookie;}
function restoreState(cookie_name){var cookie=$.cookie(cookie_name);if(!cookie)return;var columns=cookie.split('|');for(var c in columns){var idClass=columns[c].split(",");for(var i=0,n=idClass.length;i<n;i++){var itemclassID=idClass[i];var itemclassID_split=itemclassID.split('-');if(itemclassID_split[0]){$('#'+itemclassID_split[0]).removeClass();$('#'+itemclassID_split[0]).addClass(itemclassID_split[1]);}}}}
$('#detail_page .aside .factbox li').children().each(function(index){if($(this).outerWidth()>300){$(this).parent().css({'overflow-x':'scroll'});}});if(typeof(section_id_path)!=='undefined'){$('#section').mi_section_ajax({section_id_path:section_id_path,exclude:exclude_stories,blog:(typeof(blog)!=='undefined')?blog:0});}
});function resizeIframeToFitContent(iframe){iframe.style.height=iframe.contentWindow.document.body.scrollHeight+30+'px';}
(function(b){b.tools=b.tools||{};b.tools.scrollable={version:"1.1.2",conf:{size:5,vertical:false,speed:400,keyboard:true,keyboardSteps:null,disabledClass:"disabled",hoverClass:null,clickable:true,activeClass:"active",easing:"swing",loop:false,items:".items",item:null,prev:".prev",next:".next",prevPage:".prevPage",nextPage:".nextPage",api:false}};var c;function a(o,m){var r=this,p=b(this),d=!m.vertical,e=o.children(),k=0,i;if(!c){c=r}b.each(m,function(s,t){if(b.isFunction(t)){p.bind(s,t)}});if(e.length>1){e=b(m.items,o)}function l(t){var s=b(t);return m.globalNav?s:o.parent().find(t)}o.data("finder",l);var f=l(m.prev),h=l(m.next),g=l(m.prevPage),n=l(m.nextPage);b.extend(r,{getIndex:function(){return k},getClickIndex:function(){var s=r.getItems();return s.index(s.filter("."+m.activeClass))},getConf:function(){return m},getSize:function(){return r.getItems().size()},getPageAmount:function(){return Math.ceil(this.getSize()/m.size)},getPageIndex:function(){return Math.ceil(k/m.size)},getNaviButtons:function(){return f.add(h).add(g).add(n)},getRoot:function(){return o},getItemWrap:function(){return e},getItems:function(){return e.children(m.item)},getVisibleItems:function(){return r.getItems().slice(k,k+m.size)},seekTo:function(s,w,t){if(s<0){s=0}if(k===s){return r}if(b.isFunction(w)){t=w}if(s>r.getSize()-m.size){return m.loop?r.begin():this.end()}var u=r.getItems().eq(s);if(!u.length){return r}var v=b.Event("onBeforeSeek");p.trigger(v,[s]);if(v.isDefaultPrevented()){return r}if(w===undefined||b.isFunction(w)){w=m.speed}function x(){if(t){t.call(r,s)}p.trigger("onSeek",[s])}if(d){e.animate({left:-u.position().left},w,m.easing,x)}else{e.animate({top:-u.position().top},w,m.easing,x)}c=r;k=s;v=b.Event("onStart");p.trigger(v,[s]);if(v.isDefaultPrevented()){return r}f.add(g).toggleClass(m.disabledClass,s===0);h.add(n).toggleClass(m.disabledClass,s>=r.getSize()-m.size);return r},move:function(u,t,s){i=u>0;return this.seekTo(k+u,t,s)},next:function(t,s){return this.move(1,t,s)},prev:function(t,s){return this.move(-1,t,s)},movePage:function(w,v,u){i=w>0;var s=m.size*w;var t=k%m.size;if(t>0){s+=(w>0?-t:m.size-t)}return this.move(s,v,u)},prevPage:function(t,s){return this.movePage(-1,t,s)},nextPage:function(t,s){return this.movePage(1,t,s)},setPage:function(t,u,s){return this.seekTo(t*m.size,u,s)},begin:function(t,s){i=false;return this.seekTo(0,t,s)},end:function(t,s){i=true;var u=this.getSize()-m.size;return u>0?this.seekTo(u,t,s):r},reload:function(){p.trigger("onReload");return r},focus:function(){c=r;return r},click:function(u){var v=r.getItems().eq(u),s=m.activeClass,t=m.size;if(u<0||u>=r.getSize()){return r}if(t==1){if(m.loop){return r.next()}if(u===0||u==r.getSize()-1){i=(i===undefined)?true:!i}return i===false?r.prev():r.next()}if(t==2){if(u==k){u--}r.getItems().removeClass(s);v.addClass(s);return r.seekTo(u,time,fn)}if(!v.hasClass(s)){r.getItems().removeClass(s);v.addClass(s);var x=Math.floor(t/2);var w=u-x;if(w>r.getSize()-t){w=r.getSize()-t}if(w!==u){return r.seekTo(w)}}return r},bind:function(s,t){p.bind(s,t);return r},unbind:function(s){p.unbind(s);return r}});b.each("onBeforeSeek,onStart,onSeek,onReload".split(","),function(s,t){r[t]=function(u){return r.bind(t,u)}});f.addClass(m.disabledClass).click(function(){r.prev()});h.click(function(){r.next()});n.click(function(){r.nextPage()});if(r.getSize()<m.size){h.add(n).addClass(m.disabledClass)}g.addClass(m.disabledClass).click(function(){r.prevPage()});var j=m.hoverClass,q="keydown."+Math.random().toString().substring(10);r.onReload(function(){if(j){r.getItems().hover(function(){b(this).addClass(j)},function(){b(this).removeClass(j)})}if(m.clickable){r.getItems().each(function(s){b(this).unbind("click.scrollable").bind("click.scrollable",function(t){if(b(t.target).is("a")){return}return r.click(s)})})}if(m.keyboard){b(document).unbind(q).bind(q,function(t){if(t.altKey||t.ctrlKey){return}if(m.keyboard!="static"&&c!=r){return}var u=m.keyboardSteps;if(d&&(t.keyCode==37||t.keyCode==39)){r.move(t.keyCode==37?-u:u);return t.preventDefault()}if(!d&&(t.keyCode==38||t.keyCode==40)){r.move(t.keyCode==38?-u:u);return t.preventDefault()}return true})}else{b(document).unbind(q)}});r.reload()}b.fn.scrollable=function(d){var e=this.eq(typeof d=="number"?d:0).data("scrollable");if(e){return e}var f=b.extend({},b.tools.scrollable.conf);d=b.extend(f,d);d.keyboardSteps=d.keyboardSteps||d.size;this.each(function(){e=new a(b(this),d);b(this).data("scrollable",e)});return d.api?e:this}})(jQuery);(function(b){var a=b.tools.scrollable;a.plugins=a.plugins||{};a.plugins.circular={version:"0.5.1",conf:{api:false,clonedClass:"cloned"}};b.fn.circular=function(e){var d=b.extend({},a.plugins.circular.conf),c;b.extend(d,e);this.each(function(){var i=b(this).scrollable(),n=i.getItems(),k=i.getConf(),f=i.getItemWrap(),j=0;if(i){c=i}if(n.length<k.size){return false}n.slice(0,k.size).each(function(o){b(this).clone().appendTo(f).click(function(){i.click(n.length+o)}).addClass(d.clonedClass)});var l=b.makeArray(n.slice(-k.size)).reverse();b(l).each(function(o){b(this).clone().prependTo(f).click(function(){i.click(-o-1)}).addClass(d.clonedClass)});var m=f.children(k.item);var h=k.hoverClass;if(h){m.hover(function(){b(this).addClass(h)},function(){b(this).removeClass(h)})}function g(o){var p=m.eq(o);if(k.vertical){f.css({top:-p.position().top})}else{f.css({left:-p.position().left})}}g(k.size);b.extend(i,{move:function(s,r,p,q){var u=j+s+k.size;var t=u>i.getSize()-k.size;if(u<=0||t){var o=j+k.size+(t?-n.length:n.length);g(o);u=o+s}if(q){m.removeClass(k.activeClass).eq(u+Math.floor(k.size/2)).addClass(k.activeClass)}if(u===j+k.size){return self}return i.seekTo(u,r,p)},begin:function(p,o){return this.seekTo(k.size,p,o)},end:function(p,o){return this.seekTo(n.length,p,o)},click:function(p,r,q){if(!k.clickable){return self}if(k.size==1){return this.next()}var s=p-j,o=k.activeClass;s-=Math.floor(k.size/2);return this.move(s,r,q,true)},getIndex:function(){return j},setPage:function(p,q,o){return this.seekTo(p*k.size+k.size,q,o)},getPageAmount:function(){return Math.ceil(n.length/k.size)},getPageIndex:function(){if(j<0){return this.getPageAmount()-1}if(j>=n.length){return 0}var o=(j+k.size)/k.size-1;return o},getVisibleItems:function(){var o=j+k.size;return m.slice(o,o+k.size)}});i.onStart(function(p,o){j=o-k.size;return false});i.getNaviButtons().removeClass(k.disabledClass)});return d.api?c:this}})(jQuery);(function(b){var a=b.tools.scrollable;a.plugins=a.plugins||{};a.plugins.navigator={version:"1.0.2",conf:{navi:".navi",naviItem:null,activeClass:"active",indexed:false,api:false,idPrefix:null}};b.fn.navigator=function(d){var e=b.extend({},a.plugins.navigator.conf),c;if(typeof d=="string"){d={navi:d}}d=b.extend(e,d);this.each(function(){var i=b(this).scrollable(),f=i.getRoot(),l=f.data("finder").call(null,d.navi),g=null,k=i.getNaviButtons();if(i){c=i}i.getNaviButtons=function(){return k.add(l)};function j(){if(!l.children().length||l.data("navi")==i){l.empty();l.data("navi",i);for(var m=0;m<i.getPageAmount();m++){l.append(b("<"+(d.naviItem||"a")+"/>"))}g=l.children().each(function(n){var o=b(this);o.click(function(p){i.setPage(n);return p.preventDefault()});if(d.indexed){o.text(n)}if(d.idPrefix){o.attr("id",d.idPrefix+n)}})}else{g=d.naviItem?l.find(d.naviItem):l.children();g.each(function(n){var o=b(this);o.click(function(p){i.setPage(n);return p.preventDefault()})})}g.eq(0).addClass(d.activeClass)}i.onStart(function(o,n){var m=d.activeClass;g.removeClass(m).eq(i.getPageIndex()).addClass(m)});i.onReload(function(){j()});j();var h=g.filter("[href="+location.hash+"]");if(h.length){i.move(g.index(h))}});return d.api?c:this}})(jQuery);(function(b){b.tools=b.tools||{};b.tools.expose={version:"1.0.5",conf:{maskId:null,loadSpeed:"slow",closeSpeed:"fast",closeOnClick:true,closeOnEsc:true,zIndex:9998,opacity:0.8,color:"#456",api:false}};function a(){if(b.browser.msie){var f=b(document).height(),e=b(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,f-e<20?e:f]}return[b(window).width(),b(document).height()]}function c(h,g){var e=this,j=b(this),d=null,f=false,i=0;b.each(g,function(k,l){if(b.isFunction(l)){j.bind(k,l)}});b(window).resize(function(){e.fit()});b.extend(this,{getMask:function(){return d},getExposed:function(){return h},getConf:function(){return g},isLoaded:function(){return f},load:function(n){if(f){return e}i=h.eq(0).css("zIndex");if(g.maskId){d=b("#"+g.maskId)}if(!d||!d.length){var l=a();d=b("<div/>").css({position:"absolute",top:0,left:0,width:l[0],height:l[1],display:"none",opacity:0,zIndex:g.zIndex});if(g.maskId){d.attr("id",g.maskId)}b("body").append(d);var k=d.css("backgroundColor");if(!k||k=="transparent"||k=="rgba(0, 0, 0, 0)"){d.css("backgroundColor",g.color)}if(g.closeOnEsc){b(document).bind("keydown.unexpose",function(o){if(o.keyCode==27){e.close()}})}if(g.closeOnClick){d.bind("click.unexpose",function(o){e.close(o)})}}n=n||b.Event();n.type="onBeforeLoad";j.trigger(n);if(n.isDefaultPrevented()){return e}b.each(h,function(){var o=b(this);if(!/relative|absolute|fixed/i.test(o.css("position"))){o.css("position","relative")}});h.css({zIndex:Math.max(g.zIndex+1,i=="auto"?0:i)});var m=d.height();if(!this.isLoaded()){d.css({opacity:0,display:"block"}).fadeTo(g.loadSpeed,g.opacity,function(){if(d.height()!=m){d.css("height",m)}n.type="onLoad";j.trigger(n)})}f=true;return e},close:function(k){if(!f){return e}k=k||b.Event();k.type="onBeforeClose";j.trigger(k);if(k.isDefaultPrevented()){return e}d.fadeOut(g.closeSpeed,function(){k.type="onClose";j.trigger(k);h.css({zIndex:b.browser.msie?i:null})});f=false;return e},fit:function(){if(d){var k=a();d.css({width:k[0],height:k[1]})}},bind:function(k,l){j.bind(k,l);return e},unbind:function(k){j.unbind(k);return e}});b.each("onBeforeLoad,onLoad,onBeforeClose,onClose".split(","),function(k,l){e[l]=function(m){return e.bind(l,m)}})}b.fn.expose=function(d){var e=this.eq(typeof d=="number"?d:0).data("expose");if(e){return e}if(typeof d=="string"){d={color:d}}var f=b.extend({},b.tools.expose.conf);d=b.extend(f,d);this.each(function(){e=new c(b(this),d);b(this).data("expose",e)});return d.api?e:this}})(jQuery);function css_browser_selector(u){var ua=u.toLowerCase(),is=function(t){return ua.indexOf(t)>-1;},g='gecko',w='webkit',s='safari',o='opera',h=document.getElementsByTagName('html')[0],b=[(!(/opera|webtv/i.test(ua))&&/msie\s(\d)/.test(ua))?('ie ie'+RegExp.$1):is('firefox/2')?g+' ff2':is('firefox/3.5')?g+' ff3 ff3_5':is('firefox/3')?g+' ff3':is('gecko/')?g:is('opera')?o+(/version\/(\d+)/.test(ua)?' '+o+RegExp.$1:(/opera(\s|\/)(\d+)/.test(ua)?' '+o+RegExp.$2:'')):is('konqueror')?'konqueror':is('chrome')?w+' chrome':is('iron')?w+' iron':is('applewebkit/')?w+' '+s+(/version\/(\d+)/.test(ua)?' '+s+RegExp.$1:''):is('mozilla/')?g:'',is('j2me')?'mobile':is('iphone')?'iphone':is('ipod')?'ipod':is('mac')?'mac':is('darwin')?'mac':is('webtv')?'webtv':is('win')?'win':is('freebsd')?'freebsd':(is('x11')||is('linux'))?'linux':'','js'];c=b.join(' ');h.className+=' '+c;return c;};css_browser_selector(navigator.userAgent);(function($){var MAX_POSTS_COUNT=50;var SectionAjax=function(options,container){this.exclude=options.exclude;this.section_id_path=options.section_id_path;this.blog=options.blog;if(this.blog){this.more_posts_count=3;}
else{this.more_posts_count=10;}
this.container=container;var actual=this.posts_loaded();var expected=this.expected_posts();if(actual<expected){this.refresh(expected);}
if(actual>=MAX_POSTS_COUNT){this.container.find('.more_button').hide();}
this.container.find('.more_button').bind('click',$.proxy(this,'show_more'));};SectionAjax.prototype.refresh=function(posts){this.fetch(0,posts,function(snippet){$('#main_story_list').html(snippet.html());});};SectionAjax.prototype.show_more=function(){var posts=this.posts_loaded();var more=posts+this.more_posts_count>MAX_POSTS_COUNT?MAX_POSTS_COUNT-posts:this.more_posts_count;this.save_post_count(posts+more);this.fetch(posts,more,function(snippet){$('#main_story_list').append(snippet.html());});};SectionAjax.prototype.fetch=function(start_index,posts,callback){$.ajax({dataType:'html',url:this.build_request(start_index,posts),success:function(data){if($.isFunction(callback)){var snippet=$('<div/>').html(data);callback(snippet);if(snippet.find('li.article').length<posts||start_index+posts>=MAX_POSTS_COUNT){$('#section .more_button').hide();}
else{$('#section .more_button').show();}}}});};SectionAjax.prototype.build_request=function(start_index,posts){var ajax_string="/miajax/section"+section_id_path+"?start="+start_index+
"&posts="+posts+"&asset_filter="+this.exclude+(this.blog?"&blog=1":"");return ajax_string;};SectionAjax.prototype.posts_loaded=function(){return $('#main_story_list li').length;};SectionAjax.prototype.save_post_count=function(posts){var cookie=this.parse_post_count_cookie();cookie[section_id_path]=posts;var entries=[]
$.each(cookie,function(key,value){entries.push([key,value].join('='));});$.cookie('post_count',entries.join(';'),{expires:0.5/24,path:'/'});};SectionAjax.prototype.parse_post_count_cookie=function(){var parsed={};var raw=$.cookie('post_count');if(raw){$.each(raw.split(';'),function(i,entry){var split=entry.split('=');parsed[split[0]]=split[1];});}
return parsed;};SectionAjax.prototype.expected_posts=function(){var post_counts=this.parse_post_count_cookie();var expected_posts=parseInt(post_counts[section_id_path],10);if(isNaN(expected_posts)){expected_posts=this.posts_loaded();}
return expected_posts;};$.fn.mi_section_ajax=function(settings){var _settings=$.extend({exclude:"",section_id_path:"",blog:""},settings);this.each(function(){new SectionAjax(_settings,$(this));});};})(jQuery);(function($){function show_image(container,index){var settings=container.data('mi_gallery');container.find('.count .current').html(index+1);var scroller=container.find('.scrollable').data('scrollable');if(index<scroller.getIndex()||index>scroller.getIndex()+scroller.getConf().size){scroller.seekTo(index,300);}
var thumb=container.find('.thumb:eq('+index+')');var url=thumb.find('a').attr('href');var alt_text=thumb.find('a img').attr('alt');current(container).removeClass('current');thumb.addClass('current');container.find('.photo img').fadeOut(function(){container.find('.photo').css('height',$(this).height());$(this).remove();$('<img/>').load(function(){$(this).hide();container.find('#photo_container')
.html('')
.append(this)
.parent().css('height','auto');scale($(this),settings.max_image_width);$(this).fadeIn();container.triggerHandler('mi_gallery_on_image_change',{container:container,index:index,thumb:thumb});})
.attr('src',url)
.attr('alt',alt_text)
.css('display','inline');});var caption=thumb.find('a img').attr('data-caption');container.find('.caption').fadeOut(function(){$(this).html('').append(caption).fadeIn();container.triggerHandler('mi_gallery_on_caption_change',{container:container,index:index,thumb:thumb});});fix_buttons(container);}
function scale(image,max_width){var width=image.width();var height=image.height();if(width>max_width){var ratio=width/height;width=max_width;height=width/ratio;}
image.attr('width',width);image.attr('height',height);}
function thumbs(container){return container.find('.thumb');}
function current(container){return container.find('.thumb.current');}
function current_index(container){return thumbs(container).index(current(container));}
function is_last(container,index){return index>=thumbs(container).length-1;}
function is_first(container,index){return index<=0;}
function fix_buttons(container){var left=container.find('.photo_left');var right=container.find('.photo_right');var index=thumbs(container).index(current(container));if(is_first(container,index)){left.addClass('disabled');}
else{left.removeClass('disabled');}
if(is_last(container,index)){right.addClass('disabled');}
else{right.removeClass('disabled');}}
$.fn.mi_gallery=function(_settings){var settings={max_image_width:532};$.extend(settings,_settings);this.each(function(){var container=$(this);container.data('mi_gallery',settings);container.find('.photo img').load(function(){scale($(this),settings.max_image_width);});fix_buttons(container);container.find('.thumb a').bind('click',{container:container},function(event){var container=event.data.container;var index=thumbs(container).index($(this).parent());show_image(container,index);return false;});container.find('.photo_left').bind('click',{container:container},function(event){var container=event.data.container;var index=current_index(container);if(!is_first(container,index)){show_image(container,index-1);}
return false;});container.find('.photo_right').bind('click',{container:container},function(event){var container=event.data.container;var index=current_index(container);if(!is_last(container,index)){show_image(container,index+1);}
return false;});if($.isFunction(settings.on_caption_change)){container.bind('mi_gallery_on_caption_change',settings.on_caption_change);}
if($.isFunction(settings.on_image_change)){container.bind('mi_gallery_on_image_change',settings.on_image_change);}});};})(jQuery);var mi=(typeof mi=='undefined')?{'media_domain':''}:mi;if(window.miAppControler){mi.control=new miAppControler();}
mi.getArgs=function(){if(typeof mi.args=='undefined'){mi.args={};var query=location.search.substring(1);var pairs=query.split('&');for(var i=pairs.length-1;i>=0;i--){var pos=pairs[i].indexOf('=');if(pos==-1){continue;}
mi.args[pairs[i].substring(0,pos)]=unescape(pairs[i].substring(pos+1));}}
return mi.args;};mi._console=function(s){mi._console.log=(mi._console.log&&mi._console.log.length>0)?mi._console.log+'\n---------------------------------------------------\n'+s:s;};mi.fixConsole=function(){if(typeof window.console!="object"){window.console={};}
if(window.console.is_fixed){}
else{var firebugMethods=["log","debug","info","warn","error","assert","dir","dirxml","trace","group","groupEnd","time","timeEnd","profile","profileEnd","count"];var methodCount=firebugMethods.length;var args=mi.getArgs();var view=(args.viewlog&&args.viewlog=='1');for(var i=0;i<methodCount;i++){var methodName=firebugMethods[i];if(typeof window.console[methodName]!="function"){switch(methodName){case'log':if(view){window.console.log=mi._console;if(window.addEventListener){window.addEventListener("load",function(){alert(mi._console.log);},false);}else if(window.attachEvent){window.attachEvent("onload",function(){alert(mi._console.log);});}}else{window.console.log=function(){};}
break;default:eval("window.console[methodName] = function(s){window.console.log('"+methodName.toUpperCase()+": '+ s)};");}}}}
window.console.is_fixed=true;};mi.fixConsole();mi.cloneObject=function(sourceObj){if(sourceObj==null||typeof sourceObj!='object'){return sourceObj;}
var temp=new sourceObj.constructor();for(var key in sourceObj){temp[key]=mi.cloneObject(sourceObj[key]);}
return temp;};mi.App=function(){var _configs={};this._manageConf=function(prop,val){return val;};this.setConf=function(){switch(arguments.length){case 1:for(var prop in arguments[0]){_configs[prop]=this._manageConf(prop,arguments[0][prop]);}
break;case 2:_configs[arguments[0]]=this._manageConf(arguments[0],arguments[1]);break;default:console.warn('mi.App.setConf was passed an incorrect number of arguments, the method should be used with either a name-value pair or an object containing configuration settings.');}};this.getConf=function(prop){return _configs[prop];};this.viewConfs=function(){console.dir(_configs);};this.cache={};switch(arguments.length){case 1:this.setConf(arguments[0]);break;case 2:this.setConf(arguments[0],arguments[1]);break;}};mi.getEventSrc=function(e){if(!e){e=window.event;}
if(e.target){return e.target;}else if(e.srcElement){return e.srcElement;}};mi.templateVarPattern=/\@([^\@]+)\@/g;mi.templateParser=function(data,template){return template.replace(mi.templateVarPattern,function(){return data[arguments[1]];})};mi.makeHash=function(sourceData,firstDelimiter,secondDelimiter){if(sourceData&&firstDelimiter&&secondDelimiter){var hash={};var pairs=sourceData.split(firstDelimiter);var pos;for(var i=pairs.length-1;i>=0;i--){if(typeof(pairs[i+1])!='undefined'){pos=pairs[i].indexOf(secondDelimiter);if(pos==-1){continue;}
hash[pairs[i].substring(0,pos)]=pairs[i].substring(pos+1);}}
return hash;}
else{console.log('sourceData, firstDelimiter, & secondDelimiter must be defined. There are no default values.');}};mi.loadPageInfo=function(){if(window.pageInfo){var pi=window.pageInfo;if(this.pageInfo==undefined){this.pageInfo=this.cloneObject(pi);}else{for(var key in pi){if(key==='version'&&(parseFloat(pi[key])>parseFloat(this.pageInfo.version))){this.pageInfo.version=pi[key];}else if(this.pageInfo[key]==undefined){this.pageInfo[key]=this.cloneObject(pi[key]);}else if(typeof this.pageInfo[key]=='object'){for(var key2 in pi[key]){this.pageInfo[key][key2]=(this.pageInfo[key][key2])?this.pageInfo[key][key2]:this.cloneObject(pi[key][key2]);}}}}}
window.pageInfo=null;}
mi.wait_for_ready=function(time,target,callback){var checker,time_spent=0,interval=3000;_check_document=function(){if(null!==$(target)){clearInterval(checker);callback();}else{time_spent+=interval/1000;if(time_spent>=time){clearInterval(checker);}}};$(document).ready(function(){checker=setInterval(_check_document,interval);});};var mi=(!mi)?{'media_domain':''}:mi;mi.Cookie=function(document,name,minutes,path,domain,secure){this.$document=(document)?document:window.document;this.$name=(name)?name:'cookie';this.$expiration=(minutes)?new Date((new Date()).getTime()+minutes*60000):null;this.$path=(path)?path:null;this.$domain=(domain)?domain:null;this.$secure=(secure)?true:false;};mi.Cookie.prototype.store=function(){var cookieVal="";for(var prop in this){if((prop.charAt(0)=='$')||((typeof this[prop])=='function')){continue;}
if(cookieVal!==""){cookieVal+='&';}
cookieVal+=prop+':'+escape(this[prop]);}
var cookie=this.$name+'='+cookieVal;cookie+=(this.$expiration)?'; expires='+this.$expiration.toGMTString():'';cookie+=(this.$path)?'; path='+this.$path:'';cookie+=(this.$domain)?'; domain='+this.$domain:'';cookie+=(this.$secure)?'; secure':'';this.$document.cookie=cookie;};mi.Cookie.prototype.load=function(){var allCookies=this.$document.cookie;if(allCookies===""){return false;}
var start=allCookies.indexOf(this.$name+'=');if(start==-1){return false;}
start+=this.$name.length+1;var end=allCookies.indexOf(';',start);if(end==-1){end=allCookies.length;}
var cookieVal=allCookies.substring(start,end);var a=cookieVal.split('&');if((a.length==1)&&(a[0].indexOf(':')==-1)){var prop=this.$name;this[prop]=unescape(cookieVal.replace(/\+/g,'%20'));return true;}
for(var i=0;i<a.length;i++){a[i]=a[i].split(':');}
for(i=0;i<a.length;i++){this[a[i][0]]=unescape(a[i][1]);}
return true;};mi.Cookie.prototype.remove=function(){var cookie=this.$name+'=';cookie+=(this.$path)?'; path='+this.$path:'';cookie+=(this.$domain)?'; domain='+this.$domain:'';cookie+='; expires=Fri, 02-Jan-1970 00:00:00 GMT';this.$document.cookie=cookie;};mi.Commenting=function(){mi.App.apply(this,arguments);this._manageConf=function(prop,val){switch(prop){case'enabled':var v=parseInt(val);if(isNaN(v)){val=(val.toLowerCase)?val.toLowerCase():val;switch(val){case true:case'true':case'yes':case'on':v=1;break;default:v=0;break;}}
val=v;default:break;}
return val;};if(mi.control&&mi.control.commenting!=undefined){this.setConf('enabled',mi.control.commenting);}else{this.setConf('enabled',0);console.warn('Commenting has been instantiated, but disabled because mi.control.commenting is not defined.');}
mi.loadPageInfo();var splitHost=window.location.host.split('.');this.setConf('accountName',splitHost[splitHost.length-2]);this.setConf('target','commentingStage');this.finish();};mi.Commenting.prototype.finish=function(){};mi.Commenting.prototype.display=function(){if(window.gomez&&window.gomez.startInterval){window.gomez.startInterval('display commenting');}
var e=this.getConf('enabled');if(e!==0&&e!==2){this._renderCommenting();}else{console.info('Submission and display of comments has been disabled.');}
if(window.gomez&&window.gomez.endInterval){window.gomez.endInterval('display commenting');}};mi.Commenting.prototype.displayPopular=function(count){if(window.gomez&&window.gomez.startInterval){window.gomez.startInterval('popular comment threads');}
var e=this.getConf('enabled');if(e!==0&&e!==3&&e!==4){this._displayPopular(count);}else{console.info('The popular comment threads widget has been disabled.');}
if(window.gomez&&window.gomez.endInterval){window.gomez.endInterval('popular comment threads');}};mi.Commenting.prototype.displayCommentCount=function(){if(window.gomez&&window.gomez.startInterval){window.gomez.startInterval('comment count');}
var e=this.getConf('enabled');if(e!==0&&e!==2){this._displayCommentCount();}else{console.info('Submission and display of comments has been disabled.');}
if(window.gomez&&window.gomez.endInterval){window.gomez.endInterval('comment count');}}
mi.Commenting.prototype.extended=true;mi.Commenting.prototype._displayCommentingFacebook=function(){if(this._createFBRoot()&&this._createFBMetaTag()&&this._createFBTarget()&&this._createAsyncCall()){return true;}
else{console.error("One or more methods failed to implement Facebook Commenting. Facebook Commenting has been disabled.");return false;}};mi.Commenting.prototype._renderCommenting=mi.Commenting.prototype._displayCommentingFacebook;mi.Commenting.prototype._createAsyncCall=function(){var first_script=document.getElementsByTagName("script")[0];js=document.createElement("script");js.id="facebook-jssdk";js.src="http://connect.facebook.net/en_US/all.js#xfbml=1&appId="+this.getConf("fbapp_id");js.type="text/javascript";first_script.parentNode.insertBefore(js,first_script);return true;};mi.Commenting.prototype._createFBRoot=function(){var fb_root=document.createElement("div");fb_root.id="fb-root";$("body").prepend(fb_root);return true;};mi.Commenting.prototype._createFBMetaTag=function(){var fb_meta=document.createElement("meta");var first_script=document.getElementsByTagName("script")[0];var fbapp_id=this.getConf("fbapp_id");fb_meta.setAttribute("property","fb:app_id");if(fbapp_id){fb_meta.content=this.getConf("fbapp_id");first_script.parentNode.insertBefore(fb_meta,first_script);return true;}
else{this.setConf("enabled",0);console.error("Facebook Commenting has been disabled due to an unconfigured fbapp_id.");return false;}};mi.Commenting.prototype._createFBTarget=function(){var href="http://"+window.location.host+window.location.pathname;var assoc_url=/(\/\d{4}\/\d{2}\/\d{2}\/\d+)_/;href=href.replace(assoc_url,"$1/");var fb_target=document.createElement("div");var target=document.getElementById(this.getConf("target"));var fb_target_attr=mi.commenting.getConf("fb_comment_div");fb_target.className="fb-comments";fb_target.setAttribute("data-href",href);(fb_target_attr&&fb_target_attr["data-width"])?fb_target.setAttribute("data-width",fb_target_attr["data-width"]):fb_target.setAttribute("data-width","620");(fb_target_attr&&fb_target_attr["data-num-posts"])?fb_target.setAttribute("data-num-posts",fb_target_attr["data-num-posts"]):fb_target.setAttribute("data-num-posts","10");if(fb_target_attr&&fb_target_attr["data-colorscheme"]=="dark"){fb_target.setAttribute("data-colorscheme",fb_target_attr["data-colorscheme"]);}
target.appendChild(fb_target);return true;};mi.Commenting.prototype._displayCommentCountFacebook=function(){var href="http://"+window.location.host+window.location.pathname;var cc_config=mi.commenting.getConf("cc_iframe");var cc_iframe=document.createElement("iframe");var fb_comments=jQuery(".fb-comments")[0];cc_iframe.src="http://www.facebook.com/plugins/comments.php?href="+href+"&permalink=1";cc_iframe.scrolling="no";cc_iframe.setAttribute("frameBorder","0");cc_iframe.style.overflow="hidden";(cc_config&&cc_config.width)?cc_iframe.width=cc_config.width:cc_iframe.width="130";(cc_config&&cc_config.height)?cc_iframe.height=cc_config.height:cc_iframe.height="16";if(fb_comments){fb_comments.parentNode.insertBefore(cc_iframe,fb_comments);return true;}
else{return false;}};mi.Commenting.prototype._displayCommentCount=mi.Commenting.prototype._displayCommentCountFacebook;function miLoadWriter(){}
mi.Loader=function(){mi.App.apply(this,arguments);this.preLoads=new Array();this.postLoads=new Array();this.onloads=new Array();this.contents=new Array();this.targets=new Array();this.loadBacks=new Array();this.writeModes=new Array();this.intIds=new Array();this.moveAttempts=new Array();this.isLateLoad=new Array();this.lastSuccess=false;this.contentCount=0;this.loaderOn=true;}
mi.Loader.prototype.getIndexContent=function(contentIndex)
{if(contentIndex>=0&&contentIndex<this.contents.length){return this.contents[contentIndex]+"";}
else{return'';}}
mi.Loader.prototype.getIndexPreload=function(contentIndex)
{if(contentIndex>=0&&contentIndex<this.preLoads.length){return this.preLoads[contentIndex]+"";}
else{return'';}}
mi.Loader.prototype.getIndexPostload=function(contentIndex)
{if(contentIndex>=0&&contentIndex<this.postLoads.length){return this.postLoads[contentIndex]+"";}
else{return'';}}
mi.Loader.prototype.defaultContent=function(targetId)
{var curIndex=this.contentCount+0;this.contentCount++;this.targets[curIndex]=targetId;this.loadBacks[curIndex]=false;this.preLoads[curIndex]='';this.postLoads[curIndex]='';this.onloads[curIndex]='';this.contents[curIndex]='';return curIndex;}
mi.Loader.prototype.lateLoadMove=function(sourceId,targetId)
{var curIndex=this.defaultContent(targetId);if(!(this.loaderOn)){return false;}
this.lastSuccess=false;this.lastSuccess=this.moveDivAppend(sourceId,targetId);return this.lastSuccess;}
mi.Loader.prototype.storeContent=function(content,writeMode)
{if(this.loaderOn==false){if(writeMode==1){document.write(content);}
else{document.write('<scr'+'ipt>'+content+'</scr'+'ipt>');}
return;}
var curIndex=this.contentCount+0;this.contentCount++;this.loadBacks[curIndex]=false;this.onloads[curIndex]='';this.preLoads[curIndex]='';this.postLoads[curIndex]='';this.writeModes[curIndex]=writeMode;this.intIds[curIndex]="";this.moveAttempts[curIndex]=0;this.isLateLoad[curIndex]=true;document.write('<div class="mi_lateLoaderBlank" id="mi_lateLoaderBlank'+curIndex+'"></div>');var markerDiv=document.getElementById('mi_lateLoaderBlank'+curIndex);var targetDiv=markerDiv.parentNode;this.targets[curIndex]=targetDiv.id;this.contents[curIndex]=this.unescape(content);}
mi.Loader.prototype.lateLoadInsert2=function(contentIndex)
{var sourceDiv=document.getElementById("mi_lateLoaderLoad"+contentIndex);var markerDiv=document.getElementById("mi_lateLoaderBlank"+contentIndex);var targetDiv=markerDiv.parentNode;if(targetDiv!=null&&sourceDiv!=null&&markerDiv!=null){targetDiv.insertBefore(sourceDiv,markerDiv);return true;}
return false;}
mi.Loader.prototype.lateInsertAll=function(contentIndex)
{var maxContent=this.contentCount+0;for(var contentIndex=0;contentIndex<maxContent;contentIndex++){if(this.isLateLoad[contentIndex]===undefined){continue;}
if(!(this.isLateLoad[contentIndex])){continue;}
this.lateLoadInsert2(contentIndex);}}
mi.Loader.prototype.lateLoadInsertWrapper=function(contentIndex)
{if(this.lateLoadInsert(contentIndex)){return true;}
else{this.intIds[contentIndex]=setInterval("mi.loader.lateLoadInsert("+contentIndex+")",500);}
}
mi.Loader.prototype.lateLoadAppend=function(contentIndex)
{var targetId=this.targets[contentIndex];var targetDiv=document.getElementById(targetId);var sourceDiv=document.getElementById("mi_lateLoaderLoad"+contentIndex);var markerDiv=document.getElementById("mi_lateLoaderBlank"+contentIndex);if(targetDiv!=null&&sourceDiv!=null){targetDiv.appendChild(sourceDiv);return true;}
return false;}
mi.Loader.prototype.lateAppendAll=function(contentIndex)
{var maxContent=this.contentCount+0;for(var contentIndex=0;contentIndex<maxContent;contentIndex++){if(this.isLateLoad[contentIndex]===undefined){continue;}
if(!(this.isLateLoad[contentIndex])){continue;}
this.lateLoadAppend(contentIndex);}}
mi.Loader.prototype.lateWriteContent=function(contentIndex)
{var content=this.contents[contentIndex];if(this.writeModes[contentIndex]==1){document.write('<div id="mi_lateLoaderLoad'+contentIndex+'">'+content+'</div>');}
else{document.write('<div id="mi_lateLoaderLoad'+contentIndex+'"><scr'+'ipt>'+content+'</scr'+'ipt></div>');}
try{this.lateLoadInsertWrapper(contentIndex);}
catch(err){}}
mi.Loader.prototype.lateWriteContent2=function(contentIndex)
{if(this.isLateLoad[contentIndex]===undefined){return true;}
if(!(this.isLateLoad[contentIndex])){return true;}
if(contentIndex>=this.contentCount||contentIndex<0){return false;}
var content=this.contents[contentIndex];if(this.writeModes[contentIndex]==1){document.write(content);}
else{document.write('<scr'+'ipt>'+content+'</scr'+'ipt>');}
return true;}
mi.Loader.prototype.lateWriteAll=function()
{var maxContent=this.contentCount+0;for(var contentIndex=0;contentIndex<maxContent;contentIndex++){this.lateWriteContent(contentIndex);}}
mi.Loader.prototype.moveDivAppend=function(sourceDivId,targetDivId)
{var sourceDiv=document.getElementById(sourceDivId);var targetDiv=document.getElementById(targetDivId);if(sourceDiv!=null&&targetDiv!=null){targetDiv.appendChild(sourceDiv);sourceDiv.style.display='block';sourceDiv.style.width='100%';sourceDiv.style.height='100%';sourceDiv.style.border='';sourceDiv.style.padding='0px';sourceDiv.style.margin='0px';return true;}
return false;}
mi.Loader.prototype.moveSource=function(sourceDivId,targetDivId)
{var sourceDiv=document.getElementById(sourceDivId);var targetDiv=document.getElementById(targetDivId);if(sourceDiv!=null&&targetDiv!=null){var mysrc=sourceDiv.innerHTML+"";sourceDiv.innerHTML="";targetDiv.innerHTML=mysrc+"";return true;}
return false;}
mi.Loader.prototype.getContent=function()
{if(this.loadMe===undefined){return'';}
if(this.loadMe==null){return'';}
return this.unescape(this.loadMe);}
mi.Loader.prototype.unescape=function(str)
{str=str.replace(/#~~#/g,"\"");str=str.replace(/@~~@/g,"\\");str=str.replace(/_~~_/g,"\n");return str;}
mi.loader=new mi.Loader();mi.FindnSave=function(){mi.App.apply(this,arguments);if(mi.control&&mi.control.findnsave!==undefined){this.setConf("enabled",mi.control.findnsave);this.config();this.setDomainValues();}else{this.setConf("enabled",0);console.warn("FindnSave has been instantiated, but disabled because mi.control.findnsave is not defined.");}
this.firstWidget=true;};mi.FindnSave.prototype.config=function(){};mi.FindnSave.prototype.setDomainValues=function(){var self=this;self.setConf("fns_subdomain","findnsave.");var fns_domain=self.getConf("fns_domain");if(fns_domain===undefined||fns_domain===""){var splitHost=window.location.host.split(".");this.setConf("fns_domain",splitHost[splitHost.length-2]+"."+splitHost[splitHost.length-1]);}};mi.FindnSave.prototype.insertFnSDomain=function(){var self=this;var fns_class_selector=".fns_anchor";var fns_domain_link_element=document.getElementById("fns_domain_link");var fns_subdomain=self.getConf("fns_subdomain");var fns_domain=self.getConf("fns_domain");var fns_uri=jQuery(fns_class_selector).attr("href");var full_url="http://"+fns_subdomain+fns_domain;jQuery(fns_class_selector).each(function(index){var href_text=jQuery(this).attr("href");href_text=full_url+href_text;jQuery(this).attr("href",href_text);});if(fns_domain_link_element){fns_domain_link_element.innerHTML=self.getConf("fns_subdomain")+fns_domain;}};mi.FindnSave.prototype.isFirstWidget=function(){if(this.firstWidget){this.firstWidget=false;return true;}
else{return false;}};mi.DealSaver=function(){mi.App.apply(this,arguments);if(mi.control&&mi.control.dealsaver!==undefined){this.setConf("enabled",mi.control.dealsaver);}else{this.setConf("enabled",0);console.warn("DealSaver has been instantiated, but disabled because mi.control.dealsaver is not defined.");}};mi.DealSaver.prototype.executeDs=function(){var self=this;var e=self.getConf("enabled");if(e!==0){dsUrl="http://"+window.location.hostname+"/static/dealsaver/widget/dealsaver.json";jQuery.ajax({type:"GET",cache:false,dataType:"json",url:dsUrl,success:function(data){self.checkData(data);self.displayWidget(self.getConf("enabled"));},error:function(){self.setConf("enabled",0);self.displayWidget(self.getConf("enabled"));}});}
else{console.info('Display of DealSaver has been disabled.');}};mi.DealSaver.prototype.checkData=function(data){var self=this;if(data.page.deals.deal==undefined){self.setConf("enabled",0);console.warn("The DealSaver widget has been disabled because it can't find any deal information in the feed.");}else if(data.page.deals.deal.saleprice.$t<=0||data.page.deals.deal.saleprice.$t==undefined){self.setConf("enabled",2);console.warn("The DealSaver widget has been placed in PlaceHolder mode because saleprice is empty or 0.");self.distributeData(data);}else{self.distributeData(data);}}
mi.DealSaver.prototype.distributeData=function(data){var self=this;var lid=self.getConf("LID");if(lid!==undefined){var lidHash="&LID="+lid;}else{console.warn("DealSaver can't find mi.dealSaver.getConf('LID'). Disabling the LID hash tag in URLs.");var lidHash='';}
var dsvalue=data.page.deals.deal.productvalue.$t;var dsprice=data.page.deals.deal.saleprice.$t;var dollarsoff=(dsvalue-dsprice);var percentoff=(dollarsoff/dsvalue)*100;var misitelink=data.page.site.sitelink.$t+lidHash+"#widget=ds_rrail";var mideallink=data.page.deals.deal.link.$t+lidHash+"#widget=ds_rrail";jQuery(".ds_value").html("$"+Math.round(dsvalue));jQuery(".ds_discount").html(Math.floor(percentoff)+"%");jQuery(".ds_save").html("$"+Math.round(dollarsoff));jQuery(".ds_title_link").attr("href",mideallink);jQuery(".ds_title_link").html(data.page.deals.deal.offer.$t);jQuery(".ds_pricetag").prepend("$"+data.page.deals.deal.saleprice.$t);jQuery(".ds_deal_image img").attr("src",data.page.deals.deal.splashpagethumbnail.$t);jQuery(".ds_logo_link").attr("href",misitelink);jQuery(".ds_dealtitle").attr("href",misitelink);jQuery(".ds_deal_image a").attr("href",mideallink);jQuery(".ds_pricetag a").attr("href",mideallink);};mi.DealSaver.prototype.displayWidget=function(display_mode){var self=this;if(display_mode!==0&&display_mode!==2){jQuery(".dsWidgetDisplay").attr("style","display:block");}else if(display_mode==2){jQuery(".ds_buycontainer").attr("style","display:none");jQuery(".ds_deal_image").attr("style","float:none; text-align:center");jQuery(".dsWidgetDisplay").attr("style","display:block");}};var mi=(!mi)?{'media_domain':''}:mi;mi.floorAd=function(container,repeat,adWrapper,adObject,count){count=typeof count!=='undefined'?count:0;adWrapper=typeof adWrapper!=='undefined'?adWrapper:"#floorWrapper";adObject=typeof adObject!=='undefined'?adObject:"floorAd";mi.App.apply(this,arguments);var floorAd_mainImg;var floorAd_leaveImg;var adDoc;this.wrapper;this.mainImg;floorAd_mainImg;this.mainWidth;this.mainHeight;this.leaveImg;this.leaveHeight;this.closeLink;this.openLink="";this.repeat=typeof repeat!=='undefined'?repeat:240;this.setConf('repeat',this.repeat);this.setConf('container',container);this.timeStamp=Math.round(new Date().getTime()/60000);this.cookieName='mi_floorboard';this.expand=true;this.checkForAd(container,repeat,adWrapper,adObject,count);}
mi.floorAd.prototype.checkForAd=function(container,repeat,adWrapper,adObject,count)
{if($('#floorboard-ad').length>0){adDoc=$(container);this.container=$(container).length?$(container):'';}
else{adDoc=$(adWrapper+" iframe").contents();this.initIframeSize(adWrapper);this.setIframeHeight(adWrapper,110);this.container=adDoc.find(container);var numdiv=adDoc.find("#floorboard-wrapper");if(numdiv.length<1){if(count++<60){setTimeout(adObject+".checkForAd( '"+container+"', "+repeat+",'"+adWrapper+"','"+adObject+"',"+count+" )",500);}
return;}}
this.floorAdExec(container,repeat,adWrapper,adObject,count);}
mi.floorAd.prototype.floorAdExec=function(container,repeat,adWrapper,adObject,count){count=typeof count!=='undefined'?count:0;adWrapper=typeof adWrapper!=='undefined'?adWrapper:"#floorWrapper";adObject=typeof adObject!=='undefined'?adObject:"floorAd";mi.App.apply(this,arguments);var floorAd_mainImg;var floorAd_leaveImg;$(adWrapper).css("display","inline");this.wrapper=adDoc.find("#floorboard-wrapper");if(adDoc.find('#floor-panel').length>0)
{this.mainImg=adDoc.find('#floor-panel');}
else
{this.mainImg=adDoc.find('img:eq(0)');}
floorAd_mainImg=this.mainImg;this.mainWidth=this.mainImg.width();this.mainHeight=this.mainImg.height();if(adDoc.find('#floor-leavebehind').length>0)
{this.leaveImg=adDoc.find('#floor-leavebehind');}
else
{this.leaveImg=adDoc.find('img:eq(1)');}
floorAd_leaveImg=this.leaveImg;this.leaveHeight=this.leaveImg.height();this.closeLink=adDoc.find('map[name="floorclosemap"]  area');this.openLink=adDoc.find('map[name="flooropenmap"] area');this.repeat=typeof repeat!=='undefined'?repeat:240;this.setConf('repeat',this.repeat);this.setConf('container',container);this.timeStamp=Math.round(new Date().getTime()/60000);this.cookieName='mi_floorboard';this.expand=true;this.cookie=new mi.Cookie(document,this.cookieName);this.cookie.load();if(this.container!=='')
{this.container.css({'position':'static','text-align':'left','bottom':'0','right':'0','left':'0'});if(navigator.platform=='iPad'||navigator.platform=='iPhone'||navigator.platform=='iPod'||navigator.platform=='Linux armv7l')
{this.container.css("position","static");}
this.wrapper.css({'width':this.mainWidth+'px','text-align':'left','margin':'0 auto'});if(this.mainImg!=='')
{this.flightID=this.mainImg[0].getAttribute('data-flightid');if(this.flightID==null){this.leaveImg[0].getAttribute('data-flightid');}
this.flightID=this.flightID!=null?this.flightID:'';var minutesAgo=this.lastShown();if(minutesAgo>=0&&minutesAgo<=this.repeat){this.expand=false;}
this.setCookie();this.mainImg.css({'position':'absolute','border':'0','bottom':(-1*this.mainHeight),'z-index':'2147483644'});if(this.leaveImg!==''&&this.closeLink!=='')
{this.leaveImg.css({'display':'none','border':'0','position':'absolute','bottom':(-1*this.leaveHeight),'z-index':'2147483644'});this.closeAd=function(){$(adWrapper+" div").animate({'height':"30px"});floorAd_leaveImg.css({'display':'block','bottom':(-1*floorAd_mainImg.height())});floorAd_mainImg.animate({'bottom':(-1*floorAd_mainImg.height())});floorAd_mainImg.css({'display':'none'});$('body').animate({'margin-bottom':floorAd_leaveImg.height()});floorAd_leaveImg.animate({'bottom':'0'});};this.closeLink.click(this.closeAd);if(this.openLink!='')
{this.openLink.click(function(){$(adWrapper+" div").animate({'height':"110px"});floorAd_leaveImg.animate({'bottom':(-1*floorAd_leaveImg.height())});floorAd_leaveImg.css({'display':'none'});floorAd_mainImg.animate({'bottom':'0'});floorAd_mainImg.css({'display':'block'});$('body').animate({'margin-bottom':floorAd_mainImg.height()});});}}
var passAd2ready=this;$(document).ready(function(){if(passAd2ready.expand){floorAd_leaveImg.css({'bottom':(-1*floorAd_leaveImg.height())});floorAd_mainImg.animate({'bottom':'0'});$('body').css({'margin-bottom':floorAd_mainImg.height()});}
else{passAd2ready.closeAd();}});}
else
{console.warn("No floor ad images to display");}}
else
{console.warn("Floor ad cannot be instantiated. "+container+" does not exist.");}};mi.floorAd.prototype.setCookie=function()
{var cookieData=new Array();var flightKey='fbid'+this.flightID;if(this.cookie){for(var prop in this.cookie){if(prop.indexOf('fbid')!=-1){var id_time=parseInt(this.cookie[prop]);if((this.timeStamp-id_time)<=this.repeat){cookieData[prop]=this.cookie[prop];}}}}
this.cookie.remove();this.cookie=new mi.Cookie(document,this.cookieName,this.getConf('repeat'),'/');this.cookie[flightKey]=this.timeStamp;for(var prop in cookieData){this.cookie[prop]=cookieData[prop];}
this.cookie.store();};mi.floorAd.prototype.lastShown=function(flightID)
{flightKey='fbid'+this.flightID;if(this.cookie){if(this.cookie[flightKey]){var id_time=parseInt(this.cookie[flightKey]);return(this.timeStamp-id_time);}
else{return-1;}}
return-1;}
mi.floorAd.prototype.setIframeHeight=function(adWrapper,height)
{$(adWrapper+" div").height(height+"px");}
mi.floorAd.prototype.initIframeSize=function(adWrapper)
{$(adWrapper+" iframe").each(function(index){if(this.id.indexOf('google_ads_iframe_')!=-1){this.width="100%";this.height="100%";}});}
$(window).load(function(){$('div[name=adx_al]').bind('click',function(){var $curMarg=$('body').css('margin-bottom').replace("px","");$curMarg=($curMarg==30)?110:30;$('body').css('margin-bottom',$curMarg+'px');});$('.advertisement img').each(function(index){if(this.height==1&&this.width==1){$(this).css("display","none");}});});mi.WallpaperAd=function(tagWrapper,destination,maxChecks){maxChecks=typeof maxChecks!=='undefined'?maxChecks:90;mi.App.apply(this,arguments);this.tagWrapper=tagWrapper;this.destination=destination;this.adPadding=20;this.adDoc=null;this.ad=null;this.adFound=false;this.maxChecks=maxChecks;this.clearID;this.checkCount=0;this.clearID=0;var ref=this;if(!(this.checkForAd())){this.clearID=setInterval(function(){ref.checkForAd()},500);}};mi.WallpaperAd.prototype.checkForAd=function()
{if(this.checkCount++>this.maxChecks){clearInterval(this.clearID);return false;}
if(this.adFound){return true;}
var adDoc;var ads=[];for(var i=0;i<this.tagWrapper.length;i++){ads=jQuery('#wallpaper-ad');if(ads.length>0){this.ad=ads[0];this.adFound=true;}
else{try{adDoc=$(this.tagWrapper[i]+" iframe").contents();ads=adDoc.find("#wallpaper-ad");if(ads.length>0){this.adFound=true;this.adDoc=adDoc;this.ad=this.adDoc.find("#wallpaper-ad")[0];}}
catch(err){}}
if(this.adFound){clearInterval(this.clearID);this.moveAd();this.makeVisible();this.adjustImages();var ref=this;$("#wallpaper-ad img").load(function(){ref.makeVisible();ref.adjustImages();});}}
return this.adFound;};mi.WallpaperAd.prototype.adjustImages=function()
{var widthLeft=jQuery('#wallpaper_left_img').width();var widthRight=jQuery('#wallpaper_right_img').width();var widthTemp=widthLeft;if(widthLeft<=0&&widthRight>0){widthLeft=widthRight;}
if(widthRight<=0&&widthTemp>0){widthRight=widthTemp;}
jQuery('#wallpaper_left').css("left","-"+(widthLeft+this.adPadding)+"px");width=jQuery('#wallpaper_right_img').width();jQuery('#wallpaper_right').css("right","-"+(widthRight+this.adPadding)+"px");}
mi.WallpaperAd.prototype.moveAd=function()
{var destinations=jQuery(this.destination);if(destinations.length<1){console.log('Wallpaper ad failed - invalid destination configured');return false;}
var firstChild=destinations[0].firstChild;destinations[0].insertBefore(this.ad,firstChild);};var ttt=0;mi.WallpaperAd.prototype.makeVisible=function()
{jQuery(this.ad).css({'display':'inline','z-index':'2147483639'});jQuery('#wallpaper_left').css({'display':'inline','z-index':'2147483639'});jQuery('#wallpaper_right').css({'display':'inline','z-index':'2147483639'});};mi.Multimedia=function(id,items_per_page,queue){mi.App.apply(this,arguments);this.id=id;this.widget=jQuery('#'+this.id);this.widgetContent=jQuery('#'+this.id+' ul.tiles.four');this.queue=queue;this.pages=[];this.currentPage=0;this.items_per_page=items_per_page;this.lastPage=Math.ceil(this.queue.length/this.items_per_page);this.numPages=this.lastPage+1;this.pages_loaded=[];this.pages_loaded[0]=true;for(var i=1;i<this.numPages;i++){this.pages_loaded[i]=false;}
if(this.lastPage>this.currentPage){this._initUI();}};mi.Multimedia.prototype._initUI=function(){if(typeof(jQuery)=='function'){for(var i=0;i<this.lastPage;i++){var page=[];var start=i*this.items_per_page,stop=start+this.items_per_page;for(var j=start;j<stop;j++){if(typeof(this.queue[j])!=='undefined'){page.push(this.queue[j]);}
else{break;}}
this.pages[i]=page;}
var adv_container=this.widget.find('h2.heading');var adv_button=jQuery('<div class="rcnt_adv_button"><span></span></div>');adv_container.prepend(jQuery('<div class="rcnt_adv_container">').append(adv_button));adv_button.bind('click',{obj:this},function(event){var obj=event.data.obj;obj.loadPage(obj._next());});var dots=this.widget.find('div.pag');var dots_width=16*(this.lastPage+1);dots.css({'width':''+dots_width+'px',});var title=this.widget.find('span.rcnt_label');var title_width=this.items_per_page==5?620:300;title.css({'width':''+(title_width-(4+dots_width+28+10))+'px',});for(var i=0;i<=this.lastPage;i++){var div=jQuery('<div>');if(i===0){div.addClass('current');}
div.bind('click',{obj:this,index:i},function(event){var obj=event.data.obj;obj.loadPage(event.data.index);}).css({'cursor':'pointer'});div.appendTo(dots);}
this._updateUI();}};mi.Multimedia.prototype._updateUI=function(){var dots=this.widget.find('div.pag div');dots.each(function(){if($(this).hasClass('current')){$(this).removeClass('current');}});dots.eq(this.currentPage).addClass('current');};mi.Multimedia.prototype._next=function(){if(this.numPages===0){return this.currentPage;}
else if(this.currentPage===this.lastPage){return 0;}
else{return this.currentPage+1;}};mi.Multimedia.prototype.loadPage=function(index){this.widgetContent=jQuery('#'+this.id+' ul.tiles.four');var next_page=this.widgetContent.eq(index);if(!this.pages_loaded[index])
{var page=this.pages[index-1];next_page=jQuery('<ul class="tiles four js" style="display:none"></ul>');for(var item=0;item<page.length;item++){li=this._item_html(page[item]);li.appendTo(next_page);}
var position=0;for(var i=0;i<this.numPages;i++){if(this.pages_loaded[i]===false&&i<=index){position=i-1;break;}}
this.widgetContent.eq(position).after(next_page);this.pages_loaded[index]=true;}
this.widgetContent.hide();next_page.show();this.currentPage=index;this._updateUI();};mi.Multimedia.prototype._item_html=function(item){var item=item;var li=jQuery('<li class="article"></li>');if(item.is_video=='true'){var video_div=jQuery('<div class="is_video"><a href="'+item.url+'"></a></div>');}
var link=jQuery('<a href="'+item.url+'" title="'+item.media_label+'">'
+'<img src="'+item.thumb_url+'" /></a>');var h3=jQuery('<h3><a href="'+item.url+'">'+item.media_title+'</a></h3>');if(typeof(video_div)!=='undefined'&&video_div.length>0){li.prepend(video_div);}
li.append(link,h3);return li;};mi.Surveywall=function(_config){mi.App.apply(this,arguments);mi.loadPageInfo();if(this.appStatus(_config)){var self=this;this.setConf("enabled",mi.control.surveywall);this.cache.baseGoogleSourceRequest=this.buildGoogleSourceRequest();this.initializeAlternateActionObject(_config.alternateActionObject);if(!this.cache.google_script_regex){this.cache.google_script_regex="(prompt|survey)\\?site="+this.getConf("google_site_id");}
this.initiatePrompt();jQuery(this.getConf("paging_selector")).bind("click",function(){self.initiatePrompt();});window.mi_g1pman_setPhotoViewsPassLimit=function(){self.setViewsPassLimit()};}
else{this.setConf("enabled",0);console.warn("Surveywall has been instantiated but disabled.");}}
mi.Surveywall.prototype.appStatus=function(_config){if(mi.control&&mi.control.surveywall&&this.checkCookie(_config.view_limit)!==0&&this.validPermitExists()&&this.isPagePermitted(_config.page_permit)){return true;}
else{return false;}}
mi.Surveywall.prototype.initiatePrompt=function(){if(this.getConf("enabled")&&this.checkCookie()&&!this.cache.prompt_active){if(!this.getAlternateActionStatus()){this.cache.prompt_active=this.loadScriptSource(this.cache.baseGoogleSourceRequest.cloneNode());}}}
mi.Surveywall.prototype.setViewsPassLimit=function(){var self=this;this.setCookieThreshold(this.cache.viewLimit);}
mi.Surveywall.prototype.checkCookie=function(n){n=this.cache.viewLimit=+n||+this.getConf("view_limit")||5;if(!this._cookie){this._cookie=new mi.Cookie(document,"mi_surveywall",null,"/");this._cookie.load();if((this._cookie.threshold=+this._cookie.threshold)===0){return this._cookie.threshold;}}
else if((this._cookie.threshold=+this._cookie.threshold)<=n){if(this._cookie.threshold===1){return this._cookie.threshold;}
else if(this._cookie.threshold>1&&this._cookie.threshold<=n){this.setCookieThreshold(--this._cookie.threshold);return false;}
else{this.setCookieThreshold();return false;}}
else{this.setCookieThreshold(n);return false;}}
mi.Surveywall.prototype.setCookieThreshold=function(n){this._cookie.threshold=(n!==undefined)?n:this._cookie.threshold;this._cookie.store();return this._cookie.threshold;}
mi.Surveywall.prototype.setCookieExpiration=function(n){this._cookie.expiration=(n!==undefined)?n:this._cookie.expiration;this._cookie_store();return this._cookie.expiration;}
mi.Surveywall.prototype.validPermitExists=function(){var pageInfo=mi.pageInfo;this.cache.section_id=(pageInfo&&pageInfo.section&&pageInfo.section.id)?pageInfo.section.id:undefined;this.cache.type=(pageInfo&&pageInfo.type)?pageInfo.type:undefined;this.cache.asset_id=(pageInfo&&pageInfo.asset&&pageInfo.asset.id)?pageInfo.asset.id:undefined;if(this.cache.section_id||this.cache.type||this.cache.asset_id){return true;}
else{return false;}}
mi.Surveywall.prototype.isPagePermitted=function(page_permit_obj){var page_values={section:this.cache.section_id,type:this.cache.type,asset:this.cache.asset_id}
var permit=false;for(var action in page_permit_obj){for(var permit_facet in page_permit_obj[action]){if(page_permit_obj[action][permit_facet].length!==0){var permission_values=page_permit_obj[action][permit_facet];var isMatch=permission_values.match(page_values[permit_facet]);switch(action){case"exclude":if(isMatch){permit=false;}
else{permit=true;}
break;case"include":if(isMatch){permit=true;}
else{permit=false;}
break;}}}}
if(permit){return true;}else{return false;}}
mi.Surveywall.prototype.buildGoogleSourceRequest=function(request_obj){if(request_obj){var CONTENT_ID=(this.getConf("use_asset_id")&&this.cache.asset_id!==undefined)?this.cache.asset_id:(new Date()).getTime();var random=(new Date).getTime()+1;request_obj.src+=(CONTENT_ID?'&cid='+
encodeURIComponent(CONTENT_ID):"")+'&random='+
random+'&after=1';return request_obj;}
else{var ARTICLE_URL=window.location.href;var GOOGLE_SITE_ID=this.getConf("google_site_id");var google_source_url='http://survey.g.doubleclick.net/survey'+
'?site='+encodeURIComponent(GOOGLE_SITE_ID)+
'&url='+encodeURIComponent(ARTICLE_URL);var request_obj=document.createElement("script");request_obj.setAttribute("src",google_source_url);request_obj.setAttribute("type","text/javascript");return request_obj;}}
mi.Surveywall.prototype.loadScriptSource=function(request_obj,target){var self=this;if(!target){var target=document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0];}
request_obj=this.buildGoogleSourceRequest(request_obj);target.appendChild(request_obj);var list=document.getElementsByTagName("script")
for(x=0;x<list.length;x++){if((value=list[x].src.match(this.cache.google_script_regex))){return true;}}}
mi.Surveywall.prototype.initializeAlternateActionObject=function(alternateAction){if(typeof alternateAction.object=="function"){this._alternateAction=new alternateAction.object();for(x in alternateAction){if(typeof x==="number"||typeof x==="string"){this._alternateAction[x]=alternateAction[x];}}
return false;}
else{this._alternateAction=alternateAction;}}
mi.Surveywall.prototype.initializeAlternateActionTarget=function(altActionDocObject){var self=this;this.pollPrompt();this._alternateAction.iframeDocument=altActionDocObject;this.cache.learnMoreLink=this.buildLearnMoreLink();jQuery("<link rel=\"stylesheet\" type=\"text/css\">")
.attr("href",self.getConf("alternateActionObject").css)
.appendTo(jQuery(self._alternateAction.iframeDocument)
.find("head"));this.injectAlternateAction(this.getConf("alternateActionObject").html);this.applyListeners(this._alternateAction.deferred_listener_list);}
mi.Surveywall.prototype.injectAlternateAction=function(payload){var self=this;var targetFrameBody=this._alternateAction.iframeDocument.getElementsByTagName("body")[0];if(payload.indexOf("http://")==0){jQuery.ajax({url:self.getConf("alternateActionObject").html,success:function(d,t){jQuery(d)
.appendTo(targetFrameBody);self.injectLearnMoreLink(targetFrameBody);return t;},async:false});}
else{jQuery(payload)
.appendTo(targetFrameBody);self.injectLearnMoreLink(targetFrameBody);}
}
mi.Surveywall.prototype.buildLearnMoreLink=function(){var self=this;if(this.getConf("learn_more")){var link=this._alternateAction.iframeDocument.createElement("a");link.id="info-link";link.innerHTML="Learn More";link.style.cssText="float: right; font-size: .8em; color:#378707;";link.href="javascript:void(0)";jQuery(link).click(function(){self.displayMessage(self.getConf("learn_more"))});return link;}
else{return false}}
mi.Surveywall.prototype.injectLearnMoreLink=function(targetFrameBody){if(this.getConf("learn_more")&&!jQuery(targetFrameBody).find("#info-link")[0]){targetFrameBody.appendChild(this.cache.learnMoreLink);}
else{return false}}
mi.Surveywall.prototype.displayMessage=function(message){iframe_body=this._alternateAction.iframeDocument;jQuery(iframe_body).find("#msg").html(message);jQuery(iframe_body).find("#msgBlock").fadeIn();jQuery(iframe_body).find("#msgButton").click(function(){jQuery(iframe_body).find("#msgBlock").fadeOut()});}
mi.Surveywall.prototype.applyListeners=function(listener_list){if(listener_list){var self=this;for(x=0;x<listener_list.length;x++){var y=listener_list[x];var selector=jQuery(this._alternateAction.iframeDocument).find(y[0]);jQuery(selector).bind(y[1],function(){self[y[2]](y[3])});}}}
mi.Surveywall.prototype.pollPrompt=function(){var self=this;setTimeout(function(){prompt_state=jQuery("#contain-402").css("display");if(prompt_state==="block"){self.pollPrompt();}
else{self.cache.prompt_active=false;jQuery("head").find("script").each(function(){if((value=this.src.match(self.cache.google_script_regex))){this.parentElement.removeChild(this)}});if(prompt_state==="none"){jQuery("#contain-402").remove();self.setViewsPassLimit();}}},500);}
mi.Surveywall.prototype.getAlternateActionStatus=function(){return true;}
mi.Surveywall.prototype.getAlternateActionStatus=function(){this.ppCookie=new mi.Cookie(document,"ppUser",null,"/");if(this.ppCookie.load()){this.setCookieThreshold(0);this.setConf("enabled",0);return true;}
else{return false;}}
mi.YouTube=function(id,target_div,width,height){mi.App.apply(this,arguments);this.id=id;this.target_div=target_div;this.width=width;this.height=height;this.player={};this._loadPlayer();};mi.YouTube.prototype._loadPlayer=function(){var self=this;if(document.getElementById('youtube_js')===null){var tag=document.createElement('script');tag.setAttribute('id','youtube_js');tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName('script')[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);}
window.onYouTubeIframeAPIReady=function(){self.player=new YT.Player(self.target_div,{height:self.height,width:self.width,videoId:self.id,playerVars:{wmode:"opaque"},});};};mi.FeaturedCarousel=function(id){mi.App.apply(this,arguments);this.id=id;this.carousel=[];this.carousel_list=[];this.current=0;this.numItems=1;this.lastItem=0;this.apparent_first_item=0;if(!typeof(jQuery)=='function'){console.log('Featured content carousel requires jQuery');return undefined;}
this.featured_stage=jQuery('#'+id);this.featured_img_stage=$(this.featured_stage).find('div#mi_photo_carousel_stage');this.featured_img_tag=$(this.featured_stage).find('img')[0];this.featured_img_caption=$(this.featured_stage).find('div.caption span.caption_text')[0];this.featured_img_credit=$(this.featured_stage).find('div.caption span.photo_credit');this.featured_img_buy=$(this.featured_stage).find('div.caption span.buy_link');if(this.featured_stage.length){this._initUI();}};mi.FeaturedCarousel.prototype._initUI=function(){this.carousel_list=this.featured_stage.find('ul#mi_photo_carousel li');this.numItems=this.carousel_list.length;this.lastItem=this.numItems-1;this.apparent_first_item=this.numItems>6?5:this.lastItem;var self=this;this.carousel_list.each(function(i){var list_index=i;var li=$(this);var link=$(this).find('a');var img=$(link).find('img')[0];var asset_type=$(li).attr('data-type');var item={};switch(asset_type){case'image':case'photo':case'headshot':item={url:$(link).attr('href'),width:$(li).attr('data-width'),height:$(li).attr('data-height'),caption:$(li).attr('data-caption'),credit:$(li).attr('data-credit'),buy:$(li).attr('data-buy'),asset_type:$(li).attr('data-type')};break;case'gallery':item={url:$(link).attr('href'),width:$(li).attr('data-width'),height:$(li).attr('data-height'),caption:$(li).attr('data-caption'),credit:$(li).attr('data-credit'),buy:$(li).attr('data-buy'),asset_type:$(li).attr('data-type'),num_images:$(li).attr('data-images'),headline:$(li).attr('data-headline'),gallery:$(li).attr('data-gallery')};var gallery_headline='';if(typeof(item.headline)!=='undefined'){gallery_headline="<div class=\"gallery_headline\">"+item.headline+"</div>";}
item.caption=gallery_headline+item.caption;break;case'youtube_video':item={caption:$(li).attr('data-caption'),credit:$(li).attr('data-credit'),asset_type:$(li).attr('data-type'),video_id:$(li).attr('data-id')};break;}
self.carousel.push(item);$(link).each(function(){$(this).click(function(){self.setStage(list_index);return false;});});});var button_height='425px';if(self.carousel[self.apparent_first_item].asset_type=='youtube_video'){button_height='380px';}
var prev_button=jQuery('<div id="carousel_prev_button" style="height:'+button_height+'"><span></span></div>');this.featured_stage.append(prev_button);prev_button.click(function(){self.setStage(self._prev());});var next_button=jQuery('<div id="carousel_next_button" style="height:'+button_height+'"><span></span></div>');this.featured_stage.append(next_button);next_button.click(function(){self.setStage(self._next());});var overlay=$('<div class="carousel_current" />');$(self.carousel_list[this.apparent_first_item]).append(overlay);this.current=this.apparent_first_item;};mi.FeaturedCarousel.prototype._prev=function(){if(this.numItems===1){return this.current;}
else if(this.current===this.lastItem){if(this.numItems<=6){return 0;}
else{return this.current-(6+(this.current%6));}}
else if(this.current%6==5){if(this.current-11>=0){return this.current-11;}
else{var next=this.current-5;var target=this.lastItem-(this.lastItem%6);while(next<target){next=next+6;}
return next;}}
else{return this.current+1;}};mi.FeaturedCarousel.prototype._next=function(){if(this.numItems===1){return this.current;}
if(this.current%6==0){if(this.current+6<=this.lastItem){if(this.current+11<=this.lastItem){return this.current+11;}
else{return this.lastItem;}}
else{return this.apparent_first_item;}}
else{return this.current-1;}};mi.FeaturedCarousel.prototype.setStage=function(index){var self=this;var item=self.carousel[index];var current_img_tag=$(this.featured_img_stage).find('img')[0];var gallery_overlay=$('div.gallery_overlay');var current_youtube=$('iframe#youtube_player');switch(item.asset_type){case'image':case'photo':case'headshot':case'gallery':var new_img_tag=$('<img>');$(current_img_tag).remove();$(current_youtube).remove();$(gallery_overlay).remove();$(new_img_tag)
.attr('src',item.url)
.attr('width',item.width)
.attr('height',item.height)
.appendTo(self.featured_img_stage);if(item.asset_type=='gallery'){var gallery_overlay_content="<div class='gallery_overlay'><a href='"+item.gallery+"'>View Full Gallery ("+item.num_images+" Photos)</a></div>";$(self.featured_img_stage).append(gallery_overlay_content);}
$(self.featured_img_caption).html(item.caption);$(self.featured_img_credit).html(item.credit);var buy_link=item.buy;if(buy_link.length>0){buy_link="&nbsp;|"+buy_link;}
$(self.featured_img_buy).html(buy_link);var button_height=item.asset_type=='gallery'?'380px':'425px';jQuery.each(['carousel_prev_button','carousel_next_button'],function(){$('#'+this).css({'height':button_height});});break;case'youtube_video':var youtube_html=$('<iframe id="youtube_player">');$(youtube_html)
.attr('src',"http://www.youtube.com/embed/"+item.video_id+"?autoplay=0&wmode=transparent")
.attr('frameborder',"0")
.attr('width','620')
.attr('height','425');$(current_img_tag).remove();$(current_youtube).remove();$(gallery_overlay).remove();$(youtube_html).appendTo(self.featured_img_stage);$(self.featured_img_caption).html(item.caption);$(self.featured_img_credit).html(item.credit);$(self.featured_img_buy).empty();jQuery.each(['carousel_prev_button','carousel_next_button'],function(){$('#'+this).css({'height':'380px'});});break;};self.current=index;var overlay=$('<div class="carousel_current" />');$(self.carousel_list).each(function(){$(this).find('div.carousel_current').remove();});$(self.carousel_list[index]).append(overlay);};mi.Search=function(){mi.App.apply(this,arguments);mi.getArgs();this.kill;};mi.Search.prototype.submitForm=function(searchType){this.kill="false";switch(this.getConf("searchSelectorType")){case"option":searchType=document.miSearchForm.aff.value;break;case"radio":searchType=$('input:radio[name=aff]:checked').val();break;}
var queryInputField;if(document.miSearchForm.keywords){queryInputField=document.miSearchForm.keywords;}
else{queryInputField=document.miSearchForm.q;}
var searchText="";if($(queryInputField).attr("placeholder")){if(!(queryInputField.value==$(queryInputField).attr("placeholder"))){searchText=queryInputField.value;}}
else{searchText=queryInputField.value;}
if(searchType==parseInt(searchType)){return;}
else{this.searchParamConfig(searchType,searchText);this.buildForm(searchType);}
if(this.kill=="false"){document.miSearchForm.submit();}
else{return false;}};mi.Search.prototype.buildForm=function(search_type){var self=this;var searchInputContainer_div=document.getElementById("searchInputContainer").innerHTML;if(searchInputContainer_div){$("#searchInputContainer > input[type='hidden']").each(function(){$(this).remove();});}
$("#search_widget_form").attr('method',self.getConf("form_method"));try{jQuery.each(self.getConf("query_fields"),function(paramName,paramValue){paramName=paramName.replace(/(.*)_mihyphen_(.*)/,"$1-$2");$("<input type='hidden' name='"+paramName+"' value='"+paramValue+"' />").appendTo("#searchInputContainer");});}
catch(e){console.error("Script Caught Error - "+e);}
document.miSearchForm.action=self.getConf("form_action");};mi.Search.prototype.checkOption=function(){var self=this;if(typeof mi.args.collection!="undefined"){switch(self.getConf("searchSelectorType")){case"option":if(mi.args.collection=="WEB"){$("select#search_select option[value='web_search']").attr("selected",1);}else if(mi.args.collection=="ARCHIVES"){$("select#search_select option[value='archives']").attr("selected",1);}else{$("select#search_select option[value='h_archives']").attr("selected",1);}
break;case"radio":if(mi.args.collection=="WEB"){$("#search_web").attr("checked",1);}else if(mi.args.collection=="ARCHIVES"){$("#search_archives").attr("checked",1);}else{$("#search_history").attr("checked",1);}
break;}}};mi.Search.prototype.dropDownSelection=function(target){mi.search.cache.mi_search_type=target.children('a').attr("id");if(target.children('a').is('#site_search')){var this_image=target.find("img").attr("src");mi.search.getConf("mi_search_widget_icon").attr("src",this_image);}
else if(target.children('a').is('#web_search')){var this_image=target.find("img").attr("src");mi.search.getConf("mi_search_widget_icon").attr("src",this_image);}
else if(target.children('a').is('#archives')){var this_image=target.find("img").attr("src");mi.search.getConf("mi_search_widget_icon").attr("src",this_image);}
$("#search_keywords").focus();return false;}
mi.Search.prototype.configErrorReporter=function(){this.kill="true";alert("Option doesn't exist in your configuration. Please review your browsers error console.");console.error("Option doesn't exist in your configuration. Please submit a ticket to MI Support for assistance.");return false;}
mi.Search.prototype.setUp=function(){mi.search.searchParamConfig();if(!mi.search.getConf("noWebSearch")){mi.search.getConf("mi_search_drop_down_web_search_item").show();mi.search.getConf("yahoo_credit").css("visibility","visible");}
mi.search.getConf("mi_search_dropdown_keys").hover(function(){mi.search.getConf("mi_search_drop_down").show();},function(){mi.search.getConf("mi_search_drop_down").hide();});mi.search.getConf("mi_search_drop_down_link").bind("click",function(e){mi.search.getConf("mi_search_drop_down").hide();});mi.search.getConf("mi_search_dropdown_input").focus(function(){mi.search.getConf("mi_search_drop_down").hide();});mi.search.getConf("mi_search_selected").click(function(){mi.search.dropDownSelection($(this));return false;});mi.search.checkOption();mi.search.cache.mi_search_type=mi.search.getConf("defaultSearchType");var mi_search_form=document.miSearchForm;mi_search_form.onsubmit=function(){return mi.search.submitForm(mi.search.cache.mi_search_type);}}
mi.Search.prototype.fetchKeywordUrlMap=function(myKeywordUrlMap,myTargetSelector){if(myKeywordUrlMap.match(/\++$/))
myKeywordUrlMap=myKeywordUrlMap.replace(/\+*$/,'');var formattedOutput='';var urlKeywords=this.fetch404Keywords();var keywordUrlMapObjects=[];myKeywordUrlMap=myKeywordUrlMap.split('++');for(var i in myKeywordUrlMap){var currentKeywordUrlMap=myKeywordUrlMap[i].split('||');keywordUrlMapObjects[i]=new this.keywordUrlMapClass(currentKeywordUrlMap[0],currentKeywordUrlMap[1]);var currentKeywords=currentKeywordUrlMap[2].split(',');for(var x in currentKeywords){keywordUrlMapObjects[i].addKeyword(currentKeywords[x]);}}
for(var i in urlKeywords){for(var x in keywordUrlMapObjects){if(keywordUrlMapObjects[x].matchKeyword(urlKeywords[i])){formattedOutput+="\
		    <li><a href='"+keywordUrlMapObjects[x].url+"'>"+
keywordUrlMapObjects[x].name+"</a>\
		    </li>";}}}
$(myTargetSelector).append(formattedOutput);}
mi.Search.prototype.keywordUrlMapClass=function(myName,myUrl){this.name=myName;this.url=myUrl;this.keywords=[];this.matchedKeyword=false;this.addKeyword=function(myKeyword){this.keywords.push(myKeyword.toLowerCase());}
this.matchKeyword=function(myKeyword){if((!this.matchedKeyword)&&(this.getKeywords().match(myKeyword))){this.matchedKeyword=true;return(true);}
return(false);}
this.getKeywords=function(){return(this.keywords.join(', '));}}
mi.Search.prototype.fetchSearchResults=function(myTargetSelector){var keywordList='';var keywords=this.fetch404Keywords();for(var i in keywords){keywordList+=' '+keywords[i];}
$(myTargetSelector).load('/search/ #search',{q:keywordList});}
mi.Search.prototype.fetch404Keywords=function(){var keywordsArray=[];var returnKeywordsList=[];keywordsArray=window.location.pathname.toLowerCase().slice(1).split('/');for(var x in keywordsArray){if((keywordsArray[x].match(/story/))||(keywordsArray[x].match(/[0-9]+/))){}else{returnKeywordsList.push(keywordsArray[x]);}}
return(returnKeywordsList);}
function getCookieVal(offset){var endstr=document.cookie.indexOf(";",offset);if(endstr==-1)
endstr=document.cookie.length;return unescape(document.cookie.substring(offset,endstr));}
function GetCookie(cname){var arg=cname+"=";var alen=arg.length;var clen=document.cookie.length;var i=0;while(i<clen){var j=i+alen;if(document.cookie.substring(i,j)==arg)return getCookieVal(j);i=document.cookie.indexOf("",i)+1;if(i==0)break;}return null;}
function SaveCookie(cname,cvalue,cdays,cpath){ex=new Date;ex.setTime(ex.getTime()+(cdays*86400000));if(cpath==null){cpath="/"}else{cpath="; path="+cpath}
sitedom=location.hostname.replace(/www\./,"");document.cookie=cname+'='+cvalue+'; expires='+ex.toGMTString()+cpath+"; domain="+sitedom;}
if(typeof insitecookie=="undefined"){var insitecookie=document.cookie.match(auth_cookie_name);}
function getUserName(){var icname=GetCookie(insitecookie);var user_name='';if(icname&&typeof(icname)=='string'){if(icname.indexOf('.threshold')==-1){user_name=icname.replace(/\|.*/,"");}}
return user_name;}
function setRegLinks()
{var uname=getUserName();if(uname!=''){$('#reg_links_member').css("display","inline-block");$('#reg_links_non_member').css("display","none");$('#user_link_name').html(uname);}}
var IEPNGFix=window.IEPNGFix||{};IEPNGFix.tileBG=function(elm,pngSrc,ready){var data=this.data[elm.uniqueID],elmW=Math.max(elm.clientWidth,elm.scrollWidth),elmH=Math.max(elm.clientHeight,elm.scrollHeight),bgX=elm.currentStyle.backgroundPositionX,bgY=elm.currentStyle.backgroundPositionY,bgR=elm.currentStyle.backgroundRepeat;if(!data.tiles){data.tiles={elm:elm,src:'',cache:[],img:new Image(),old:{}};}
var tiles=data.tiles,pngW=tiles.img.width,pngH=tiles.img.height;if(pngSrc){if(!ready&&pngSrc!=tiles.src){tiles.img.onload=function(){this.onload=null;IEPNGFix.tileBG(elm,pngSrc,1);};return tiles.img.src=pngSrc;}}else{if(tiles.src)ready=1;pngW=pngH=0;}
tiles.src=pngSrc;if(!ready&&elmW==tiles.old.w&&elmH==tiles.old.h&&bgX==tiles.old.x&&bgY==tiles.old.y&&bgR==tiles.old.r){return;}
var pos={top:'0%',left:'0%',center:'50%',bottom:'100%',right:'100%'},x,y,pc;x=pos[bgX]||bgX;y=pos[bgY]||bgY;if(pc=x.match(/(\d+)%/)){x=Math.round((elmW-pngW)*(parseInt(pc[1])/100));}
if(pc=y.match(/(\d+)%/)){y=Math.round((elmH-pngH)*(parseInt(pc[1])/100));}
x=parseInt(x);y=parseInt(y);var repeatX={'repeat':1,'repeat-x':1}[bgR],repeatY={'repeat':1,'repeat-y':1}[bgR];if(repeatX){x%=pngW;if(x>0)x-=pngW;}
if(repeatY){y%=pngH;if(y>0)y-=pngH;}
this.hook.enabled=0;if(!({relative:1,absolute:1}[elm.currentStyle.position])){elm.style.position='relative';}
var count=0,xPos,maxX=repeatX?elmW:x+0.1,yPos,maxY=repeatY?elmH:y+0.1,d,s,isNew;if(pngW&&pngH){for(xPos=x;xPos<maxX;xPos+=pngW){for(yPos=y;yPos<maxY;yPos+=pngH){isNew=0;if(!tiles.cache[count]){tiles.cache[count]=document.createElement('div');isNew=1;}
var clipR=Math.max(0,xPos+pngW>elmW?elmW-xPos:pngW),clipB=Math.max(0,yPos+pngH>elmH?elmH-yPos:pngH);d=tiles.cache[count];s=d.style;s.behavior='none';s.left=(xPos-parseInt(elm.currentStyle.paddingLeft))+'px';s.top=yPos+'px';s.width=clipR+'px';s.height=clipB+'px';s.clip='rect('+
(yPos<0?0-yPos:0)+'px,'+
clipR+'px,'+
clipB+'px,'+
(xPos<0?0-xPos:0)+'px)';s.display='block';if(isNew){s.position='absolute';s.zIndex=-999;if(elm.firstChild){elm.insertBefore(d,elm.firstChild);}else{elm.appendChild(d);}}
this.fix(d,pngSrc,0);count++;}}}
while(count<tiles.cache.length){this.fix(tiles.cache[count],'',0);tiles.cache[count++].style.display='none';}
this.hook.enabled=1;tiles.old={w:elmW,h:elmH,x:bgX,y:bgY,r:bgR};};IEPNGFix.update=function(){for(var i in IEPNGFix.data){var t=IEPNGFix.data[i].tiles;if(t&&t.elm&&t.src){IEPNGFix.tileBG(t.elm,t.src);}}};IEPNGFix.update.timer=0;if(window.attachEvent&&!window.opera){window.attachEvent('onresize',function(){clearTimeout(IEPNGFix.update.timer);IEPNGFix.update.timer=setTimeout(IEPNGFix.update,100);});}
(function($){var methods={};methods.populate=function(){var search=this.textbox.val();var that=this;this.provider.requestSuggestions(search,function(matches){if(matches.length===0){that.target.hide();return;}
var html='';$.each(matches,function(){html+='<a href='+this.url+that.hash+'>'+this.label+'</a>';});that.target.find('#suggestionMatches').html(html);that.target.show();});};methods.closeSuggestions=function(){this.target.hide();this.textbox.focus();this.disabled=true;};methods.selected=function(selected){if(typeof(selected)!=='undefined'){this.target.find('#suggestionMatches a').removeClass('selectedSuggestion');if(selected){window.status=selected.attr('href');return selected.addClass('selectedSuggestion');}}
return this.target.find('#suggestionMatches .selectedSuggestion');};methods.selectedIndex=function(index){if(typeof(index)==="number"){if(index<0){this.selected(null);return-1;}
if(index>=this.target.find('#suggestionMatches a').length){index=0;}
this.selected(this.target.find('#suggestionMatches a:eq('+index+')'));return index;}
return this.target.find('#suggestionMatches').children().index(this.selected());};$.fn.AutoSuggest=function(_settings){if($.browser.msie&&parseInt($.browser.version)<7){return this;}
this.each(function(){var defaults={provider:new PageSuggestions(),hash:'#asuggest',disabled:false};var inst=$.extend(defaults,methods,_settings);inst.textbox=$(this);inst.target=$('<div id="suggestTarget" />')
.hide()
.append('<a id="suggestionMessage">Are you looking for?<span id="close_button">X</span></a>')
.append('<div id="suggestionMatches" />')
.insertAfter($(this));$(this).data('AutoSuggest',inst);$(this).attr('autocomplete','off');$(this).bind('keyup',handleKey);$(this).bind('keydown',handleEscapeKey);inst.target.find('#suggestionMessage').click($.proxy(inst.closeSuggestions,inst));inst.target.bind('mousemove',{inst:inst},handleMouseMove);});return this;};function handleEscapeKey(event){var inst=$(this).data('AutoSuggest');if(inst.disabled){return;}
if(event.which===27){inst.closeSuggestions();return false;}}
function handleKey(event){var inst=$(this).data('AutoSuggest');if(inst.disabled){return;}
var key=event.which;if(key!==8&&key!==13&&key<32||(key>=33&&key<38)||(key>=39&&key<40)||(key>=41&&key<=46)||(key>=112&&key<=123)){}
else if(key===8&&inst.textbox.val()===''){inst.target.hide();}
else if(key===40){inst.selectedIndex(inst.selectedIndex()+1);}
else if(key===38){inst.selectedIndex(inst.selectedIndex()-1);}
else if(key===13){var selected=inst.selected();if(selected.length>0){document.location=selected.attr('href');}}
else{inst.populate();}}
function handleMouseMove(event){var inst=event.data.inst;if($(event.target).parent('#suggestionMatches').length&&!$(event.target).hasClass('selectedSuggestions')){inst.selected($(event.target));}
else{inst.selected(null);}}
function PageSuggestions(url){this.url=url;};PageSuggestions.prototype.requestSuggestions=function(search,callback){this.fetch(function(pages){search=search.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");if(search.length<2){return[];}
var searchRegex=new RegExp(search,'i');callback($.grep(pages,function(item,index){return item.label.match(searchRegex);}));});};PageSuggestions.prototype.fetch=function(callback){if(this.pages){callback(this.pages);return;}
var that=this;$.ajax({url:this.url,dataType:'json',success:function(data){if(!$.isArray(data)){data=[];}
that.pages=data;callback(data);},error:function(xhr,type,message){if(typeof(window.console)!=='undefined'){console.log("Error reading search suggestions: "+type);console.log(message);}
that.pages=[];}});};window.PageSuggestions=PageSuggestions;$(document).ready(function(){$('#search_keywords').AutoSuggest({provider:new PageSuggestions('/static/searchsuggestions.js'),hash:window.autoSuggestHash});});})(jQuery);function chooseRelevanceSort(){$.cookie("search_sort","0",{expires:30,path:"/"});window.location.reload();}
function chooseDateSort(){$.cookie("search_sort","1",{expires:30,path:"/"});window.location.reload();}
(function($){function checkSortCookie(){var sortType=$.cookie('search_sort');if(sortType){if(sortType==1){$('input[name=resultSort]').filter('[value=date]').attr('checked',true);}
else{$('input[name=resultSort]').filter('[value=relevance]').attr('checked',true);}}
else{$('input[name=resultSort]').filter('[value=date]').attr('checked',true);}}
$(document).ready(function(){checkSortCookie();});})(jQuery);function blogDisplay(){this.blogNum=0;this.blogs=new Array();this.canAdd=true;this.isDisplayed=false;}
function blogData(blogName,blogURL,blogImg,author,blurb,contentURL){this.blogName=blogName;this.blogURL=blogURL;this.blogImg=blogImg;this.author=author;this.blurb=blurb;this.contentURL=contentURL;}
blogDisplay.prototype.addBlog=function(blogName,blogURL,blogImg,author,blurb,contentURL)
{if(!this.canAdd){return;}
this.blogs[this.blogNum++]=new blogData(blogName,blogURL,blogImg,author,blurb,contentURL);}
blogDisplay.prototype.finishAdding=function()
{this.canAdd=false;}
blogDisplay.prototype.displayBlogs=function(targetID)
{if(this.isDisplayed){return;}
blogstr='';for(var i=0;i<this.blogNum;i++){blogstr+='<div class="blog"><div class="bdescr2">';blogstr+='<a href="'+this.blogs[i].blogURL+'"><img src="'+this.blogs[i].blogImg+'" alt="" /></a>';blogstr+='<h3><a href="'+this.blogs[i].blogURL+'">'+this.blogs[i].blogName+'</a></h3>';blogstr+='<h4>By '+this.blogs[i].author+'</h4><p>'+this.blogs[i].blurb+'</p></div><div class="entries"><h2>LATEST BLOG ENTRIES</h2>';blogstr+='<div id="blogContent_'+i+'" class="blatest"></div></div></div>';}
var targetDiv=document.getElementById(targetID);if(targetDiv!=null){var blogDiv=document.createElement('div');blogDiv.id='blogmain';targetDiv.appendChild(blogDiv);$('#blogmain').addClass("widget");blogDiv.innerHTML=blogstr;}
else{document.write('<div id="blogmain" class="widget">'+blogstr+'</div>');}
this.isDisplayed=true;this.loadBlogContent();$("#blogmain .blog").mouseover(function(){$(this).addClass("blogFocus");});$("#blogmain .blog").mouseleave(function(){$(this).removeClass("blogFocus");});}
blogDisplay.prototype.loadBlogContent=function()
{for(var i=0;i<this.blogNum;i++){$('#blogContent_'+i).load('/static/blogs/'+this.blogs[i].contentURL);}}
WebCollect=function(formAction)
{this.formAction=formAction;this.email="";}
WebCollect.prototype.sendSignup=function()
{jQuery(".wc_bad_email_msg").hide();jQuery(".wc_not_checked_msg").hide();if(!(this.validateEmail())){jQuery(".wc_bad_email_msg").show(500);return false;}
if(!(this.somethingChecked())){jQuery(".wc_not_checked_msg").show(500);return false;}
var dataString=this.getData();var formAction=this.formAction;try{this.response=jQuery.ajax({type:"POST",url:formAction,data:dataString,dataType:"html",success:function(data,textStatus){},error:function(){console.log('Error: email ajax submit failed');},complete:function(response){jQuery(".wc_confirmation_msg").show(500);setTimeout(function(){jQuery(".wc_confirmation_msg").hide(500);},10000);}});}
catch(exception){console.log('email signup - browser failed on post request');return false;}
return false;}
WebCollect.prototype.validateEmail=function()
{var isValidEmail=false;var re=/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}\b/i;var emailFound="";jQuery('.signup-email').each(function(index){var email=$(this).val();if(re.test(email)){isValidEmail=true;emailFound=email;}});this.email=emailFound;return isValidEmail;}
WebCollect.prototype.somethingChecked=function()
{var isChecked=false;jQuery('.webcollect_check').each(function(index){if(this.checked){isChecked=true;}});return isChecked;}
WebCollect.prototype.getData=function()
{var dataString="";jQuery('.webcollect_check').each(function(index){if(this.checked){if(dataString!=''){dataString+='&';}
dataString+='lid='+this.value;}});if(dataString!=''){dataString+="&MID="+jQuery('#webcollect_MID').val();dataString+="&SubAction="+jQuery('#webcollect_subAction').val();dataString+="&thx="+encodeURIComponent(jQuery('#webcollect_thx').val());dataString+="&err="+encodeURIComponent(jQuery('#webcollect_err').val());dataString+="&usub="+encodeURIComponent(jQuery('#webcollect_unsub').val());dataString+="&Email%20Address="+encodeURIComponent(this.email);}
return dataString;}