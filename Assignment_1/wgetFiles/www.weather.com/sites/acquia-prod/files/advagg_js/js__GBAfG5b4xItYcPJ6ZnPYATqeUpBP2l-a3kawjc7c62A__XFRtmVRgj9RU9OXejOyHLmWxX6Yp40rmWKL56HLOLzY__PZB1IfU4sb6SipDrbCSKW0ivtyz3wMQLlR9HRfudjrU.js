/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/taboola_module/vendor/taboola_loader.js. */
if(!window.callPhantom)TWC.Events.drupalSettingsReady.done(function(){window._taboola=window._taboola||[];!function(e,f,u){e.async=1;e.src=u;f.parentNode.insertBefore(e,f)}(document.createElement('script'),document.getElementsByTagName('script')[0],'http://cdn.taboola.com/libtrc/theweatherchannel/loader.js');var drupalSettings=window.Drupal.settings;if(window.Drupal&&drupalSettings&&drupalSettings.ct_article){var pageTemplate=drupalSettings.twc.meta.page_template;if(pageTemplate==="standard"){_taboola.push({article:'auto'})}else if(pageTemplate==="explainer-full"||pageTemplate==="explainer-inset"||pageTemplate==="immersive")_taboola.push({photo:'auto'})}else if("video_player"in drupalSettings.twc.modules){_taboola.push({video:'auto'})}else _taboola.push({category:'auto'})});;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/taboola_module/vendor/taboola_loader.js. */
twc.header_main_menu = twc.header_main_menu || {};
twc.header_main_menu.app = angular.module('header_main_menu', []);;/**/
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_savedlocations/header_savedlocations.app.js. */
twc.header_savedlocations={};twc.header_savedlocations.app=angular.module('header_savedlocations',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_savedlocations/header_savedlocations.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/search/search.app.js. */
twc.search=twc.search||{};twc.search.app=twc.search.app||angular.module('search',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/search/search.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/twc_typeahead/twc_alias.value.js. */
twc.shared.apps.value('aliases',{specialty:{alcatraz:'USCA0987:1:US','amelia island':'USFL0144:1:US','american somoa':'USAS0001:1:US','canary islands':'SPXX0210:1:SP','catalina island':'USCA0055:1:US','disney hawaii':'USHI0200:1:US','disney world':'USFL0615:1:US',disneyland:'USCA1306:1:US','grand cayman':'CJXX0001:1:CJ','green acres':'USFL0512:1:US','hawaii aulani disney resort':'USHI0200:1:US',kauai:'USHI0060:1:US','kiawah island':'USSC0174:1:US','la porte':'USCA1106:1:US',lanai:'USHI0057:1:US',manhattan:'USNY0996:1:US',maui:'USHI0031:1:US',monoco:'MNXX0001:1:MN',oahu:'USHI0026:1:US','tampa bay':'USFL0481:1:US','tel aviv':'ISXX0026:1:IS',uk:'UKXX0085:1:UK','walt disney world':'USFL0615:1:US','washington dc':'USDC0001:1:US','new york city':'USNY0996:1:US',aruba:'AAXX0001:1:AA',bahamas:'BFXX0005:1:BF',bermuda:'BDXX0001:1:BD','big bear':'USCA0093:1:US',brooklyn:'USNY0176:1:US','costa rica':'CSXX1935:1:CS',disneyworld:'USFL0615:1:US',la:'USCA0638:1:US',nyc:'USNY0996:1:US','puerto rico':'USPR0087:1:US'},state:{al:'alabama',ak:'alaska',az:'arizona',ar:'arkansas',ca:'california',co:'colorado',ct:'connecticut',de:'delaware',fl:'florida',ga:'georgia',hi:'hawaii',di:'idaho',il:'illinois','in':'indiana',ia:'iowa',ks:'kansas',ky:'kentucky',la:'louisiana',me:'maine',md:'maryland',ma:'massachusetts',mi:'michigan	mi',mn:'minnesota	mn',ms:'mississippi',mo:'missouri',mt:'montana',ne:'nebraska',nv:'nevada',nh:'new hampshire',nj:'new jersey',nm:'new mexico',ny:'new york',nc:'north carolina',nd:'north dakota',oh:'ohio',ok:'oklahoma',or:'oregon',pa:'pennsylvania',ri:'rhode island',sc:'south carolina',sd:'south dakota',tn:'tennessee',tx:'texas',ut:'utah',vt:'vermont',va:'virginia',wa:'washington',wv:'west virginia',wi:'wisconsin',wy:'wyoming',as:'american samoa',dc:'district of columbia',gu:'guam',mp:'northern mariana islands',mq:'midway island',pr:'puerto rico',vi:'virgin islands',wq:'wake island'}});;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/twc_typeahead/twc_alias.value.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/social_sharing/social_sharing.app.js. */
twc.social_sharing=twc.social_sharing||{};twc.social_sharing.app=twc.social_sharing.app||angular.module('social_sharing',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/social_sharing/social_sharing.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/title_video_collection/title_video_collection.app.js. */
twc.title_video_collection=twc.title_video_collection||{};twc.title_video_collection.app=twc.title_video_collection.app||angular.module('title_video_collection',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/title_video_collection/title_video_collection.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_player/video_player.app.js. */
twc.video_player=twc.video_player||{};twc.video_player.app=twc.video_player.app||angular.module('video_player',[]);twc.video_player.app.factory('browserDetectionFactory',function(){return{playerMode:'auto',getBusinessRules:function(){var userAgent=navigator.userAgent.toLowerCase();if(userAgent.indexOf('safari')!==-1)if(userAgent.indexOf('chrome')===-1)this.playerMode="html";return this.playerMode}}});;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_player/video_player.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/videoplayer_amp/video_player.directive.js. */
twc.shared.apps.directive("videoAmp",['$rootScope','$http','$q','$window','videoplayerFactory','videoprerollFactory','VideoMetricsFactory','MediaAssetFactory','customEvent','videoPlayerSettings','pcoUser',function($rootScope,$http,$q,$window,videoplayerFactory,videoprerollFactory,VideoMetricsFactory,MediaAssetFactory,customEvent,videoPlayerSettings,pcoUser){var adBypassCookie=jQuery.cookie('noads'),flashBypassCookie=jQuery.cookie('noflash'),browserInfo=pcoUser.getBrowser(),mediaEndedEvent=customEvent.getEvent('mediaEnded'),newAssetEvent=customEvent.getEvent('newAsset'),changePlayerStateEvent=customEvent.getEvent('changePlayerState'),dfpLoadedEvent=customEvent.getEvent('dfpLoaded'),pcoReadyEvent=customEvent.getEvent('pcoReady'),siteCatalystReadyEvent=customEvent.getEvent('utagReady'),videoAdStatus=customEvent.getEvent('videoAdStatus'),playerLoadedEvent=customEvent.getEvent('playerLoaded'),currentAdPolicy,videoamp_config_url=$window.location.protocol==="https:"?videoPlayerSettings.common.secure_config:videoPlayerSettings.common.nonsecure_config,videoMetricsFactoryObject,adsObjectFromPco,pageObjectFromPco,logger=$rootScope.$log.getInstance('videoAmp'),adPolicies=videoPlayerSettings.adPolicies,playerConfigOverridesList=videoPlayerSettings.playerConfigOverridesList;changePlayerStateEvent.progress(function(event,data){var state=('state'in data)?data.state:'';if(customEvent.getEvent("playerLoaded").state()==="pending"||ampHandler.playerState.isDestroyed())return;if(state){switch(state){case"play":logger.debug('player should play');ampHandler.amp.play();break;case"pause":case"stop":logger.debug('player should stop');ampHandler.amp.pause();break;default:return false};return this}else return false});var ampHandler={amp:{},assetId:undefined,moduleId:undefined,playerConfigOverrides:{},currentVideoSource:undefined,currentVideoData:{},currentDevice:videoplayerFactory.getDevice()||"desktop",companionPane:angular.element('.video-companion-pane'),mediaModulePane:angular.element('.companion-media-panel'),mediaModuleExists:false,companionFading:false,adIsPlaying:false,firstPlay:true,mediaSlotCookieName:"videoamp",playerState:{playerId:undefined,playerAdPosition:undefined,isDestroyed:function(){try{ampHandler.amp.getAutoplay();return false}catch(e){return true}}},currentVideoState:{midpointNeverCrossed:true,initialMediaPlay:true,initialAdPlay:true,init:function(){this.midpointNeverCrossed=true;this.initialMediaPlay=true;this.initialAdPlay=true;ampHandler.adIsPlaying=false}},getCompanionPositions:function(){return videoprerollFactory.getCompanionPositions(TWC.pco.get("ad"))},removeCompanion:function(callback){var _this=this;this.companionFading=true;this.companionPane.fadeOut(function(){_this.companionFading=false;customEvent.getEvent('triggerAdText').notify({state:"hide"});var companionPositions=_this.getCompanionPositions();for(var i=0;i<companionPositions.length;i++)angular.element("#"+companionPositions[i]).empty();if(typeof callback==="function")callback()})},hasCompanion:function(){if(this.companionFading){logger.debug('companion is fading, returning false');return false};var companionPositions=this.getCompanionPositions();for(var i=0;i<companionPositions.length;i++){var elm=angular.element("#"+companionPositions[i]).html();if(elm.indexOf('img')>0||elm.indexOf('iframe')>0)return true};logger.debug('no companion here');return false},triggerCompanion:function(){var _this=this,companionTrigger={companionTimer:'',setup:function(){this.clearTimer();this.companionTimer=setTimeout(function(){if(_this.hasCompanion()){if(_this.mediaModuleExists){if(_this.mediaModulePane.css('display')==="none"){_this.companionPane.fadeIn(function(){_this.companionFading=false})}else _this.mediaModulePane.fadeOut("fast",function(){_this.companionFading=true;_this.companionPane.fadeIn(function(){_this.companionFading=false})})}else _this.companionPane.fadeIn();customEvent.getEvent('triggerAdText').notify({state:"show"})}else if(_this.mediaModuleExists)_this.mediaModulePane.fadeIn()},400)},clearTimer:function(){if(typeof this.companionTimer==="number")window.clearTimeout(this.companionTimer)}};companionTrigger.setup()},mediaModuleTrigger:function(){var _this=this,mediaModuleFade={mmTimer:'',setup:function(){logger.debug('setting up media module');this.clearTimer();this.mmTimer=setTimeout(function(){_this.mediaModulePane.fadeIn()},400)},clearTimer:function(){if(typeof this.mmTimer==="number")window.clearTimeout(this.mmTimer)}};mediaModuleFade.setup()},incrementMediaSlotCookie:function(){var mediaSlotNo=angular.element.cookie(this.mediaSlotCookieName);mediaSlotNo=mediaSlotNo?parseInt(mediaSlotNo):0;this.setCookie(this.mediaSlotCookieName,(mediaSlotNo+1))},setCookie:function(cookiename,value,expiremins){var expires=new Date(new Date().getTime()+((expiremins||30)*60*1e3));angular.element.cookie(cookiename,value,{path:'/',domain:'.weather.com',expires:expires})},isAdsSlot:function(){if(!currentAdPolicy.adsToMediaRatio||currentAdPolicy.adsToMediaRatio[0]<=0||currentAdPolicy.adsToMediaRatio[1]<=0||currentAdPolicy.firstAdPlaySlot>currentAdPolicy.adsToMediaRatio[1]){logger.debug("Bad ad policy to determine ad slot");return false};var mediaSlotNo=angular.element.cookie(this.mediaSlotCookieName),normSequenceSlotNo=mediaSlotNo%currentAdPolicy.adsToMediaRatio[1]===0?currentAdPolicy.adsToMediaRatio[1]:mediaSlotNo%currentAdPolicy.adsToMediaRatio[1];if(normSequenceSlotNo<currentAdPolicy.firstAdPlaySlot){logger.debug("Current slot no too early to play ads");return false};if(normSequenceSlotNo>=currentAdPolicy.firstAdPlaySlot+parseInt(currentAdPolicy.adsToMediaRatio[0])){logger.debug("Ads ratio fulfilled - not playing any more ads in this sequence");return false};logger.debug("Ad policy allows playing ads");return true},init:function(scope){logger.debug("init Start");this.playerState.playerId=scope.playerId;this.assetId=scope.assetId;this.playerConfigOverrides=playerConfigOverridesList[this.playerState.playerId]||playerConfigOverridesList["default"];this.playerState.playerAdPosition=scope.playerAdPosition;this.moduleId=scope.moduleId;playerLoadedEvent=jQuery.Deferred();if(this.mediaModulePane.length>0)this.mediaModuleExists=true;if(this.playerConfigOverrides){this.playerConfigOverrides.mode=flashBypassCookie==="true"?'html':(browserInfo.safari?'html':'auto');logger.debug('player mode is: '+this.playerConfigOverrides.mode)};currentAdPolicy=adPolicies[this.playerState.playerId]||adPolicies["default"];if(!currentAdPolicy)logger.debug("No Ad Policy provided - no ads will be played");if(typeof adBypassCookie!=="undefined")currentAdPolicy.showAds=adBypassCookie==="true"?false:true;videoMetricsFactoryObject=new VideoMetricsFactory(this.playerConfigOverrides.twcData.playerMetricsPosition,this.moduleId);this.playerConfigOverrides.domain=this.playerConfigOverrides.twcData.playerMetricsPosition;this.playerConfigOverrides.twcDevice=videoMetricsFactoryObject.getQoSDevice(this.currentDevice);this.amp=new akamai.amp.AMP(this.playerState.playerId,this.playerConfigOverrides,jQuery.proxy(this.readyHandler,this));logger.debug("init End")},setVideo:function(videoData){var _this=this;if(!videoData||videoData.getType()!=="video"){logger.debug("Invalid asset type");logger.debug(videoData);return};var testPlayerReady=false;try{testPlayerReady=this.amp.getAutoplay()}catch(err){customEvent.removeEvent("playerLoaded")};if(customEvent.getEvent("playerLoaded").state()==="pending"){customEvent.getEvent("playerLoaded").done(function(){_this.setVideo(videoData)});return};if(currentAdPolicy.showAds&&dfpLoadedEvent.state()==="pending"){logger.debug("DFP is not loaded (for ads) - will defer setting video until then:",videoData);dfpLoadedEvent.done(function(){logger.debug("dfpLoaded resolved - now setting video:",videoData);adsObjectFromPco=TWC&&TWC.pco&&TWC.pco.get("ad")&&TWC.pco.get("ad").attributes;_this.setVideo(videoData)});return}else adsObjectFromPco=TWC&&TWC.pco&&TWC.pco.get("ad")&&TWC.pco.get("ad").attributes;if(siteCatalystReadyEvent.state()==="pending"){logger.debug("Site Catalyst is not ready (for metrics) - will defer setting video until then:");logger.debug(videoData);siteCatalystReadyEvent.done(function(){logger.debug("siteCatalystReady resolved - now setting video:");logger.debug(videoData);_this.setVideo(videoData)});return};this.incrementMediaSlotCookie();window.dynamicAdTagUrl=null;if(currentAdPolicy.showAds&&(videoData.getCollectionData().getSponsored()||this.isAdsSlot())){logger.debug("showAds="+currentAdPolicy.showAds,"sponsored="+videoData.getCollectionData().getSponsored(),"isadsslot="+this.isAdsSlot());if(adsObjectFromPco&&this.playerState.playerAdPosition)try{window.dynamicAdTagUrl=videoprerollFactory.buildAdPolicyAndGetCall(currentAdPolicy,adsObjectFromPco,videoData,this.playerState,pageObjectFromPco.content)}catch(ex){logger.error("Error building ad tag. Will continue without ads.",ex,currentAdPolicy,adsObjectFromPco,videoData,this.playerState,pageObjectFromPco)}};var videoDataAmp=videoplayerFactory.formatClipData(videoData);if(this.playerConfigOverrides.autoplay===true&&this.currentDevice.toLowerCase()==="desktop")videoDataAmp.channel.item["media-group"]["media-thumbnail"]["@attributes"].url="";this.currentVideoData=videoData;this.amp.feed.setData(videoDataAmp);this.currentVideoState.init();videoMetricsFactoryObject.init()},readyHandler:function(event){logger.debug("readyHandler Start");this.amp.addEventListener("ended",jQuery.proxy(this.endedHandler,this));this.amp.addEventListener("loadstart",jQuery.proxy(this.loadstartHandler,this));this.amp.addEventListener("loadedmetadata",jQuery.proxy(this.loadedmetadataHandler,this));this.amp.addEventListener("progress",jQuery.proxy(this.progressHandler,this));this.amp.addEventListener("seeking",jQuery.proxy(this.seekingHandler,this));this.amp.addEventListener("seeked",jQuery.proxy(this.seekedHandler,this));this.amp.addEventListener("play",jQuery.proxy(this.playHandler,this));this.amp.addEventListener("pause",jQuery.proxy(this.pauseHandler,this));this.amp.addEventListener("playing",jQuery.proxy(this.playingHandler,this));this.amp.addEventListener("fullscreenchange",jQuery.proxy(this.fullscreenHandler,this));this.amp.addEventListener("timeupdate",jQuery.proxy(this.timeupdateHandler,this));if(typeof this.amp.ads!=="undefined"){this.amp.ads.addEventListener("started",jQuery.proxy(this.adStartedHandler,this));this.amp.ads.addEventListener("ended",jQuery.proxy(this.adEndedHandler,this));this.amp.ads.addEventListener("companion",jQuery.proxy(this.companionHandler,this));this.amp.ads.addEventListener("error",jQuery.proxy(this.errorHandler,this))};if(typeof this.amp.autoadvance!=="undefined")this.amp.autoadvance.addEventListener("advance",jQuery.proxy(this.advanceHandler,this));if(typeof this.amp.recommendations!=="undefined")this.amp.recommendations.addEventListener("selected",jQuery.proxy(this.selectedHandler,this));if(typeof this.amp.share!=="undefined")this.amp.share.addEventListener("share",jQuery.proxy(this.shareHandler,this));if(typeof this.amp.auth!=="undefined")this.amp.auth.addEventListener("authenticated",jQuery.proxy(this.authenticatedHandler,this));customEvent.getEvent("playerLoaded").resolve();logger.debug("readyHandler: End")},endedHandler:function(event){videoMetricsFactoryObject.track('videoEnd',pageObjectFromPco,this.currentVideoData,event.player,null,this.currentVideoState);mediaEndedEvent.notify(this.currentVideoData);if(event.player.getConfig().mode==="html")if(ampHandler.currentDevice!=="desktop")event.player.exitFullScreen();logger.debug("Video ended")},loadstartHandler:function(event){logger.debug("loadstartHandler")},loadedmetadataHandler:function(event){logger.debug("loadedmetadataHandler")},progressHandler:function(event){},seekingHandler:function(event){},seekedHandler:function(event){},playHandler:function(event){logger.debug("Now playing content: "+(event.player&&event.player.getSrc&&event.player.getSrc()));var _this=this,videoCompanionStatus=this.hasCompanion();if(this.currentVideoState.initialMediaPlay){videoAdStatus.notify({state:"videoPlaying",hasCompanion:videoCompanionStatus});if(!videoCompanionStatus&&this.mediaModuleExists)this.mediaModuleTrigger()};if(this.adIsPlaying){videoMetricsFactoryObject.track('adPlay',pageObjectFromPco,this.currentVideoData,event.player,null,this.currentVideoState)}else videoMetricsFactoryObject.track('videoPlay',pageObjectFromPco,this.currentVideoData,event.player,null,this.currentVideoState);if(!this.adIsPlaying)this.currentVideoState.initialMediaPlay=false;if(this.firstPlay===true){this.firstPlay=false;this.amp.setAutoplay(true)}},pauseHandler:function(event){if(this.adIsPlaying){videoMetricsFactoryObject.track('adPause',pageObjectFromPco,this.currentVideoData,event.player,null,this.currentVideoState)}else videoMetricsFactoryObject.track('videoPause',pageObjectFromPco,this.currentVideoData,event.player,null,this.currentVideoState)},playingHandler:function(event){},timeupdateHandler:function(event){},adStartedHandler:function(event){logger.debug("Now playing ad: "+event.data.title);var hasMetadata=(('data'in event)&&event.data!==null)?true:false;this.adIsPlaying=true;videoAdStatus.notify({state:"started",hasCompanion:this.hasCompanion()});videoMetricsFactoryObject.track('adPlay',pageObjectFromPco,this.currentVideoData,event.player,event.data,this.currentVideoState);this.triggerCompanion();this.currentVideoState.initialAdPlay=false},adEndedHandler:function(event){this.adIsPlaying=false;videoAdStatus.notify({state:"ended",hasCompanion:this.hasCompanion()});videoMetricsFactoryObject.track('adEnd',pageObjectFromPco,this.currentVideoData,event.player,event.data,this.currentVideoState)},companionHandler:function(event){this.triggerCompanion();logger.debug("companionHandler")},advanceHandler:function(event){logger.debug("advanceHandler")},selectedHandler:function(event){},shareHandler:function(event){},authenticatedHandler:function(event){},fullscreenHandler:function(event){videoMetricsFactoryObject.track('fullscreen',pageObjectFromPco,this.currentVideoData,event.player,null,this.currentVideoState)},errorHandler:function(event){if(event&&event.data&&event.data.error){var errordata="";for(var key in event.data.error)if(event.data.error.hasOwnProperty(key))errordata+=event.data.error[key]+"/";logger.error(errordata)}}};akamai.amp.AMP.loadDefaults(videoamp_config_url);return{restrict:"A",scope:{playerId:'@id',assetId:'@',playerAdPosition:'@',moduleId:'@'},link:function(scope,element,attrs){attrs.$observe('assetId',function(newAssetId){if(!newAssetId)return;logger.debug("video-amp: setting player assetId to:");logger.debug(newAssetId);MediaAssetFactory.getMediaAssetData({id:"videoData",assetId:newAssetId})["then"](function(videoData){logger.debug("response"+videoData);if(videoData)ampHandler.setVideo(videoData)})});ampHandler.init(scope);newAssetEvent.progress(function(videoData){logger.debug("on: newAsset:",videoData);if(ampHandler.hasCompanion()){ampHandler.removeCompanion(function(){ampHandler.setVideo(videoData)})}else ampHandler.setVideo(videoData)});pcoReadyEvent.done(function(){pageObjectFromPco=TWC&&TWC.pco&&TWC.pco.get("page")&&TWC.pco.get("page").attributes});scope.$on('$destroy',function(){if((ampHandler.amp!==undefined)&&(ampHandler.amp!==null))ampHandler.amp.destroy()})}}}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/videoplayer_amp/video_player.directive.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/videoplayer_amp/videometrics.factory.js. */
twc.shared.apps.factory('VideoMetricsFactory',['$rootScope','customEvent','TwcClass',function($rootScope,customEvent,TwcClass){var logger=$rootScope.$log.getInstance('videometricsfactory');return TwcClass.extend({construct:function(playerName,moduleId){this.playerName=playerName;this.moduleId=moduleId},init:function(){this.mediaAdHasPlayed=false},trackStringEvent:customEvent.getEvent("track-string-event"),playerName:"AMP - Undefined Video Player",mediaAdHasPlayed:false,getMediaOffset:function(playerMetaData){return Math.floor(playerMetaData.getCurrentTime())},getMediaAdOffset:function(playerMetaData){return Math.floor((playerMetaData&&playerMetaData.getCurrentTime())||0)},currentData:{mediaName:"",mediaLength:"",mediaAdName:"",mediaAdLength:""},setCurrentMediaData:function(playerMetaData,videoMetaData){this.currentData.mediaName=videoMetaData.getTitle();this.currentData.mediaLength=Math.floor(playerMetaData.getDuration())},setCurrentMediaAdData:function(adMetaData){this.currentData.mediaAdName=adMetaData&&adMetaData.title||(adMetaData.metadata&&adMetaData.metadata.ord)+"-ad";this.currentData.mediaAdLength=adMetaData&&adMetaData.duration&&Math.floor(adMetaData.duration);if(this.currentData.mediaAdLength<0)this.currentData.mediaAdLength=(adMetaData&&adMetaData.metadata&&adMetaData.metadata.estimatedDuration)||0},setSData:function(videoMetaData,pcoPageData){var dynamicFromStr=jQuery.cookie("fromStr");s.pageURL=document.location.href;s.eVar58=videoMetaData.getProviderName&&videoMetaData.getProviderName()||"no-provider-data";s.eVar59=videoMetaData.getMarketId&&videoMetaData.getMarketId()||"no-market-data";s.eVar44=dynamicFromStr||pcoPageData.fromStr;s.eVar46=this.currentData.mediaName;s.prop23=this.currentData.mediaName;s.eVar47=(videoMetaData.getPrimaryCollectionId()||"").replace(/\//g,"_");s.eVar48=this.playerName;s.eVar63=videoMetaData.getId();s.eVar64=videoMetaData.getType();s.eVar60=utag_data['js_page.partner3']},trackString:function(trackString,attrs){this.trackStringEvent.notify({module_id:this.moduleId,trackStr:trackString,attrs:attrs})},track:function(type,pcoPageData,videoMetaData,playerMetaData,adMetaData,currentVideoState){logger.debug("Tracking Type: "+type);if(!type||!videoMetaData||(adMetaData&&!playerMetaData)){logger.debug("Invalid metrics tracking call: type="+type+",videoMetaData="+videoMetaData+",playerMetaData="+playerMetaData);logger.error("Invalid metrics tracking call: type="+type+",videoMetaData="+videoMetaData+",playerMetaData="+playerMetaData);return};switch(type){case"fullscreen":this.trackString('video-fullscreen-click');break;case"adPlay":this.mediaAdHasPlayed=true;if(currentVideoState.initialAdPlay){this.setCurrentMediaAdData(adMetaData);this.setCurrentMediaData(playerMetaData,videoMetaData);this.setSData(videoMetaData,pcoPageData);s.Media.openAd(this.currentData.mediaAdName,this.currentData.mediaAdLength,this.playerName,this.currentData.mediaName)};s.Media.play(this.currentData.mediaAdName,this.getMediaAdOffset(playerMetaData));break;case"adPause":s.Media.stop(this.currentData.mediaAdName,this.getMediaAdOffset(playerMetaData));break;case"adEnd":s.Media.stop(this.currentData.mediaAdName,this.currentData.mediaAdLength);s.Media.close(this.currentData.mediaAdName);break;case"videoPlay":s.Media.contextDataMapping["a.media.view"]=this.mediaAdHasPlayed?"event15":"event13,event15";if(currentVideoState.initialMediaPlay){this.setCurrentMediaData(playerMetaData,videoMetaData);this.setSData(videoMetaData,pcoPageData);s.Media.open(this.currentData.mediaName,this.currentData.mediaLength,this.playerName)};s.Media.play(this.currentData.mediaName,this.getMediaOffset(playerMetaData));break;case"videoPause":s.Media.stop(this.currentData.mediaName,this.getMediaOffset(playerMetaData));break;case"videoEnd":s.Media.stop(this.currentData.mediaName,this.getMediaOffset(playerMetaData));s.Media.close(this.currentData.mediaName);break};return this},getQoSDevice:function(deviceString){switch(deviceString.toLowerCase()){case"iphone":return"iPhone";case"ipad":return"iPad";case"android":return"Android Device";case"desktop":return"Desktop";default:return"Other"}}})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/videoplayer_amp/videometrics.factory.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/videoplayer_amp/videoplayer.factory.js. */
twc.shared.apps.factory('videoplayerFactory',["dsxclient","$q",'twcConstant',function(dsxclient,$q,twcConstant){var sizeCodeToDim={1:"85x64",2:"85x64",3:"85x64",4:"85x64",5:"155x155",6:"155x114",7:"320x260",8:"320x180",9:"485x273",10:"650x366",11:"815x458",12:"980x551",15:"640x598"}
function getMimeType(filename){var extension=(/[.]/.exec(filename))?/[^.]+$/.exec(filename):[],mime;switch(extension[0]){case"mp4":case"mov":mime="video/mp4";break;case"mpeg":mime="video/mpeg";break;case"mp4a":mime="audio/mp4";break;case"flv":mime="video/x-flv";break;case"m3u8":mime="application/x-mpegURL";break;case"ts":mime="video/MP2T";break;case"3gp":mime="video/3gpp";break;case"avi":mime="video/x-msvideo";break;case"wmv":mime="video/x-ms-wmv";break;default:mime="";break};return mime}
function rawToAmpFormat(rawClipData,sizeCode){var hdsVariant=rawClipData.getVariant("hds")||rawClipData.getVariant("video")||rawClipData.getAssetUrl(),hdsMimeType=getMimeType(hdsVariant),hlsVariant=rawClipData.getVariant("hls")||rawClipData.getVariant("video")||rawClipData.getAssetUrl(),hlsMimeType=getMimeType(hlsVariant),pdlVariant=rawClipData.getVariant("video")||rawClipData.getAssetUrl(),pdlMimeType=getMimeType(pdlVariant),videosForABR=["2fc8581d-2b57-434c-9f8c-34ed3b76b0bd","bc823e3d-d76a-45d4-bfc4-1f620ac5cc13"];if(videosForABR.indexOf(rawClipData.getId())===-1){hlsVariant=hdsVariant=pdlVariant;hlsMimeType=hdsMimeType=pdlMimeType};var clipData={"@attributes":{version:"1.0.1"},channel:{category:rawClipData.getPrimaryCollectionId(),pubDate:rawClipData.getPublishDate(),language:"en",ttl:"10",item:{twcdata:{test1:"test1Value"},title:rawClipData.getTitle(),link:"http://www.weather.com/video",description:rawClipData.getDescription(),category:rawClipData.getPrimaryCollectionId(),pubDate:rawClipData.getPublishDate(),guid:rawClipData.getId(),"media-group":{"media-content":[{"@attributes":{isDefault:"false",url:hdsVariant,type:hdsMimeType,medium:"video",duration:rawClipData.durationInSeconds},"media-category":{"@attributes":{schema:"http://mrss.akamai.com/user_agent_hint",label:"HDS_ALL"}}},{"@attributes":{isDefault:"false",url:hlsVariant,type:hlsMimeType,medium:"video",duration:rawClipData.durationInSeconds},"media-category":{"@attributes":{schema:"http://mrss.akamai.com/user_agent_hint",label:"HLS_ALL"}}},{"@attributes":{isDefault:"true",url:pdlVariant,type:pdlMimeType,medium:"video",duration:rawClipData.durationInSeconds},"media-category":{"@attributes":{schema:"http://mrss.akamai.com/user_agent_hint",label:"PDL_LOW"}}}],"media-title":rawClipData.getTitle(),"media-description":rawClipData.getDescription(),"media-embed":{"@attributes":{url:"http://player.js",width:"604",height:"341"},"media-param":{"@attributes":{name:"type"},"#text":"text/javascript"}},"media-subTitle":{"@attributes":{type:"application/ttml+xml",lang:"en",href:""}},"media-thumbnail":{"@attributes":{url:rawClipData.getVariant(16)||rawClipData.getLargeThumbUrl(),width:"1280",height:"720"}}}}}};return clipData};return{formatClipData:function(rawClipData,sizeCode){rawClipData.durationInSeconds=this.getFormattedTime(rawClipData.getDuration());rawClipData.category=rawClipData.getPrimaryCollectionId();rawClipData.subCategory=rawClipData.getPrimaryCollectionId();return rawToAmpFormat(rawClipData,sizeCode)},xmlToJson:function(xml){var obj={};if(xml.nodeType===1){if(xml.attributes.length>0){obj["@attributes"]={};for(var j=0;j<xml.attributes.length;j++){var attribute=xml.attributes.item(j);obj["@attributes"][attribute.nodeName]=attribute.nodeValue}}}else if(xml.nodeType===3)obj=xml.nodeValue;if(xml.hasChildNodes())for(var i=0;i<xml.childNodes.length;i++){var item=xml.childNodes.item(i),nodeName=item.nodeName;if(typeof(obj[nodeName])==="undefined"){obj[nodeName]=this.xmlToJson(item)}else{if(typeof(obj[nodeName].push)==="undefined"){var old=obj[nodeName];obj[nodeName]=[];obj[nodeName].push(old)};obj[nodeName].push(this.xmlToJson(item))}};return obj},getFormattedTime:function(time){var splitTime,hours,minutes,seconds;if(!time)return'';time=time?String(time):'0';if(time.indexOf(':')>-1){splitTime=time.split(':')}else return time;if(splitTime.length===2){hours=0;minutes=parseInt(splitTime[0])||0;seconds=parseInt(splitTime[1])||0}else{hours=parseInt(splitTime[0])||0;minutes=parseInt(splitTime[1])||0;seconds=parseInt(splitTime[2])||0};if(hours&&hours!==0)hours=hours*3600;if(minutes&&minutes!==0)minutes=minutes*60;seconds=Math.round(hours+minutes+seconds);return seconds},getAssetData:function(assetId){var assetIdConfig={$id:'videoData',recordType:"cms",recordName:"aidQ",assetId:assetId};return dsxclient.execute([assetIdConfig])},getDevice:function(){if(/iPhone/.test(navigator.platform)||/iPhone/.test(navigator.userAgent)){return"iphone"}else if(/iPad/.test(navigator.platform)||/iPad/.test(navigator.userAgent)){return"ipad"}else if(/Android/.test(navigator.userAgent)){return"android"}else if(/Mac|Win32/.test(navigator.platform)){return"desktop"}else return"other"}}}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/videoplayer_amp/videoplayer.factory.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/videoplayer_amp/videopreroll.factory.js. */
twc.shared.apps.factory('videoprerollFactory',function(){return{_setOrReplaceParam:function(inputUrl,paramName,paramValue){var queryParam=paramName+"="+paramValue,index=inputUrl.indexOf(paramName+"=");if(index!==-1){var nextQueryParam=inputUrl.indexOf("&",index)!==-1?inputUrl.substring(inputUrl.indexOf("&",index)):'';return inputUrl.substring(0,index)+queryParam+nextQueryParam};return inputUrl+"&"+queryParam},getCompanionPositions:function(adObject){if(!adObject)return;return Object.keys(adObject.attributes.ad_video_companions||{})},buildAdPolicyAndGetCall:function(adPolicy,adData,videoData,playerData,contentType){var gptPlayerPosition,gptPlayerSize,pcoAdsClientData,adUnitAndZone,adUnit,adZone;if(typeof adPolicy==="undefined"||typeof adData==="undefined"||typeof videoData==="undefined"||typeof playerData==="undefined")return;pcoAdsClientData=adData.ads_ctrld_clientside&&playerData.playerAdPosition&&adData.ads_ctrld_clientside[playerData.playerAdPosition];adUnit=adData.NCTAU.adUnit;if(contentType==="video"){adZone=videoData.getCollectionData()&&videoData.getCollectionData().getAdMetrics()&&videoData.getCollectionData().getAdMetrics().video&&videoData.getCollectionData().getAdMetrics().video.zone||"";if(!adZone)adZone=adData.NCTAU.zone;adZone+=adData.NCTAU.beta?"/beta":""}else adZone=adData.NCTAU.zone;if(typeof pcoAdsClientData==="undefined"||typeof adUnit==="undefined"||typeof adZone==="undefined")return;gptPlayerPosition=pcoAdsClientData.pos;gptPlayerSize=(pcoAdsClientData.sizes instanceof Array)&&pcoAdsClientData.sizes.length>0&&pcoAdsClientData.sizes[0].join("x");if(typeof gptPlayerPosition==="undefined"||typeof gptPlayerSize==="undefined")return;adPolicy.adServerURL=this._setOrReplaceParam(adPolicy.adServerURL,"pos",gptPlayerPosition);adPolicy.adServerURL=this._setOrReplaceParam(adPolicy.adServerURL,"sz",gptPlayerSize);adPolicy.adServerURL=this._setOrReplaceParam(adPolicy.adServerURL,"correlator",TWC.PcoUtils.genRandStr(16));adPolicy.adServerURL=this._setOrReplaceParam(adPolicy.adServerURL,"iu",adUnit+"/"+adZone);adPolicy.adServerURL=this._setOrReplaceParam(adPolicy.adServerURL,"descriptionURL",window.location.href);adPolicy.adServerURL=this._setOrReplaceParam(adPolicy.adServerURL,"mediaURL",videoData.getAssetUrl());adPolicy.custParamsString=adData.cust_params;adPolicy.custParamsString=adPolicy.custParamsString.replace(/\&lat[^\&]+/,"");adPolicy.custParamsString=adPolicy.custParamsString.replace(/\&lon[^\&]+/,"");adPolicy.custParamsString=this._setOrReplaceParam(adPolicy.custParamsString,"lnid",(videoData.getPrimaryCollectionId()).replace(/\//g,"_"));adPolicy.custParamsString=this._setOrReplaceParam(adPolicy.custParamsString,"pos",gptPlayerPosition);adPolicy.custParamsString=this._setOrReplaceParam(adPolicy.custParamsString,"plID",playerData.playerId);adPolicy.custParamsString=this._setOrReplaceParam(adPolicy.custParamsString,"ttID",videoData.getId());adPolicy.custParamsString=this._setOrReplaceParam(adPolicy.custParamsString,"cue","pre");adPolicy.custParamsString+="&"+adPolicy.playerCustParamsAdd;return adPolicy.adServerURL+"&cust_params="+encodeURIComponent(adPolicy.custParamsString)}}});;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/videoplayer_amp/videopreroll.factory.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_metadata/video_metadata.app.js. */
twc.video_metadata=twc.video_metadata||{};twc.video_metadata.app=twc.video_metadata.app||angular.module('video_metadata',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_metadata/video_metadata.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_companion_text/video_companion_text.app.js. */
twc.video_companion_text=twc.video_companion_text||{};twc.video_companion_text.app=twc.video_companion_text.app||angular.module('video_companion_text',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_companion_text/video_companion_text.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_playlist/video_playlist.app.js. */
twc.video_playlist=twc.video_playlist||{};twc.video_playlist.app=twc.video_playlist.app||angular.module('video_playlist',['ngSanitize']);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_playlist/video_playlist.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/taboola_module/taboola_module.app.js. */
twc.taboola_module=twc.taboola_module||{};twc.taboola_module.app=twc.taboola_module.app||angular.module('taboola_module',['ngSanitize']);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/taboola_module/taboola_module.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/footer/footer.app.js. */
twc.footer=twc.footer||{};twc.footer.app=twc.footer.app||angular.module('footer',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/footer/footer.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_page_nav/video_page_nav.app.js. */
twc.video_page_nav=twc.video_page_nav||{};twc.video_page_nav.app=twc.video_page_nav.app||angular.module('video_page_nav',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_page_nav/video_page_nav.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/cobrand_headers/cobrand_headers.app.js. */
twc.cobrand_headers=twc.cobrand_headers||{};twc.cobrand_headers.app=twc.cobrand_headers.app||angular.module('cobrand_headers',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/cobrand_headers/cobrand_headers.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/breaking_now/breaking_now.app.js. */
twc.breaking_now=twc.breaking_now||{};twc.breaking_now.app=twc.breaking_now.app||angular.module('breaking_now',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/breaking_now/breaking_now.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/most_popular/most_popular.app.js. */
twc.most_popular=twc.most_popular||{};twc.most_popular.app=twc.most_popular.app||angular.module('most_popular',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/most_popular/most_popular.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/content_media/content_media.app.js. */
twc.content_media=twc.content_media||{};twc.content_media.app=twc.content_media.app||angular.module('content_media',[]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/content_media/content_media.app.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_main_menu/header_main_menu.controller.js. */
twc.header_main_menu.app.controller('twc_header_main_menu_controller',['$scope','$timeout','customEvent','twcUtil',function($scope,$timeout,customEvent,twcUtil){'use strict';var vars={userCookie:(jQuery.cookie('uplogin'))?true:false},func={clickThru:function(url,target){if(url)window.open(url,target)},hideShowAlertButton:function(){return(vars.userCookie===true)},hideSignInButton:function(){return(vars.userCookie===true)},showHideMyProfileButton:function(){return(vars.userCookie===true)},myProfileClickToggle:function(){if($scope.myProfileLinksShown){$scope.myProfileLinksShown=false}else $scope.myProfileLinksShown=true},showMyProfileLinks:function(){$scope.myProfileLinksShown=true},hideMyProfileLinks:function(){$scope.myProfileLinksShown=false}};$scope.clickThru=func.clickThru;$scope.subNavMenuOpen=false;$scope.myProfileLinksShown=false;$scope.showHideMyProfileButton=func.showHideMyProfileButton;$scope.hideShowAlertButton=func.hideShowAlertButton;$scope.hideSignInButton=func.hideSignInButton;$scope.showMyProfileLinks=func.showMyProfileLinks;$scope.hideMyProfileLinks=func.hideMyProfileLinks;$scope.myProfileClickToggle=func.myProfileClickToggle}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_main_menu/header_main_menu.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/search/search.controller.js. */
twc.search.app.controller('twc_search_controller',['$scope','$timeout','$controller','$filter','$q','DrupalSettings','settings','dsxclient','httpclient','twcConfig','pcoUser','twcUtil','customEvent','aliases','twcConstant','$injector','logger',function($scope,$timeout,$controller,$filter,$q,DrupalSettings,settings,dsxclient,httpclient,twcConfig,pcoUser,twcUtil,customEvent,aliases,twcConstant,$injector,logger){'use strict';$controller('baseSearchController',{$scope:$scope});var p=$scope.params;p.minChar=settings&&settings.minChar?parseInt(settings.minChar):3;p.resultLimit=settings&&settings.resultLimit?parseInt(settings.resultLimit):10;p.suppressRecentSearches=settings&&settings.suppress_recent_searches?JSON.parse(settings.suppress_recent_searches):false;p.settings=settings;p.moduleId=settings.module_id;var searchVis=false;$scope.createLocArray(settings.loc_type);var goToEnhance=function(term){location.href=twcConstant.pageUrl[p.moduleId]['enhance']+term+'&loctypes='+p.locTypes+'&from='+p.moduleId},goToSkiEnhance=function(term){location.href=twcConstant.pageUrl[p.moduleId]['page']+term+'&loctypes='+twcConstant.locTypes.Ski+'&from='+p.moduleId},landingPage=function(key,item){addToRecentSearch.apply($scope,[item,'deferLandingPage'])},addToRecentSearch=function(item,callback){var key=item.getKey&&item.getKey()||item.getFullLocId&&item.getFullLocId();if(item&&!!item.data&&!$filter('twcFilter').getByProperty('key',key,$scope.getRecentSearches())&&!$filter('twcFilter').getByProperty('key',key,$scope.getSavedLocations())){var rs=$scope.getRecentSearches();customEvent.getEvent('locations_changed').progress(function(e){if(e.locations.length===10||e.locations.length>rs.length)$scope[callback](item)});$scope.saveRecentSearch(item)}else $scope[callback](item)},getLocationByZip=function(zip){$scope.getLocationByZip(zip).then(function(response){var res=response.getModel({recordType:"xweb",recordName:p.xwebRecords.webLoc,locale:'en_US',locTypes:'4/US/'+zip});if(res&&res.length===1){addToRecentSearch.apply(this,[res[0],'gotLocationByZip'])}else goToEnhance(zip)},function(error){})},getLocationByLocId=function(locId){if(locId&&!$filter('twcFilter').getByProperty('loc',locId,$scope.getRecentSearches())&&!$filter('twcFilter').getByProperty('loc',locId,$scope.getSavedLocations()))$scope.getLocationByLocId(locId).then(function(response){var res=response.getModel({recordType:"wxd",recordName:p.wxdRecords.loc,locale:'en_US',fullLocId:locId});if(res){landingPage(locId,$scope.getXwebLocFromLoc(res))}else goToEnhance(locId)},function(error){})},is121Match=function(item,term){if(item&&item.result&&item.result===p.noResult)return null;var match=term.indexOf(',')>0?term.split(','):term.split(' '),shortName=item.getCountryCode().toLowerCase(),name=(shortName==='us')?item.getStateCode().toLowerCase():item.getCountry().toLowerCase();angular.forEach(match,function(v,k){match[k]=v.trim()});return(jQuery.inArray(item.getCity().toLowerCase(),match)===0&&(jQuery.inArray(name,match)===1)||jQuery.inArray(shortName,match)===1)?item.getKey():null},isValidState=function(term){var st=term.toLowerCase();if(term.length===2&&aliases.state[st]){return st}else return null};$scope.goSelectItem=function(item){if(item){logger.debug('should go to today page if location is big city or an exactly match otherwise go to multi-results page.');var fromStr='',trackStr='',term=$scope.term.toLowerCase();$scope.term=item.autoSelect?term:item.getFormattedName($scope.$root.isMobile);if(!item.result&&(!item.autoSelect||item.autoSelect&&item.isBigCity()||$scope.results.length===1||item.getLocType()===twcConstant.locTypes.Airports&&term.length===3)){if(term.length===0){fromStr='recentsearchresolved';trackStr='recentsearch'}else{fromStr=(item.autoSelect?'localsearch':'typeahead');trackStr=(item.autoSelect?'localsearchresolved':'typeaheadresolved')};$scope.tracking(fromStr,trackStr);landingPage(item.getKey(),item)}else if(p.minChar===2&&!!isValidState(term)){$scope.tracking('localsearch','localsearchresolved');goToSkiEnhance(term)}else if(aliases.specialty[term]){$scope.tracking('localsearch','localsearchresolved');getLocationByLocId(aliases.specialty[term])}else{var match=is121Match(item,term);if(!!match){$scope.tracking('localsearch','localsearchresolved');landingPage(match,item)}else{trackStr=item.result?'localsearcherror':'localsearchresults';$scope.tracking('localsearch',trackStr);goToEnhance(term)}}}};$scope.showRecentSearches=function(){var suppressed=$scope.params.suppressRecentSearches;if($scope.$root.isMobile&&suppressed)$scope.results=$scope.getSavedLocations();return suppressed===true?'Suppressed':'Recent'};$scope.deferLandingPage=function(key){var theKey=typeof key==='object'?key.getKey():key;location.href=twcConstant.pageUrl[p.moduleId]['page']+theKey};$scope.gotLocationByZip=function(item){$scope.deferLandingPage(item.getKey())};$scope.placeHolder=settings.place_holder;$scope.term='';$scope.fromString=p.moduleId+'typeahead';$scope.config=[{recordType:"xweb",recordName:p.xwebRecords.webLoc,locTypes:''}];$scope.manageLocations=function(){location.href='/life/profile'};$scope.validate=function(value){var childScope=scope.$$childHead,valid=true;logger.debug('go search');if(value===scope.placeholderText){valid=false;childScope.$apply(function(){childScope.isValid=false})};return valid};$scope.getLocTypes=function(){return p.locTypes};$scope.searchVis=function(){return searchVis};$scope.toggleVis=function(){searchVis=!searchVis};$scope.$on('openLocationSearch',function(){$scope.toggleVis()})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/search/search.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_metadata/video_metadata.value.js. */
twc.video_metadata.app.value("providerMapping",{"weather.com":["TWC - Air","TWC - Digital","TWC - Long Form","TWC - Sponsored Vignette","TWC - VIDEO","TWC - Digital (Aggregate)","Multiple - 07 Days - Distro","Multiple - 07 Days - No Distro","Multiple - 14 Days - Distro","Multiple - 14 Days - No Distro","Multiple - 30 Days - Distro","Multiple - 30 Days - No Distro","Multiple - 60 Days - Distro","Multiple - 60 Days - No Distro","Multiple - No Expire - Distro","Multiple - No Expire - No Distro","TWC - Digital","TWC - Digital (Aggregate)","TWC - Digital (Mobile ONLY - No Distro)","TWC - Digital (Mobile Only)","TWC - Digital (No Distro)"],twc:["TWC - TV","TWC - TV (No Distro)","TWC - TV (Digital Original)","TWC - TV (Severe)","TWC - TV (Long Form)"]});;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_metadata/video_metadata.value.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/footer/footer.controller.js. */
twc.footer.app.controller('twc_footer_controller',['$scope','DrupalSettings','settings','dsxclient','twcConfig',function($scope,DrupalSettings,settings,dsxclient,twcConfig){'use strict';$scope.currentYear=new Date().getFullYear();if(angular.element('html').hasClass('lt-ie9')){$scope.isIE8=true}else $scope.isIE8=false}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/footer/footer.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/breaking_now/mock/responses.js. */
twc.breaking_now.app.value('BreakingNowMock_Severe',{title:"BREAKING NOW",headline:"ALERT: High Winds and Heavy Snow Pound the Coast of New England",link_url:"http://www.weather.com/news/tornado-central/severe-weather-tracker-page",color:"#AC050F",share:{type:"social"}}).value('BreakingNowMock_Severe_MFW',{title:"BREAKING NOW",headline:"ALERT: High Winds and Heavy Snow Pound the Coast of New England",link_url:"http://www.weather.com/news/tornado-central/severe-weather-tracker-page",color:"#AC050F",share:{type:"mfw",locations:[{type:"city_state",value:"Atlanta,Georgia"},{type:"city_state",value:"Duluth,Minnesota"}]}}).value('BreakingNowMock_Severe_MFW2',{title:"BREAKING NOW",headline:"ALERT: High Winds and Heavy Snow Pound the Coast of New England",link_url:"http://www.weather.com/news/tornado-central/severe-weather-tracker-page",color:"#DD552A",share:{type:"mfw",locations:[{type:"state",value:"Georgia"},{type:"state",value:"Minnesota"}]}}).value('BreakingNowMock_Severe_MFW3',{title:"BREAKING NOW",headline:"ALERT: High Winds and Heavy Snow Pound the Coast of New England",link_url:"http://www.weather.com/news/tornado-central/severe-weather-tracker-page",color:"#0E4274",share:{type:"mfw",locations:[{type:"geolocation",value:"37.7793,-122.419|50"}]}});;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/breaking_now/mock/responses.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_main_menu/header_main_menu.directives.js. */
twc.header_main_menu.app.directive('addDropDownImages',function(){"use strict";return{scope:true,restrict:'A',replace:'true',controller:['$scope','$element','dsxclient',function($scope,$element,dsxclient){'use-strict';var vars={dsxconfig:[],mapCode:6,images:{}},func={initDSXCall:function(){angular.forEach($element.find('.wx-subnav.right a'),function(item){var uuid=item.getAttribute("data-mm-subnav-image");if(uuid!==null&&uuid!=="")vars.dsxconfig.push({recordType:"cms",recordName:"aidQ",assetId:uuid})});func.executeDSXCall()},executeDSXCall:function(){if(vars.dsxconfig.length===0)return;dsxclient.execute(vars.dsxconfig).then(function(response){var body=response&&response.attrs&&response.attrs.data&&response.attrs.data.body,img_url,img_id;if(body){for(var key in body)if(!isNaN(key)&&body[key]&&body[key]["doc"]&&body[key]["doc"]["id"]&&body[key]["doc"]["variants"]){img_url=body[key]["doc"]["variants"][vars.mapCode];img_id=body[key]["doc"]["id"];vars.images[img_id]=img_url};func.appendImages()}})},appendImages:function(){angular.forEach($element.find('.wx-subnav.right a'),function(item){var uuid=item.getAttribute("data-mm-subnav-image"),image=vars.images[uuid];if(uuid!==null&&uuid!==""&&image)jQuery(item).prepend('<img class="wx-nav-content-img" width="160" height="90" alt="" src="'+image+'">')})}};func.initDSXCall()}]}}).directive('twcCustomClick',function(){return{scope:'=',restrict:'A',replace:'true',controller:['$scope','$element','$rootScope','$attrs','customEvent','twcUtil','$timeout','PcoDevice',function($scope,$element,$rootScope,$attrs,customEvent,twcUtil,$timeout,PcoDevice){function showMenu(){$element.parent().addClass('hovered');var dpWidth=539,pageWidth=window.innerWidth,elmLeft=$element.parent().offset().left,leftValue=(pageWidth-elmLeft)-dpWidth;if(leftValue<0){$element.parent().find('.wx-subnav-wrap').css({left:leftValue,display:"block"})}else $element.parent().find('.wx-subnav-wrap').css({left:"auto",display:"block"})}
function hideMenu(){$element.parent().find('.wx-subnav-wrap').css({display:"none"});$element.parent().removeClass('hovered')};if($rootScope.isTouch&&PcoDevice.getOpenDDRId()!=="desktopDevice"){customEvent.getEvent("page-back-event").progress(function(){hideMenu()});customEvent.getEvent("page-load-event").progress(function(){hideMenu()});$element.bind('click',function($event){$event.preventDefault()});$element.bind('touchstart pointerdown MSPointerDown',function($event){if($element.parent().is(".hovered")){hideMenu();window.open($event.target.href,$event.target.target);return false};showMenu();$scope.$emit('touched-link',$event.target.id)});$scope.$on('touched-link',function(event,linkId){if(linkId&&!($element.attr('id')===linkId||$element.find("#"+linkId).length>0))hideMenu()});customEvent.getEvent("touch-on-body-event").progress(function(event){if(angular.element(event.target).attr('id')===$element.attr('id')||angular.element(event.target).is(".main-menu-drop-down-link")||angular.element(event.target).is("img.wx-nav-content-img")||angular.element(event.target).is(".main-menu-drop-down-link_anchor")||angular.element(event.target).is("ul.wx-subnav")||angular.element(event.target).is(".image-title")||angular.element(event.target).is(".linklist-default")){if(angular.element(event.target).is(".main-menu-drop-down-link")||angular.element(event.target).is(".main-menu-drop-down-link_anchor"))$timeout(function(){hideMenu()},1e3);return};hideMenu()})}else{$element.parent().bind('mouseover pointerover',function(){showMenu()});$element.parent().bind('mouseout pointerout',function(){hideMenu()})}}]}});;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_main_menu/header_main_menu.directives.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/social_sharing/social_sharing.controller.js. */
twc.social_sharing.app.controller('twc_social_sharing_controller',['$controller','$scope','DrupalSettings','settings','$window','pcoUser','$timeout','PcoPage',function($controller,$scope,DrupalSettings,settings,$window,pcoUser,$timeout,PcoPage){'use strict';$controller('twcSocialSharingController',{$scope:$scope});var $=angular.element,body=$('body'),wrapper=$('.social-wrapper');$scope.socialSharing={toggleExpand:false,getTheme:function(){if(settings.theme==='auto'){return body.hasClass('light')?'light':'dark'}else return settings.theme},getTooltipPosition:function(){var layoutType=$scope.socialSharing.getLayoutType();return layoutType==='horizontal'||wrapper.css('bottom')==='0px'?'top':'right'},getLayoutType:function(){if(settings.position==='auto'&&pcoUser.getBrowser().ltIE9){if(document.documentElement.clientWidth>=1270){return'vertical'}else return'horizontalBottom'}else return settings.position}};$scope.init(settings)}]).directive('socialBarPosition',['$window','pcoUser',function($window,pcoUser){'use strict';return{link:function(scope,elem){var $=angular.element,layoutType=scope.socialSharing.getLayoutType();if(layoutType!=='auto'&&layoutType!=='vertical'&&!pcoUser.getBrowser().ltIE9)return;var adjustElemPosition=function(){layoutType=scope.socialSharing.getLayoutType();if((layoutType==='auto'||pcoUser.getBrowser().ltIE9)&&$(window).width()<=1268){elem.css('bottom',0).show()}else elem.css('bottom','60px').show()};$(window).on('load resize',adjustElemPosition);if(domready)domready(function(){adjustElemPosition()})}}}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/social_sharing/social_sharing.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/title_video_collection/title_video_collection.controller.js. */
twc.title_video_collection.app.controller('twc_title_video_collection_controller',['$scope','DrupalSettings','settings','dsxclient','twcUtil','twcConfig','customEvent',function($scope,DrupalSettings,settings,dsxclient,twcUtil,twcConfig,customEvent){'use strict';$scope.sponsoredChange=false;var config={settings:{title:false,link:false,image:false,titleOverride:false},includeAd:settings.include_ad,init:function(){$scope.selectedAdPos=settings.selectedadpos;this.settings.title=settings.text_override?settings.text_override:false;this.settings.link=settings.link_override?settings.link_override:false;this.settings.image=settings.image_override?settings.image_override:false;if(this.settings.title)this.settings.titleOverride=true}},fns={getData:function(){var _this=this;TWC.Events.newAsset=TWC.Events.newAsset||jQuery.Deferred();TWC.Events.newAsset.progress(function(obj){var collectionData=obj.getCollectionData(),isSponsored=collectionData.getSponsored();if(config.includeAd&&isSponsored){$scope.retrieveAd=true;$scope.sponsoredChange=collectionData.getId()}else{TWC.Events.adBackgroundRemoveClass.notify(true);$scope.sponsoredChange="clear"};if(!config.settings.titleOverride)$scope.collImage=config.settings.image?config.settings.image:collectionData.getTitleImage();$scope.collTitle=config.settings.title?config.settings.title:(collectionData.getTitle()?collectionData.getTitle():"Video");$scope.collUrl=config.settings.link?config.settings.link:(collectionData.getUrl()?collectionData.getUrl():'http://www.weather.com/')})},formatTitle:function(title){return title.toLowerCase().replace(/ /g,'-')},init:function(){config.init();this.getData()}};$scope.trackTitleClick=function(){var formattedTitle=fns.formatTitle($scope.collTitle);customEvent.getEvent('from-string-event').notify({settings:settings.module_id,fromStr:"title_"+formattedTitle+"_1"})};fns.init()}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/title_video_collection/title_video_collection.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_player/video_player.controller.js. */
twc.video_player.app.controller('twc_video_player_controller',['$scope','$q','$document','DrupalSettings','settings','AdControl',function($scope,$q,$document,DrupalSettings,settings,AdControl){'use strict';$scope.settings=settings;if(!Drupal.settings.twc.modules.video_playlist)if(settings.assetid){$scope.assetId=settings.assetid&&settings.assetid}else $scope.assetId=TWC.PcoUtils.getPathInfo();$scope.playerAdPosition=settings&&settings.selectedadpos instanceof Array&&settings.selectedadpos.length>0&&settings.selectedadpos[0];$scope.moduleId=settings&&settings.module_id;TWC.Events.getEvent('dfpLoaded').done(function(){var adsObjectFromPco=TWC&&TWC.pco&&TWC.pco.get("ad")&&TWC.pco.get("ad").attributes;AdControl.registerCompanion(adsObjectFromPco)})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_player/video_player.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_metadata/video_metadata.controller.js. */
twc.video_metadata.app.controller('twc_video_metadata_controller',['$window','$scope','DrupalSettings','settings','dsxclient','twcUtil','twcConfig','customEvent','datefactory','twcPco','providerMapping','PcoPage',function($window,$scope,DrupalSettings,settings,dsxclient,twcUtil,twcConfig,customEvent,datefactory,twcPco,providerMapping,PcoPage){'use strict';var status=twcConfig.module_status_codes,fns={companionAdExists:false,getFormattedDate:function(date){var METADATA_DATE_FORMAT="MMM d yyyy hh:mm A z",timeZoneAbbr=PcoPage.getTimeZone(),dsxDate=datefactory['new'](date,timeZoneAbbr);return dsxDate.format(METADATA_DATE_FORMAT)},currentCollection:'',currentVideo:'',getFormattedAuthor:function(author,date,providerName){var provider=this.getCorrectProviderName(providerName),authorName=author?(author[0]?author[0]:false):false;date=(date?this.getFormattedDate(date):this.getFormattedDate(new Date()));if(authorName){return date+" | "+authorName+" at "+provider}else return date+" | "+provider},getCorrectProviderName:function(providerName){var tempProvider,formattedProviderName,defaultDigitalProvider="weather.com",defaultTvProvider="The Weather Channel";formattedProviderName=twcUtil.removeSpaces(twcUtil.removeSpecialChars(providerName)).toLowerCase();for(var i=0,x=0,iL=providerMapping['weather.com'].length,xL=providerMapping.twc.length;i<iL;i++){tempProvider=twcUtil.removeSpaces(twcUtil.removeSpecialChars(providerMapping['weather.com'][i])).toLowerCase();providerName=(tempProvider===formattedProviderName?defaultDigitalProvider:providerName);if(providerName!==defaultDigitalProvider)for(;x<xL;x++){tempProvider=twcUtil.removeSpaces(twcUtil.removeSpecialChars(providerMapping.twc[x])).toLowerCase();providerName=(tempProvider===formattedProviderName?defaultTvProvider:providerName)}};return providerName},watchForNewData:function(){var _this=this;customEvent.getEvent('newAsset').progress(function(videoData){if($scope.showDescription)$scope.toggleDescription();$scope.videoData=videoData;$scope.status=status.DEFAULT;_this.currentCollection=videoData.getPrimaryCollectionId();_this.currentVideo=videoData.getId()});setTimeout(function(){if(!$scope.videoData)twcUtil.safeApply($scope,function(){$scope.status=status.ERROR})},8e3)},toggleEventBinding:function(){if($scope.showDescription){angular.element('.video_metadata').not('.close').bind('click',function(event){event.stopPropagation()});angular.element('html').bind('touchstart click',function(){twcUtil.safeApply($scope,function(){$scope.toggleDescription()})})}else{angular.element('.video_metadata').unbind('click');angular.element('html').unbind('touchstart click')};return this},toggleDescription:function(){var trackString="icon_"+fns.stripSlashes($scope.videoData.getPrimaryCollectionId())+"_1_"+$scope.videoData.getId();$scope.showDescription=!$scope.showDescription;if($scope.showDescription){customEvent.getEvent('track-string-event').notify({settings:settings,trackStr:trackString});if(this.companionAdExists)customEvent.getEvent('triggerAdText').notify({state:"hide"})}else if(this.companionAdExists)customEvent.getEvent('triggerAdText').notify({state:"show"});this.toggleEventBinding();return this},stripSlashes:function(str){return str.replace(/\//g,'-')},init:function(){$scope.status=status.LOADING;$scope.videoData=false;$scope.showDescription=false;customEvent.getEvent('videoAdStatus').progress(function(state){fns.companionAdExists=state.hasCompanion});this.watchForNewData()}};angular.element($window).on('resize',twcUtil.debounce(function(){if($window.innerWidth>1e3)if($scope.showDescription)customEvent.getEvent('triggerAdText').notify({state:"hide"})},200));$scope.toggleDescription=function(){fns.toggleDescription()};$scope.getFormattedAuthor=function(author,date,providerName){return fns.getFormattedAuthor(author,date,providerName)};fns.init()}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_metadata/video_metadata.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_companion_text/video_companion_text.controller.js. */
twc.video_companion_text.app.controller('twc_video_companion_text_controller',['$window','$filter','$scope','DrupalSettings','settings','dsxclient','twcUtil','twcConfig','customEvent',function($window,$filter,$scope,DrupalSettings,settings,dsxclient,twcUtil,twcConfig,customEvent){'use strict';var hasCompanion=false;$scope.showAdText=false;$scope.advertisementText=$filter('translate')('video_companion_text.ADVERTISEMENT');customEvent.getEvent('triggerAdText').progress(function(trigger){twcUtil.safeApply($scope,function(){if(trigger.state==="hide"){$scope.showAdText=false}else if(trigger.state==="show")$scope.showAdText=true})});customEvent.getEvent('videoAdStatus').progress(function(state){hasCompanion=state.hasCompanion});angular.element($window).on('resize',twcUtil.debounce(function(){if($window.innerWidth<1e3)if(hasCompanion)twcUtil.safeApply($scope,function(){$scope.showAdText=true})},200))}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_companion_text/video_companion_text.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_playlist/video_playlist.controller.js. */
twc.video_playlist.app.controller('twc_video_playlist_controller',['$window','$rootScope','$scope','settings','DrupalSettings','dsxclient','twcUtil','customEvent','twcConfig','$filter','VideoAssetModelClass','CmsCollectionsModelClass','$sce',function($window,$scope,$rootScope,settings,DrupalSettings,dsxclient,twcUtil,customEvent,twcConfig,$filter,VideoAssetModelClass,CmsCollectionsModelClass,$sce){'use strict';var vars={status:'',pcollid:'',playlistId:false,contexts:DrupalSettings.getContexts(),settings:{overrideBrowseAllLink:false,hasPlaylistOverride:false,hasTeaserTitleOverride:false},cms_ordered_list_config:{recordType:"cms",recordName:"orderedlist"},cms_asset_coll_config:{recordType:"cms",recordName:"videoAssetWithColl"},videoContext:{},checkForPlaylist:function(){var urlParms=$window.location.search.substring(1);if(urlParms.match('pl=')){var eachParams=urlParms.split('&');for(var i=0;i<eachParams.length;i++){var param=eachParams[i].split('=');if(param[0]==="pl"&&param[1]){this.playlistId=param[1];this.settings.hasPlaylistOverride=true}}}else this.playlistId=false;return false},setup:function(){this.videoContext=this.contexts[settings.video_node];this.pcollid=this.videoContext.field_pcoll;this.checkForPlaylist();this.status=twcConfig.module_status_codes;this.settings.overrideBrowseAllLink=(settings.trigger_browse_override!==0)||false;this.settings.hasTeaserTitleOverride=(settings.trigger_teaser!==0)||false;settings.module_id=settings.module_id+(this.settings.hasPlaylistOverride?"-playlist":"-collection");$scope.browseAllText=$filter('translate')('video_playlist.BROWSE_ALL_TEXT');$scope.collectionTitleCountEnabled=(settings.disableCountView!==0)?false:true;$scope.collectionTitleBrowseAllEnabled=(settings.disableBrowseAllView!==0)?false:true;$scope.playlistVideoCollection='';$scope.teaserOverride=this.settings.hasTeaserTitleOverride;Playlist.init()}},Playlist={pageObjectFromPco:false,adsObjectFromPco:false,metricsObjectFromPco:false,orderedDsxAttempts:0,firstAssetIndex:false,collectionData:'',actualCollectionTitle:'',getOrderedList:function(collid){var _this=this,playlistDsxConfig=[];this.orderedDsxAttempts++;playlistDsxConfig.push(angular.extend({$id:'playlistData',path:collid},vars.cms_ordered_list_config));dsxclient.execute(playlistDsxConfig).then(['playlistData',function(playlistData){var i,indexedData,playlistDataLength,modifiedPlaylistData=[];if(!playlistData){if(_this.orderedDsxAttempts<=1&&vars.pcollid){_this.getOrderedList(vars.pcollid)}else $scope.status=vars.status.ERROR}else{playlistData=playlistData.data;playlistDataLength=playlistData.length;for(i=0;i<playlistDataLength;i++){var asset,isFirstAsset;asset=new VideoAssetModelClass(playlistData[i]);isFirstAsset=_this._checkIfFirstAsset(asset.getId());if(i===0&&!vars.playlistId){_this.actualCollectionTitle=asset.getCollectionData().getTitle()}else if(i===0&&vars.playlistId)if(asset.getPlaylistData()){_this.actualCollectionTitle=asset.getPlaylistData().getTitle()||asset.getCollectionData().getTitle();if(!asset.getPlaylistData().getTitle())settings.module_id=settings.module_id.replace('-playlist','-collection')};asset.data=angular.extend({itemIndex:i},asset.data);if(isFirstAsset)_this.firstAssetIndex=i;modifiedPlaylistData.push(asset)};if(!_this.firstAssetIndex&&_this.firstAssetIndex!==0){_this._getSingleAssetAggregate(function(singleAsset){var modI,modifiedPlaylistDataLength;modifiedPlaylistDataLength=modifiedPlaylistData.length;for(modI=0;modI<modifiedPlaylistDataLength;modI++)modifiedPlaylistData[modI].data.itemIndex=modI+1;modifiedPlaylistData.unshift(singleAsset);_this.firstAssetIndex=0;_this._setupPlaylist(modifiedPlaylistData)})}else _this._setupPlaylist(modifiedPlaylistData)}}],function(){$scope.status=vars.status.ERROR});return this},_setupPlaylist:function(modifiedPlaylistData){var _this=this;$scope.playlistData=modifiedPlaylistData;$scope.currentlyPlayingIndex=this.firstAssetIndex;$scope.nextUpIndex=($scope.playlistData.length===(this.firstAssetIndex+1))?0:this.firstAssetIndex+1;this._broadcastVideoData($scope.playlistData[_this.firstAssetIndex])._updateTitle($scope.playlistData[this.firstAssetIndex].getTitle());setTimeout(function(){_this._notifySlide(_this.firstAssetIndex)},200);$scope.status=vars.status.DEFAULT},_getSingleAssetAggregate:function(callback){var singleAssetDsxConfig=[];singleAssetDsxConfig.push(angular.extend({$id:'singleAssetData',assetId:vars.videoContext.uuid},vars.cms_asset_coll_config));dsxclient.execute(singleAssetDsxConfig).then(['singleAssetData',function(singleAssetData){if(!singleAssetData){$scope.status=vars.status.ERROR;return false};singleAssetData.data=angular.extend({itemIndex:0},singleAssetData.data);if(typeof callback==="function")callback(singleAssetData)}],function(){$scope.status=vars.status.ERROR})},setVideoBadges:function(itemIndex){twcUtil.safeApply($scope,function(){$scope.currentlyPlayingIndex=itemIndex;if($scope.playlistData.length===(itemIndex+1)&&$scope.playlistData.length>1){$scope.nextUpIndex=0}else $scope.nextUpIndex=itemIndex+1});this._notifySlide(itemIndex);return this},_broadcastVideoData:function(videoData){$scope.collectionTitle=this.actualCollectionTitle;if(vars.settings.overrideBrowseAllLink){$scope.collectionTitleUrl=vars.settings.overrideBrowseAllLink}else $scope.collectionTitleUrl=videoData.getCollectionData().getUrl();if(vars.settings.hasPlaylistOverride)$scope.playlistVideoCollection=videoData.getCollectionData().getTitle();customEvent.getEvent('newAsset').notify(videoData);return this},_notifySlide:function(itemIndex){customEvent.getEvent('transitionSlide').notify(itemIndex);return this},_updateTitle:function(videoTitle){document.title="VIDEO: "+videoTitle;return this},_checkIfFirstAsset:function(videoId){if(videoId===vars.videoContext.uuid){return true}else return false},_formatVideoTitle:function(videoTitle){return videoTitle.replace(/[^\w\s]/gi,'').replace(/ /g,'-').toLowerCase()},getVideoUrl:function(videoData){return $window.location.href.replace(/([^:\/\s]+)((\/\w+)*\/)([\w\-\.]+[^#?\s]+)(.*)?(#[\w\-]+)?$/,"$1"+videoData.getUrl()+"$5")},_updateUrl:function(videoData){var newLocation=this.getVideoUrl(videoData),newTitle=videoData.getTitle();this._updateTitle(newTitle);if($window.history&&$window.history.pushState)$window.history.replaceState({},newTitle,newLocation);return this},handleBroadcast:function(videoData){this._broadcastVideoData(videoData)._updateUrl(videoData);this.setVideoBadges(videoData.getItemIndex());return this},handleTracking:function(videoData,element){var track={},fromStr,previousVideo=$scope.playlistData[$scope.currentlyPlayingIndex];if(previousVideo){track={position:(element?(element.hasAttribute('src')?"image_":"headline_"):'continuous_')+previousVideo.getItemIndex(),collection:(previousVideo.getCollectionData().getId()||"").replace(/\//g,'-').replace('_',''),videoTitle:Playlist._formatVideoTitle(previousVideo.getTitle())};fromStr=track.position+"_"+track.collection+"_"+track.videoTitle;customEvent.getEvent('from-string-event').notify({settings:settings,fromStr:fromStr})};if(element){if(element.hasAttribute('src')){element="image_"}else element="headline_";track={position:element+videoData.getItemIndex(),collection:(videoData.getCollectionData().getId()&&videoData.getCollectionData().getId()||"").replace(/\//g,'-').replace('_',''),videoTitle:Playlist._formatVideoTitle(videoData.getTitle())};customEvent.getEvent('track-string-event').notify({settings:settings,trackStr:track.position+"_"+track.collection+"_"+track.videoTitle})};if(this.pageObjectFromPco.content&&this.pageObjectFromPco.content==="video"&&this.adsObjectFromPco&&this.metricsObjectFromPco)this._trackPageView(this.pageObjectFromPco,this.adsObjectFromPco,this.metricsObjectFromPco,videoData,fromStr);return this},_trackPageView:function(pcoPageData,pcoAdData,pcoMetricsData,videoData,fromStr){var adMetricsFromCollection=videoData.getCollectionData()&&videoData.getCollectionData().getAdMetrics()||{},level1234=adMetricsFromCollection.video&&adMetricsFromCollection.video.metrics||"",l1234A=level1234.split("/"),level1=l1234A.length>0&&l1234A[0]||"",level2=l1234A.length>1&&l1234A[1]||"",level3=l1234A.length>2&&l1234A[2]||"",level4=l1234A.length>3&&l1234A[3]||"",nctau=pcoAdData&&pcoAdData.NCTAU,adZone=nctau&&nctau.zone||undefined,catFmCh=adZone&&adZone.split("/")||[],hier1=TWC.pco.getNodeValue('metrics','level1')||'',level="level";s.events="event2";s.hier1=hier1;for(var i=2;i<5;i++){level="level"+i;hier1+=TWC.pco.getNodeValue('metrics',level)?"-"+TWC.pco.getNodeValue('metrics',level):''};s.pagename=utag_data['js_page.pagename'];s.channel=utag_data['js_page.level1'];s.campaign=utag_data['js_page.campaign'];s.pageURL=this.getVideoUrl(videoData);s.prop1="D=ch";s.eVar3=utag_data['js_page.campaignCode'];s.prop4=utag_data['js_page.declarations'];s.eVar4="D=v0";s.eVar5="D=v0";s.prop8=utag_data['js_page.rmid'];s.eVar8=utag_data['js_page.zone'];s.prop10="D=ch";s.prop11=utag_data['js_page.contentSection'];s.eVar12="D=c11";s.eVar13="D=c1";s.prop14=utag_data['js_page.contentFamily'];s.eVar14="D=c14";s.prop15=utag_data['js_page.contentChannel'];s.eVar15="D=c15";s.prop16=utag_data['js_page.cond'];s.eVar16="D=c16";s.prop18=utag_data['js_page.provider_author'];s.eVar18="D=c18";s.prop19=utag_data['js_page.primaryDecl'];s.eVar19="D=c19";s.prop22=utag_data['js_page.locTypeIdName'];s.prop23=videoData.getTitle();s.prop24=videoData.getUrl();s.prop25=utag_data['js_page.preferredLocation'];s.prop26=utag_data['js_page.locCityStateCountry'];s.eVar26="D=c26";s.prop27=utag_data['js_page.dma'];s.eVar27="D=c27";s.prop28=utag_data['js_page.zip'];s.eVar28="D=c28";s.prop29=utag_data['js_page.savedLocations'];s.prop30=utag_data['js_page.env'];s.eVar30=utag_data['js_page.flash'];s.prop31=utag_data['js_page.gender'];s.prop32=utag_data['js_page.age'];s.eVar33=utag_data['js_page.pageUrl'];s.prop34=utag_data['js_page.pollen'];if(!s.prop39||(s.prop39!==utag_data['js_page.partner'])){s.prop39=utag_data['js_page.partner']}else s.prop39="";s.eVar39=utag_data['js_page.partner2'];s.eVar40=utag_data['js_page.partnerSite'];s.prop44=pcoMetricsData.pagename+"_"+settings.module_id+"_"+fromStr;s.eVar44="D=c44";s.eVar46=videoData.getTitle();s.eVar47=videoData.getCollectionData().getTitle();s.prop45=utag_data['js_page.cobrand'];s.prop46=utag_data['js_page.ad_category'];s.prop47=utag_data['js_page.contentType'];s.prop48=utag_data['js_page.ad_family'];s.prop49=utag_data['js_page.ad_channel'];s.prop50=utag_data['js_page.template'];s.eVar63=videoData.getId();s.eVar64=utag_data['js_page.assetType'];s.eVar60=utag_data['js_page.partner3'];s.eVar62="videoplayer-present";s.hier2=utag_data['js_page.ad_family']+"-"+utag_data['js_page.ad_channel']+"-"+utag_data['js_page.level1'];if(pcoPageData&&pcoPageData.content&&pcoPageData.content==="video")adZone=adMetricsFromCollection.video&&adMetricsFromCollection.video.zone||adZone;s.eVar8=adZone;s.t();return this},init:function(){$scope.status=vars.status.LOADING;if(twcUtil.isEmpty(vars.videoContext)){$scope.status=vars.status.ERROR}else if(vars.playlistId){this.getOrderedList(vars.playlistId)}else this.getOrderedList(vars.pcollid);return this}};customEvent.getEvent('carouselItemClick').progress(function(videoIndex,element){var videoData=$scope.playlistData[videoIndex];if(videoData.getItemIndex()===$scope.currentlyPlayingIndex)return false;Playlist.handleTracking(videoData,element).handleBroadcast(videoData)});customEvent.getEvent('mediaEnded').progress(function(videoData){var nextVideo,endedIndex=videoData.getItemIndex();if(typeof endedIndex!=="undefined")if($scope.playlistData.length===(endedIndex+1)){nextVideo=$scope.playlistData[0];Playlist.handleTracking(nextVideo,false).handleBroadcast(nextVideo)}else{nextVideo=$scope.playlistData[endedIndex+1];Playlist.handleTracking(nextVideo,false).handleBroadcast(nextVideo)}});customEvent.getEvent('pcoReady').done(function(){Playlist.pageObjectFromPco=TWC&&TWC.pco&&TWC.pco.get("page")&&TWC.pco.get("page").attributes;Playlist.metricsObjectFromPco=TWC&&TWC.pco&&TWC.pco.get("metrics")&&TWC.pco.get("metrics").attributes});customEvent.getEvent('dfpLoaded').done(function(){Playlist.adsObjectFromPco=TWC&&TWC.pco&&TWC.pco.get("ad")&&TWC.pco.get("ad").attributes});$scope.getVideoUrl=function(videoData){return Playlist.getVideoUrl(videoData)};vars.setup()}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_playlist/video_playlist.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_playlist/video_playlist.directive.js. */
twc.video_playlist.app.factory('VdCarouselDir',['TwcClass',function(TwcClass){return TwcClass.extend({template:'<div><div style="display: table-row"><div class="card-paging" ng-show="pagination()"><div ng-class="{disabled: !prevEnabled}"><a href="" ng-click="prevPage()"><i class="wx-iconfont-global wx-icon-arrow-left-2"></i></a></div></div><div class="swiper-container"><ul class="swiper-wrapper" ng-transclude></ul></div><div class="card-paging" ng-show="pagination()"><div ng-class="{disabled: !nextEnabled}"><a href="" ng-click="nextPage()"><i class="wx-iconfont-global wx-icon-arrow-right-2"></i></a></div></div></div></div>',transclude:true,replace:true,scope:{hidePaginationControls:'=',hidePaginationOnLoad:'@'},controller:function($scope,twcUtil){this.update=twcUtil.throttle(function(){if($scope.carousel){$scope.carousel.reInit();twcUtil.safeApply($scope,function(){$scope.paginationEnabled=$scope.carousel.swiperWrapper.width()>$scope.carousel.swiper.width&&!$scope.hidePaginationOnLoad;$scope.hidePaginationOnLoad=false})}},100)}})}]).factory('VdCarouselSlideDir',['TwcClass',function(TwcClass){return TwcClass.extend({template:'<li class="swiper-slide" ng-transclude>\n    </li>',replace:true,transclude:true,require:'^vdCarousel',link:function(scope,elem,attrs,ctrl){scope.$evalAsync(function(){ctrl.update()})}})}]).directive('vdCarousel',['VideoCarousel','VdCarouselDir','customEvent','twcUtil','$window',function(VideoCarousel,VdCarouselDir,customEvent,twcUtil,$window){var $=angular.element;return new (VdCarouselDir.extend({link:function(scope,elem){var onAndroid=/Android/i.test($window.navigator.userAgent);elem.addClass(onAndroid?'fade-disabled':'fade-enabled');scope.paginationEnabled=true;scope.nextPage=function(){return carousel.nextPage()};scope.prevPage=function(){return carousel.prevPage()};scope.lastSlide=function(){return carousel.swiper.swipeTo(carousel.swiper.slides.length-1)};scope.pagination=function(){return scope.paginationEnabled};scope.prevEnabled=false;scope.nextEnabled=true;customEvent.getEvent('paginationCheckEvent').progress(function(){setTimeout(togglePaginationControls,0)});customEvent.getEvent('transitionSlide').progress(function(index){carousel.swiper.swipeTo(index)})
function togglePaginationControls(){var swiper=carousel.swiper;twcUtil.safeApply(scope,function(){scope.nextEnabled=swiper.slides.length>0?swiper.slidesGrid[swiper.slidesGrid.length-1]+swiper.getWrapperTranslate()+swiper.slides[swiper.slides.length-1].getWidth()>swiper.width:false;scope.prevEnabled=swiper.getWrapperTranslate()?swiper.getWrapperTranslate()<0:false})};var swiperElem=elem.find('.swiper-container'),carousel=new VideoCarousel({cardHandler:{transitionSpeed:300,transitionTiming:'ease-out',_animating:false,findIn:function(elem){return elem.find('.wx-list-container')},isAnimating:function(){var self=this;return self._animating},setIsAnimating:function(animated){var self=this;self._animating=animated},calcSummaryViewWidth:function(view){return $(view).width()},calcDetailViewWidth:function(view){var kids=view.children(),calculatedWidth=0;kids.each(function(idx,kid){calculatedWidth+=$(kid).outerWidth()});return calculatedWidth},setPagination:function(val){twcUtil.safeApply(scope,function(){scope.paginationEnabled=val;carousel.calcWidth()})}},calcWidth:function(){var oldWidth=swiperElem.width(),newWidth=elem.width()-(scope.hidePaginationOnLoad?0:elem.find('.card-paging').width());if(oldWidth!==newWidth){swiperElem.width(newWidth);carousel.swiper.reInit()}}});carousel.init(swiperElem);scope.carousel=carousel;$(carousel.swiper.container).css('visibility','hidden')}}))()}]).directive('vdCarouselSlide',['VdCarouselSlideDir',function(VdCarouselSlideDir){return new VdCarouselSlideDir()}]).directive('vdCarouselSlideMobileCc',['VdCarouselSlideDir',function(VdCarouselSlideDir){return new (VdCarouselSlideDir.extend({require:'^vdCarouselMobile'}))()}]).factory('VideoCarousel',['TwcClass','$window','$timeout','twcUtil','twcCssAnim','customEvent',function(TwcClass,$window,$timeout,twcUtil,anim,customEvent){var $=angular.element,pages=0,swipeLoaded=false,pageNum=0
function when(deferreds){return $.when.apply(null,deferreds)}
function getLeftMostIndexFitViewPort(swiper,firstSlide){var totalWidth=firstSlide.getWidth(),leftSlideIndex=firstSlide.index(),currentLeftSlide;do{currentLeftSlide=swiper.slides[--leftSlideIndex]}while(currentLeftSlide&&((totalWidth+=currentLeftSlide.getWidth())<=swiper.width));return leftSlideIndex+1};return TwcClass.extend({construct:function(params){this.events=$({});this.cardHandler=params.cardHandler;this.overflow=false;this.calcWidth=params.calcWidth},getPages:function(){if(this.swiper&&!swipeLoaded){pages=Math.round(this.swiper.slides.length/this.swiper.visibleSlides.length);swipeLoaded=true};return pages},animateToNextPage:function(doneCallback){var currentXOffset=this.swiper.getWrapperTranslate(),currentIndex=this.swiper.visibleSlides.length-1,currentSlide=this.swiper.visibleSlides[currentIndex],absoluteIndex=currentSlide.index(),swipeToIdx;if(this.swiper.visibleSlides.length>1){var currentSlidePos=this.swiper.slidesGrid[absoluteIndex],swipeWidth=this.swiper.width,slideWidth=currentSlide.getWidth(),rightExcess=-swipeWidth+(currentSlidePos+slideWidth+currentXOffset);swipeToIdx=rightExcess>0?absoluteIndex:absoluteIndex+1}else swipeToIdx=absoluteIndex+1;this.swiper.swipeTo(swipeToIdx);if(this.swiper.getWrapperTranslate()!==currentXOffset){this.wrapperTransitionEnd(doneCallback)}else doneCallback()},animateToPrevPage:function(doneCallback){var firstVisibleSlide=this.swiper.visibleSlides[0],currentXOffset=this.swiper.getWrapperTranslate(),firstVisibleSlideObscured=this.swiper.slidesGrid[firstVisibleSlide.index()]<-currentXOffset,firstObscuredSlide=firstVisibleSlideObscured?firstVisibleSlide:this.swiper.slides[firstVisibleSlide.index()-1];if(firstObscuredSlide){var prevIndex=getLeftMostIndexFitViewPort(this.swiper,firstObscuredSlide);if(prevIndex<0)prevIndex=0;this.swiper.swipeTo(prevIndex);if(this.swiper.getWrapperTranslate()!==currentXOffset){this.wrapperTransitionEnd(doneCallback)}else doneCallback()}else doneCallback()},nextPage:function(){var self=this;this._nextSlideQ=this._nextSlideQ||$({});self.getPages();if(pageNum<pages)pageNum++;this._nextSlideQ.queue(function(next){self.animateToNextPage(function(){customEvent.getEvent('paginationCheckEvent').notify();next()})});customEvent.getEvent('vdCarousel-page-event').notify({pageNum:pageNum,maxPagesReached:pageNum===pages,nextPrev:true})},prevPage:function(){var self=this;this._prevSlideQ=this._prevSlideQ||$({});self.getPages();if(pageNum>0)pageNum--;this._prevSlideQ.queue(function(next){self.animateToPrevPage(function(){customEvent.getEvent('paginationCheckEvent').notify();next()})});customEvent.getEvent('vdCarousel-page-event').notify({pageNum:pageNum,maxPagesReached:false,nextPrev:false})},init:function(elem){var self=this,config={mode:'horizontal',loop:false,slidesPerView:'auto',speed:500,autoResize:false,momentumRatio:0.45,freeMode:true,freeModeFluid:Modernizr.csstransitions,disableSlideClassUpdate:true,onSlideChangeEnd:function(){self.events.trigger('slideChangeEnd')},onTouchEnd:function(swiper,event){self.events.trigger('touchEnd',event)}};if(Modernizr.touch){var onAndroid=/Android/i.test($window.navigator.userAgent),regEx1='(Chrome)',regEx2='(\\/)',regEx3='(\\d+)',p=new RegExp(regEx1+regEx2+regEx3),match=p.exec($window.navigator.userAgent);if((onAndroid&&match===null)||(onAndroid&&parseInt(match[3])<30))config.freeModeFluid=false;config.onTouchMove=function(){if(!self.moving)self.moving=true};config.onSlideTouch=function(swiper,event){event.preventDefault()};self.events.on('touchEnd',function(e,event){event.preventDefault();if((anim.isSupported||!self.swiper._DOMAnimating)&&!self.moving&&event.type==='touchend'){customEvent.getEvent('carouselItemClick').notify(self.swiper.clickedSlideIndex,event.target);self.animateToggleSlide(self.swiper.clickedSlide)};self.moving=false})}else config.onSlideClick=function(e,event){if(event.preventDefault){event.preventDefault()}else event.returnValue=false;if(anim.isSupported||!self.swiper._DOMAnimating){customEvent.getEvent('carouselItemClick').notify(e.clickedSlideIndex,event.target);self.animateToggleSlide(self.swiper.clickedSlide)}};this.swiper=elem.swiper(config);this.swiperWrapper=$(this.swiper.wrapper);self.events.on('slideChangeEnd ',function(){customEvent.getEvent('paginationCheckEvent').notify()}).on('touchEnd',function(){customEvent.getEvent('paginationCheckEvent').notify()});anim.onTransitionEnd(this.swiperWrapper,function(){customEvent.getEvent('paginationCheckEvent').notify()},'transform');var jqWindow=$($window),windowWidth=jqWindow.width();jqWindow.on('resize',twcUtil.throttle(function(){var newWindowWidth=jqWindow.width();if(newWindowWidth===windowWidth)return;windowWidth=newWindowWidth;self.calcWidth();self.swiper.width=$(self.swiper.container).innerWidth();self.swiper.resizeFix(true);self.cardHandler.setPagination(self.swiperWrapper.width()>self.swiper.width);customEvent.getEvent('paginationCheckEvent').notify()},20));$timeout(this.calcWidth,0)},reInit:function(){if(this.swiper){var self=this;this.swiper.reInit();this.swiper.updateActiveSlide();this.swiperWrapper.css('height','');this.calcOverflow();setTimeout(function(){$(self.swiper.container).css('visibility','visible')},100)}},calcOverflow:function(){var overflow=!!this.swiper&&(this.swiperWrapper.width()>this.swiper.width),oldOverflow=this.overflow;this.overflow=overflow;if(overflow!==oldOverflow)this.events.trigger({type:'overflowChanged',overflow:overflow})},swipeTo:function(index){return this.swiper.swipeTo(index)},wrapperTransitionEnd:function(handler){if(anim.isSupported){anim.onTransitionEndOnce(this.swiperWrapper,handler,'transform')}else this.events.one('slideChangeEnd',handler)},animateToggleSlide:function(slide){var self=this,$card=this.cardHandler.findIn($(slide)),currentIndex=slide.index();if(typeof $card[0]==='undefined'||$card.find('.wxcard-details').length===0)return;var doneCallback=function(){self.swiper.resizeFix();self.swiper.updateActiveSlide();self.calcOverflow()};if(this.cardHandler.isAnimating()){doneCallback();return};var swiper=this.swiper,swiperWrapper=this.swiperWrapper,allTransitionsEnd=[];swiperWrapper.width(swiperWrapper.width()+2e3)
function createTransitionEndResolveCallback(){var transitionEndDeferred=$.Deferred();allTransitionsEnd.push(transitionEndDeferred);return function(){transitionEndDeferred.resolve()}};var lastSlide=swiper.slides[swiper.slides.length-1];when(allTransitionsEnd).then(function(){function handlePostAnimation(){self.cardHandler.setIsAnimating(false);self.reInit();self.cardHandler.setPagination(swiperWrapper.width()>swiper.width);customEvent.getEvent('paginationCheckEvent').notify();var wrapperTranslate=swiper.getWrapperTranslate(),rightExcess=swiper.slidesGrid[swiper.clickedSlideIndex]+wrapperTranslate+slide.getWidth()-swiper.width,leftExcess=-(swiper.slidesGrid[swiper.clickedSlideIndex]+wrapperTranslate)
function translateWrapper(amount){swiper.setWrapperTransition(self.cardHandler.transitionSpeed);swiper.setWrapperTranslate(amount)}};if($.browser.msie&&parseInt($.browser.version)<=9){handlePostAnimation()}else setTimeout(handlePostAnimation,20)})}})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_playlist/video_playlist.directive.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_playlist/video_playlist.title.directive.js. */
twc.video_playlist.app.directive('twcVideoPlaylistTitle',['$compile',function($compile){var basicTemplate="<h2>{{ collectionTitle }} {{ enableCount ? '(' + collectionCount + ')' : ''}}</h2>",browseAllTemplate="<h2>{{ collectionTitle }} {{ enableCount ? '(' + collectionCount + ')' : ''}}<a ng-href=\"{{collectionUrl}}\"><span class=\"browseAll\"> {{ collectionPlaylistAddition ? browseAllText + ' from ' + collectionPlaylistAddition : browseAllText }} <span class=\"browseAllArrow wx-iconfont-global wx-icon-arrow-right\"></span></span></a></h2>",linker=function(scope,element,attrs){if(scope.enableBrowseAll){element.html(browseAllTemplate).show()}else element.html(basicTemplate).show();$compile(element.contents())(scope)};return{restrict:'A',replace:true,transclude:true,scope:{browseAllText:'@',collectionCount:'@',collectionTitle:'@',collectionUrl:'@',collectionPlaylistAddition:'@',enableCount:'=',enableBrowseAll:'='},link:linker}}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_playlist/video_playlist.title.directive.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/taboola_module/taboola_module.controller.js. */
twc.taboola_module.app.controller('twc_taboola_module_controller',['$scope','DrupalSettings','settings','dsxclient','twcUtil','twcConfig',function($scope,DrupalSettings,settings,dsxclient,twcUtil,twcConfig){'use strict';$scope.title=settings.title;$scope.paidFirst=settings.paid_first===1;$scope.placementOrg=settings.placement_org||'';$scope.placementPaid=settings.placement_paid||'';$scope.twoStack=twcUtil.once(function(){angular.element(document).ready(function(){window._taboola=window._taboola||[];_taboola.push({mode:'organic-thumbnails-a',container:'taboola-right-rail-thumbs',placement:$scope.placementOrg,target_type:'mix'})})});$scope.fourStack=twcUtil.once(function(){angular.element(document).ready(function(){window._taboola=window._taboola||[];_taboola.push({mode:'organic-thumbnails-a',container:'taboola-right-rail-thumbs-org',placement:$scope.placementOrg,target_type:'mix'});_taboola.push({mode:'thumbnails-b',container:'taboola-right-rail-thumbs-paid',placement:$scope.placementPaid})})});$scope.eightStack=twcUtil.once(function(){angular.element(document).ready(function(){window._taboola=window._taboola||[];_taboola.push({mode:'organic-thumbnails-c',container:'taboola-below-article-thumbnails-2nd',placement:$scope.placementOrg,target_type:'mix'});_taboola.push({mode:'thumbnails-a',container:'taboola-below-article-thumbnails-1st',placement:$scope.placementPaid,target_type:'mix'})})})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/taboola_module/taboola_module.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_page_nav/video_page_nav.controller.js. */
twc.video_page_nav.app.controller('twc_video_page_nav_controller',["$scope","settings","linkerFactory","PcoPage","$filter","$document","customEvent","$rootScope",function($scope,settings,linkerFactory,PcoPage,$filter,$document,customEvent,$rootScope){'use strict';var menuLinks=settings.menuLinks,moduleId=settings.params.module_id,currentLink=settings.params.currentLink,locationResolved=false,breakpointSizeNav=settings.params.nav_breakPointSize,offsetOverride=settings.params.tzOffsetOverrride&&settings.params.tzOffsetOverrride!==''?parseInt(settings.params.tzOffsetOverrride):null,moreText=settings.params.video_MoreText||null,moreLink=settings.params.video_MoreLink||null,currPath=document.location.pathname,ignoreAssetId=TWC.PcoUtils.getPathInfo().match(/\d+/g)&&TWC.PcoUtils.getPathInfo().match(/\d+/g).length>0||currPath.indexOf('/video/')>-1||currPath.indexOf('/news/')>-1?1:0,pageNavFunctions={getPathOfLink:function(url){var urlArray=url.split('/'),path='',length=urlArray.length-ignoreAssetId;for(var i=0;i<length;i++){if(urlArray[i]!=='')path+=urlArray[i];if(i!==length-1)path+="/"};return path},validateSchedule:function(validBetween){if(validBetween){return linkerFactory.validateLinkSchedule(validBetween,offsetOverride)}else return true},validateLinks:function(){var i;if(menuLinks&&menuLinks.links.length>0)for(i=0;i<menuLinks.links.length;i++){menuLinks.links[i].link_url=linkerFactory.interpolateLinkUrl(menuLinks.links[i].link_url);if(!this.validateSchedule(menuLinks.links[i].link_visible_between)){menuLinks.links.splice(i,1);i--}};$scope.pageNav.menuLinks=angular.copy(menuLinks)}};$scope.pageNav={menuLinks:{},extraLinks:[],moduleId:moduleId,getHiddenLinkActive:function(){return $scope.pageNav.hiddenLinkActive},mouseOnContainer:false,extraEmpty:true,moreForecastText:$filter('translate')('page_nav.MORETEXT'),showMenu:false,breakPointSizeNav:breakpointSizeNav,moreText:moreText?moreText:false,moreLink:moreLink?moreLink:false,hideMenu:function(){$scope.pageNav.showMenu=false},toggleShowMenu:function(show,evt){if(!show)customEvent.getEvent('track-string-event').notify({settings:settings,module_id:moduleId,trackStr:'showMoreNav'});$scope.pageNav.showMenu=!show;evt.stopPropagation()},getPageMenu:function(){return $scope.pageNav.showMenu},gotoLink:function(link,index){var linkUrl=link.link_url,isLinkCurrent=this.isLinkActive(link.link_url),linkTitle='',fromStrVal='';if(!isLinkCurrent){linkTitle=link.link_title||'';fromStrVal=moduleId+"_"+linkTitle.replace(/\s/g,"")+"_"+parseInt(index+1);customEvent.getEvent('from-string-event').notify({settings:settings,fromStr:fromStrVal});if(link.open_link_new_tab){window.open(linkUrl,"_blank")}else window.location.href=linkUrl}else return false},validateLinks:function(){pageNavFunctions.validateLinks()},getFromStr:function(type,title,index){title=title||'';var fromStr=type+"_"+title.replace(/\s/g,"")+"_"+parseInt(index+1);return fromStr},isLinkActive:function(linkUrl){if(currentLink&&linkUrl)return pageNavFunctions.getPathOfLink(linkUrl.toLowerCase())===currentLink.toLowerCase()},locationResolved:function(){return locationResolved},isHiddenLinkActive:function(linkUrl){if(currentLink&&linkUrl)if(pageNavFunctions.getPathOfLink(linkUrl.toLowerCase())===currentLink.toLowerCase())$scope.pageNav.hiddenLinkActive=true},populateExtraLinks:function(){var numLinks=4,tempMenuLinks=[];this.extraLinks=[];this.moreForecastText=$filter('translate')('page_nav.MORETEXTREDUCED');if(menuLinks.links.length>numLinks){for(var i=0;i<numLinks;i++)tempMenuLinks.push(menuLinks.links[i]);for(var j=numLinks;j<menuLinks.links.length;j++)this.extraLinks.push(menuLinks.links[j]);$scope.pageNav.menuLinks.links=tempMenuLinks;this.moreForecastText=$filter('translate')('page_nav.MORETEXTREDUCED');this.extraEmpty=false}},emptyExtraLinks:function(){this.moreForecastText=$filter('translate')('page_nav.MORETEXT');if(!this.extraEmpty){this.menuLinks=angular.copy(menuLinks);this.extraLinks=[];this.moreForecastText=$filter('translate')('page_nav.MORETEXT')}}};PcoPage.getPagePromises().then(function(){locationResolved=true;angular.element("body").find('.twc-dropdown-option').on("mouseover",function(){$scope.pageNav.mouseOnContainer=true});angular.element("body").find('.twc-dropdown-option').on("mouseleave",function(){$scope.pageNav.mouseOnContainer=false});if($rootScope.isTouch){customEvent.getEvent("touch-on-body-event").progress(function(evt){if($scope.pageNav.getPageMenu()&&!(angular.element(evt.target).hasClass('twc-dropdown-toggle')||angular.element(".twc-dropdown-option").find(evt.target).length>0))$scope.$apply(function(){$scope.pageNav.hideMenu()})})}else $document.bind('click',function(evt){if($scope.pageNav.getPageMenu()&&!(angular.element(evt.target).hasClass('twc-dropdown-toggle')||angular.element(".twc-dropdown-option").find(evt.target).length>0))$scope.$apply(function(){$scope.pageNav.hideMenu()})})})}]).directive('resize',["$window","customEvent",function($window,customEvent){'use strict';return{link:function(scope,element,attrs,controller){var w=angular.element($window);customEvent.ifReady(["gotCurrentTime","linker_factory_tempScope"]).then(function(){scope.pageNav.validateLinks();scope.getWindowDimensions=function(){return{h:w.height(),w:w.width()}};scope.$watch(scope.getWindowDimensions,function(newValue,oldValue){scope.windowHeight=newValue.h;scope.windowWidth=newValue.w;if(scope.windowWidth<scope.pageNav.breakPointSizeNav){scope.pageNav.populateExtraLinks()}else scope.pageNav.emptyExtraLinks()},true);w.bind('resize',function(){scope.$apply()})})}}}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_page_nav/video_page_nav.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/cobrand_headers/cobrand_headers.directive.js. */
twc.cobrand_headers.app.directive('wxCoBrandHeader',['PcoPage',function(PcoPage){'use strict';var templatePath='/sites/all/modules/custom/angularmods/modules/cobrand_headers/templates/',templateMapping={earthlinkHTML:templatePath+'earthlink_co_brand.html',nbcnewsHTML:templatePath+'nbcnews_co_brand.html',peoplepcHTML:templatePath+'peoplepc_co_brand.html'};return{restrict:'A',templateUrl:(function(){var partnerVal=PcoPage.getPartner(),_return;if(partnerVal==="nbcnews"){_return=templateMapping.nbcnewsHTML}else if(partnerVal==="peoplepc"){_return=templateMapping.peoplepcHTML}else if(partnerVal==="earthlink")_return=templateMapping.earthlinkHTML;return _return}())}}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/cobrand_headers/cobrand_headers.directive.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/cobrand_headers/cobrand_headers.controller.js. */
twc.cobrand_headers.app.controller('twc_cobrand_headers_controller',['$scope','DrupalSettings','settings','dsxclient','twcConfig',function($scope,DrupalSettings,settings,dsxclient,twcConfig){'use strict'}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/cobrand_headers/cobrand_headers.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/breaking_now/breaking_now.directive.js. */
twc.breaking_now.app.directive('breakingNow',[function(){return{priority:0,replace:false,templateUrl:'templates/modules/breakingnow',scope:'=',restrict:'EA'}}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/breaking_now/breaking_now.directive.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/most_popular/most_popular.controller.js. */
twc.most_popular.app.controller('twc_most_popular_controller',['$scope','DrupalSettings','settings','dsxclient','pcoUser','twcPco','twcUtil','twcConfig','PcoMetrics',function($scope,DrupalSettings,settings,dsxclient,pcoUser,twcPco,twcUtil,twcConfig,PcoMetrics){'use strict';var status=twcConfig.module_status_codes,fns={getData:function(){dsxclient.execute([{$id:'mostPopularItems',listName:(settings.asset_list||'most-popular-articles-and-videos'),startIndex:0,count:(settings.total_results||10),recordType:'cms',recordName:'AssetList',version:'v2'}]).addResultsTo($scope).then(['mostPopularItems','response',function(mostPopularItems,response){if(mostPopularItems){$scope.status=status.DEFAULT}else if(response.attrs&&response.attrs.data&&response.attrs.data.body&&response.attrs.data.body[0]&&response.attrs.data.body[0].status&&response.attrs.data.body[0].status===204){$scope.status=status.NOT_AVAILABLE}else $scope.status=status.ERROR}],function(){$scope.status=status.ERROR})}};$scope.status=status.LOADING;$scope.mostPopular={};$scope.mostPopular.showThumbnails=(settings.image_promotion)?true:false;$scope.mostPopular.moduleTitle=settings.module_title||'';$scope.mostPopular.moduleTitleUrl=settings.module_title_url||'';$scope.mostPopular.moduleId=settings.module_id;$scope.mostPopular.pageName=PcoMetrics.getPageName();fns.getData()}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/most_popular/most_popular.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/content_media/content_media.directive.js. */
twc.content_media.app.directive('twcRel',function(){return{scope:{corsican:'=twcRel'},replace:false,transclude:false,link:function($scope,$element,$attrs){if($scope.corsican.options&&$scope.corsican.options.nofollow)$element.attr('rel','nofollow')}}}).directive('twcVideoDuration',function(){return{scope:{twcVideoDuration:'='},replace:true,transclude:false,template:"<span data-ng-bind='modDuration'></span>",link:function($scope,$element,$attrs){$scope.modDuration="";if($scope.twcVideoDuration){var parts=$scope.twcVideoDuration.split&&$scope.twcVideoDuration.split(":");if(parts&&angular.isArray(parts))$scope.modDuration=(parts.length===3&&(!isNaN(parts[0])&&!parseInt(parts[0],10)))?parts.slice(1,3).join(":"):parts.join(":")}}}});;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/content_media/content_media.directive.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/content_media/content_media.controller.js. */
twc.content_media.app.controller('twc_content_media_controller',['$scope','twcConfig','settings','DrupalSettings','dsxclient','twcUtil','PcoPage','$interpolate','$timeout','CmsAModelClass','$rootScope','PcoMetrics','twcPco',function($scope,twcConfig,settings,DrupalSettings,dsxclient,twcUtil,PcoPage,$interpolate,$timeout,CmsAModelClass,$rootScope,metrics,twcPco){'use strict';var vars={cms_query_config:{recordType:"cms",recordName:"a"},cms_assetid_config:{recordType:"cms",recordName:"aidQ"},cms_playlist_config:{recordType:"cms",recordName:"playlist"},limit:settings.limit,template_map:{dma:"DMA:{{cntryCd}}.{{dmaCd}}:{{cntryCd}}",state:"state:{{cntryCd}}.{{stCd}}:{{cntryCd}}",country:"country:{{cntryCd}}:{{_gprId}}",gpr:"geo_pol:{{_gprId}}:EARTH","4reg":"4reg:{{cntryCd}}.{{lsRad}}:{{cntryCd}}","9reg":"9reg:{{cntryCd}}.{{ssRad}}:{{cntryCd}}"},query_count:parseInt(settings.query_count)||1,init:function(){vars.queries=twcUtil.filter(settings.queries.splice(0,vars.query_count),function(query){if(query.options.query_type==="cms_query"){return(!(angular.isArray(query.cms_query.type))||(query.cms_query.type.length>0))}else if(query.options.query_type==="id_query"){return(query.id_query.asset_id!=="")}else if(query.options.query_type==="playlist")return(query.playlist.playlist!=="");return(query.linker.title!=="")})},api_key:(twcConfig.dsxclient&&twcConfig.dsxclient.params&&twcConfig.dsxclient.params.api)},fns={init:function(){$scope.content_media.status=vars.queries.length===0?$scope.content_media.status_codes.ERROR:$scope.content_media.status_codes.DEFAULT;PcoPage.getPagePromises()['finally'](function(){fns.queryInThread(0)})},queryInThread:function(idx){$timeout(function(){fns.getData(fns.getNextQueries())},1)},getNextQueries:function(){var cQueries=[],remaining=(vars.limit-$scope.content_media.corsicans.length);for(var idx=0,len=vars.queries.length;idx<len;idx++){var query=vars.queries[idx];if(cQueries.length===0||(query.options.query_type!=="cms_query"&&cQueries[idx-1].options.query_type===query.options.query_type)){cQueries.push(query)}else{if(query.options.query_type==="cms_query"&&cQueries.length>1)cQueries.pop();break}};vars.queries=vars.queries.slice(cQueries.length);return cQueries.splice(0,remaining>=0?remaining:0)},getData:function(queries){if(queries&&queries.length<1)return;var query=queries[0],newlimit=(vars.limit-$scope.content_media.corsicans.length),pagelocation=PcoPage.getCurrentLocation(),isAssetIdQuery=(query.options.query_type==="id_query"),isLinkers=(query.options.query_type==="linker"),isPlaylistQuery=(query.options.query_type==="playlist"),current_config=(isAssetIdQuery?vars.cms_assetid_config:(function(){return isPlaylistQuery?vars.cms_playlist_config:vars.cms_query_config})()),sortRecent=false,sortPublish=false,dsxclientcfs=[],jq=window.jQuery;if(isLinkers){angular.forEach(queries,function(cquery){var linker=cquery.linker,link_url=linker.link_url,url=link_url,pWait=linker.options.waitFlag?twcPco.get("user").promises:[];jq.when.apply(jq,pWait).done(function(){url=$interpolate(link_url)($rootScope);if(linker.image_url){var generic_match_parts=linker.image_url.match(/(.*):\/\/([sv])(.w-x.co)\/(.*)/);if(generic_match_parts&&generic_match_parts.length===5){var host=generic_match_parts[2],file_path=generic_match_parts[4];linker.image_url="http://dsx.weather.com/util/image/"+(host==="v"?"v/":"w/")+file_path+"?v=at&w=320&h=180&api="+vars.api_key}};var tempModel=new CmsAModelClass({title:linker.title,description:linker.description,variants:{'9':linker.image_url,'8':linker.image_url,'4':linker.image_url},url:url,id:linker.link_url.match(/\/video\//)&&linker.link_url.substr(linker.link_url.lastIndexOf('/')+1),pcollid:linker.link_url.match(/\/video\//)&&linker.link_url.match(/^http[s]?:\/\/.*?\/([a-zA-Z-_\/]+)\/video.*$/)&&linker.link_url.match(/^http[s]?:\/\/.*?\/([a-zA-Z-_\/]+)\/video.*$/)[1]});tempModel.options=linker.options;$scope.content_media.corsicans.push(tempModel)});if($scope.content_media.corsicans.length<vars.limit)fns.queryInThread();$scope.content_media.status=$scope.content_media.corsicans.length!==0?$scope.content_media.status_codes.DEFAULT:$scope.content_media.status_codes.ERROR});return};if(isAssetIdQuery){angular.forEach(queries,function(cquery){dsxclientcfs.push(angular.extend({assetId:cquery.id_query.asset_id,override_title:cquery.id_query.override_title},current_config))})}else if(isPlaylistQuery){angular.forEach(queries,function(cquery){dsxclientcfs.push(angular.extend({path:cquery.playlist.path,is_playlist:cquery.playlist.is_playlist},current_config))})}else{var queryObj={},sub_query=query.cms_query,qlimit=sub_query.limit,qstart=sub_query.start_index||0;if('type'in sub_query)queryObj.type=angular.isArray(sub_query.type)?sub_query.type:Object.keys(sub_query.type);var geo_params=[];angular.forEach(["dma","gpr","state","country","region"],function(locParam){var sqLocConf=sub_query[locParam];if(sqLocConf&&sqLocConf.enabled){var paramSrc=sqLocConf.source,prefixKey=((locParam==="region")?(function(){if(paramSrc==="other")return((paramSrc.indexOf("region:4")!==-1)?"4reg":"9reg");return((paramSrc==="page_4")?"4reg":"9reg")})():locParam),paramValue;if(sqLocConf.source!=="other"&&pagelocation&&!('error'in pagelocation)){paramValue=$interpolate(vars.template_map[prefixKey])(pagelocation)}else if(sqLocConf.other&&sqLocConf.other.length>0){var regmatch=sqLocConf.other.match(/\((.*)\)/);if(regmatch&&regmatch.length===2)paramValue=regmatch[1]};if(paramValue)geo_params.push(paramValue)}});if(geo_params.length>0)queryObj["tags.geo"]=geo_params;var trimFn=function(param){return twcUtil.trim(param)};if(sub_query.primary_collection)queryObj.pcollid=twcUtil.map(sub_query.primary_collection.split(","),trimFn);if(sub_query.keyword)queryObj.keyword=twcUtil.map(sub_query.keyword.split(","),trimFn);sortRecent=sub_query.sort_param&&sub_query.sort_param==="sort_recent";sortPublish=sub_query.sort_param&&sub_query.sort_param==="sort_publishdate";dsxclientcfs.push(angular.extend({use_teaser_title:parseInt(sub_query.use_teaser_title,10)||0,show_provider:parseInt(sub_query.show_provider,10)||0,custom_params:{query:[queryObj],start:qstart,end:(qlimit||(newlimit?newlimit:1))}},current_config))};var paramMap=(function(){if(sortRecent)return{sort:"-lastmodifieddate"};if(sortPublish)return{sort:"-publishdate"};return{}})(),dsx_promise=dsxclient.execute(dsxclientcfs,paramMap);dsx_promise.then(function(response){angular.forEach(dsxclientcfs,function(config){var current_result=response.getModel(config);if(!!current_result){current_result=angular.isArray(current_result)?current_result:[current_result];if(config.override_title&&current_result[0]&&current_result[0].setTitle)current_result[0].setTitle(config.override_title);if(config.use_teaser_title||config.show_provider)angular.forEach(current_result,function(result){result.showTeaserTitle=!!config.use_teaser_title;result.showProvider=!!config.show_provider});if(config.is_playlist)angular.forEach(current_result,function(result){result.setPlaylistUrl(config.path)});var existingLength=$scope.content_media.corsicans.length,diffLength=vars.limit-existingLength,requiredLength=(diffLength<0)?current_result.length:diffLength;$scope.content_media.corsicans=$scope.content_media.corsicans.concat(current_result.splice(0,requiredLength))}});if($scope.content_media.corsicans.length<vars.limit){fns.queryInThread();$scope.content_media.status=$scope.content_media.corsicans.length!==0?$scope.content_media.status_codes.DEFAULT:$scope.content_media.status_codes.ERROR}else $scope.content_media.status=$scope.content_media.corsicans.length!==0?$scope.content_media.status_codes.DEFAULT:$scope.content_media.status_codes.ERROR},function(){$scope.content_media.status=$scope.content_media.status_codes.ERROR})}};$scope.content_media={corsicans:[],settings:settings,moduleId:settings.module_id,pageName:metrics.getPageName(),status_codes:twcConfig.module_status_codes,status:twcConfig.module_status_codes.LOADING};vars.init();if(settings&&settings.ignore_processing)return;fns.init()}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/content_media/content_media.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_savedlocations/header_savedlocations.controller.js. */
twc.header_savedlocations.app.controller('twc_header_savedlocations_controller',["$scope","twcUtil","pcoUser","DrupalSettings","settings","dsxclient","twcConfig","locUtil","alertFactory","customEvent","$injector",function($scope,twcUtil,pcoUser,DrupalSettings,settings,dsxclient,twcConfig,locUtil,alertFactory,customEvent,$injector){"use strict";var vars={savedLocations:null,recentSearchLocations:null,xWebLocClass:[],XwebModelClass:$injector.has('XwebWebLocModelClass')&&$injector.get('XwebWebLocModelClass')},func={clickThru:function(url){if(url)window.location.href=url},setSavedLocations:function(locations){if(locations===undefined)return;var count=0;$scope.visibleLocationsBlock.items.length=0;$scope.otherLocationsBlock.items.length=0;vars.savedLocations.length=0;twcUtil.each(locations,function(location){if(count!==$scope.maxLocationLimit){if(count<$scope.visibleLocationsBlock.maxItems){$scope.visibleLocationsBlock.items.push(location)}else if(count<=9)$scope.otherLocationsBlock.items.push(location);vars.savedLocations.push(location)};count++});$scope.getWeatherForLocations(vars.savedLocations)},initSetSavedLocations:function(){vars.savedLocations=pcoUser.getSavedLocations().slice(0);vars.recentSearchLocations=pcoUser.getRecentSearchLocations().slice(0);$scope.combinedLocations=vars.savedLocations.concat(vars.recentSearchLocations);vars.xWebLocClass=[];angular.forEach($scope.combinedLocations,function(location){var model=func.createModel(location);if(!!model)vars.xWebLocClass.push(model)});$scope.combinedLocations=vars.xWebLocClass;func.setSavedLocations($scope.combinedLocations)},buildFullName:function(loc){if(!loc)return;var label;if(!loc.recentSearch){if(loc.getCountryCode().toLowerCase()==='us'){label=loc.getCity()+", "+loc.getStateCode()}else label=loc.getCity()+", "+twcUtil.capitalize(loc.getCountry(),true)}else label=loc.getFormattedName();return label},getLabel:function(loc){if(!loc)return;var label=loc&&loc.getNickname().length!==0?loc.getNickname():func.buildFullName(loc);if(label&&label!==""){return label}else return'N/A'},getTemp:function(obs){if(!obs)return"N/A";var temp=obs.getTemp();if(twcUtil.isNumber(temp)){return temp}else return"N/A"},getTempUnit:function(obs){if(!obs)return;var tempUnit=obs.getTempUnit();if(tempUnit&&tempUnit!==""){return tempUnit}else return"N/A"},getWeatherIcon:function(obs){if(!obs)return;var skyCode=obs.getSkyCode(),haveIcon=(typeof skyCode)==="number";return haveIcon?'condition-icon wx-icon-code-'+skyCode:'noIconData'},getUrl:function(loc){if(!loc)return;var url;if(func.getFullLocId(loc)!=="")url="/weather/today/l/"+func.getFullLocId(loc);return url},getCurWeather:function(obs){if(!obs)return;var wxDescription="";if(obs.getWeatherDescription()!=="")wxDescription=obs.getWeatherDescription();return wxDescription},getFullLocId:function(location){return location.getLocId()+':'+location.getLocType()+':'+location.getCountryCode()},getWeatherForLocations:function(locations){if(locations.length===0){$scope.dataLoaded=true;return};var config,promise,_location,wxdRecords=twcConfig.dsxclient.wxd.records,bulletinConfig={recordType:"wxd",recordName:wxdRecords.bulletin},bulletinConfigs,observationConfig={recordType:"wxd",recordName:wxdRecords.observation},observationConfigs,bulletins,observations,cLocId;bulletinConfigs=twcUtil.map(locations,function(location){var fullLocId=func.getFullLocId(location);return angular.extend({fullLocId:fullLocId},bulletinConfig)});observationConfigs=twcUtil.map(locations,function(location){var fullLocId=func.getFullLocId(location);return angular.extend({fullLocId:fullLocId},observationConfig)});config=bulletinConfigs.concat(observationConfigs);promise=dsxclient.execute(config);promise.then(function(response){angular.forEach(locations,function(location){var numberOfAlert=0,totalBull=[],priority,alertPriority=0;_location=location;cLocId=func.getFullLocId(location);bulletins=response.getModel(angular.extend({fullLocId:cLocId},bulletinConfig));observations=response.getModel(angular.extend({fullLocId:cLocId},observationConfig));if(bulletins&&bulletins.length>0){priority=alertFactory.convertBulletinToAlert(bulletins[0],cLocId);numberOfAlert=bulletins.length;alertPriority=priority;if(numberOfAlert>=1)jQuery.each(bulletins,function(index,bulletin){var alert=alertFactory.convertBulletinToAlert(bulletin,cLocId);totalBull.push(alert)})}
function alertStyle(){if(angular.isDefined(alertPriority)&&alertPriority!==null)return[" level-",alertPriority.severity].join("")};if(totalBull.length!==0&&alertStyle()!==undefined)if(location.getCountryCode()==="US"){location.totalB=totalBull.length;location.alertStyle=alertStyle()};location.skyCode=(func.getWeatherIcon(observations)===undefined)?"noSkyData":func.getWeatherIcon(observations);location.noData=(location.skyCode==="noSkyData")?"noData":"";location.noSkyCode=(location.skyCode==="noSkyData")?"N/A":"";location.temp=func.getTemp(observations);location.tempUnit=func.getTempUnit(observations);location.label=func.getLabel(location);location.url=func.getUrl(location);location.curWeather=func.getCurWeather(observations);location.scope=$scope});$scope.dataLoaded=true})},hideOtherLocs:function(event){if(event&&Modernizr.touch&&(event.type.match(/mouse/)))return;if($scope.showOtherLocsTab){$scope.showOtherLocsTab=false;return true};return false},showOtherLocs:function(event){if(event&&Modernizr.touch&&(event.type.match(/mouse/)))return;if($scope.combinedLocations.length>=3&&!$scope.showOtherLocsTab&&$scope.otherLocationsBlock.items.length!==0){$scope.showOtherLocsTab=true;return true};return false},createModel:function(locModel){if(locModel.getCity&&locModel.getStateCode&&locModel.getCountry&&locModel.getCountryCode&&locModel.getLocType){return new vars.XwebModelClass({name:locModel.getCity()+', '+locModel.getStateCode()+', '+locModel.getCountry(),key:locModel.getFullLocId(),locId:locModel.getLocId(),locType:locModel.getLocType(),cntryCd:locModel.getCountryCode(),_country:locModel.getCountry(),stCd:locModel.getStateCode(),stNm:locModel.getState()||'',cityNm:locModel.getCity()||'',prsntNm:locModel.get('prsntNm')||'',bigCity:locModel.getBigCity&&locModel.getBigCity()||false,nickname:locModel.getNickname&&locModel.getNickname()||'',recentSearch:true},'XwebWebLocModelClass')}else return null}};$scope.dataLoaded=false;$scope.settings=settings;$scope.combinedLocations=0;$scope.showManageLocationsIcon=false;$scope.maxLocationLimit=10;$scope.visibleLocationsBlock={maxItems:3,items:[]};$scope.otherLocationsBlock={maxItmes:7,items:[],viewTrigger:{shown:false,show:function(){this.shown=true},hide:function(){this.shown=false}},viewToggle:function(){if(this.shown){this.shown=false}else this.shown=true},shown:false};$scope.showOtherLocsTab=false;$scope.getWeatherForLocations=func.getWeatherForLocations;$scope.showOtherLocs=func.showOtherLocs;$scope.hideOtherLocs=func.hideOtherLocs;customEvent.getEvent('pcoReady').then(function(event){var loaded=false;$scope.$watchCollection(function(){return pcoUser},function(){if(!loaded){loaded=true;func.initSetSavedLocations()}})});customEvent.getEvent("manage-location-update-event").progress(function(event){func.initSetSavedLocations()});customEvent.getEvent("imaps-location-update-event").progress(function(event){func.initSetSavedLocations()})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_savedlocations/header_savedlocations.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/title_video_collection/translations/title_video_collection.fr_fr.js. */
twc.shared.apps.config(['twcMessageProvider',function(twcMessageProvider){twcMessageProvider.add({fr_FR:{"title_video_collection.TITLE":"FR: Precip & Soil Moisture","title_video_collection.LINK_TEXT":"FR: Hourly Forecast"}})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/title_video_collection/translations/title_video_collection.fr_fr.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_metadata/translations/video_metadata.fr_fr.js. */
twc.shared.apps.config(['twcMessageProvider',function(twcMessageProvider){twcMessageProvider.add({fr_FR:{"video_metadata.MORE_INFO_TEXT":"Pour en savoir plus"}})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_metadata/translations/video_metadata.fr_fr.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_companion_text/translations/video_companion_text.fr_fr.js. */
twc.shared.apps.config(['twcMessageProvider',function(twcMessageProvider){twcMessageProvider.add({fr_FR:{"video_companion_text.ADVERTISEMENT":"Publicité"}})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_companion_text/translations/video_companion_text.fr_fr.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/taboola_module/translations/taboola_module.fr_fr.js. */
twc.shared.apps.config(['twcMessageProvider',function(twcMessageProvider){twcMessageProvider.add({fr_FR:{"taboola_module.TITLE":"FR: Precip & Soil Moisture","taboola_module.LINK_TEXT":"FR: Hourly Forecast"}})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/taboola_module/translations/taboola_module.fr_fr.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_page_nav/translations/video_page_nav.fr_fr.js. */
twc.shared.apps.config(["twcMessageProvider",function(twcMessageProvider){twcMessageProvider.add({fr_FR:{page_nav:{MORETEXT:"Plus Prévisions",MORETEXTREDUCED:"Plus"}}})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/video_page_nav/translations/video_page_nav.fr_fr.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/breaking_now/breaking_now.controller.js. */
twc.breaking_now.app.controller('twc_breaking_now_controller',['$scope','dsxclient','twcPco','$rootScope','TwcSocialSharing','settings',function($scope,dsxclient,twcPco,$rootScope,TwcSocialSharing,settings){var vars={},fns={init:function(callback){dsxclient.execute([{$id:"bnModel",recordType:"cms",recordName:"BreakingNow"}]).then(["bnModel",function(bnModel){callback&&callback.apply($scope.breaking_now,[bnModel])}])},loadGigya:function(){if(!TwcSocialSharing.gigyaLoaded)TwcSocialSharing.loadGigyaAPI()}};$scope.isTouch=$rootScope.isTouch;$scope.moduleId=settings.module_id;$scope.breaking_now={model:{},fb:{},display:false,process:function(model){if(model&&model.getTitle()){fns.loadGigya();this.model=model;this.pagename=((twcPco.get('metrics')&&twcPco.get('metrics').attributes.pagename)||'');this.display=true;this.cid=twcPco.getNodeValue("metrics","contentChannel")||""}}};fns.init($scope.breaking_now.process)}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/breaking_now/breaking_now.controller.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/most_popular/translations/most_popular.fr_fr.js. */
twc.shared.apps.config(['twcMessageProvider',function(twcMessageProvider){twcMessageProvider.add({fr_FR:{most_popular:{TITLE:"FR: Most Popular"}}})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/most_popular/translations/most_popular.fr_fr.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/error_handler/translations/error_handler.fr_fr.js. */
twc.shared.apps.config(['twcMessageProvider',function(twcMessageProvider){twcMessageProvider.add({fr_FR:{"error_handler.GENERIC_ERROR_TITLE":"Oups!","error_handler.GENERIC_ERROR_DESCRIPTION":"On dirait que cette fonctionnalité n'a pas tout à fait charger correctement ... S'il vous plaît revenez bientôt.","error_handler.NOT_AVAILABLE_TITLE":"Nous sommes désolés...","error_handler.NOT_AVAILABLE_DESCRIPTION":"Données n'est pas actuellement disponible pour cet emplacement."}})}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/app/shared/error_handler/translations/error_handler.fr_fr.js. */
/* Source and licensing information for the line(s) below can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_savedlocations/header_savedlocations.directives.js. */
twc.header_savedlocations.app.directive('userLocations',['$window','TwcDomEventOriginVerifier',function($window,TwcDomEventOriginVerifier){"use strict";return{scope:{userLocations:'=',settings:'=',fromAttrs:'@',otherLocsTabOpen:'=',showSettingButton:'@'},restrict:'A',replace:'true',templateUrl:'/sites/all/modules/custom/angularmods/modules/header_savedlocations/templates/user_locations_template.html',controller:['$scope','$attrs','$element','customEvent','pcoUser','twcUtil','$timeout',function($scope,$attrs,$element,customEvent,pcoUser,twcUtil){'use-strict';var vars={settingsTabOpen:false,otherLocsTabOpen:false,otherLocsTriggerHovered:false,otherLocsTriggerVerifier:null,otherLocsDropdownVerifier:null},func={clickThru:function(url){if(url)window.parent.location.href=url},getDropdownPosition:function(){var locationsWidth=0,location=jQuery('.wx-visible-locs').children(),locationCount=(location.length-2);for(var i=0;i<locationCount;i++)locationsWidth=locationsWidth+location[i].clientWidth;var dropDownPos=locationsWidth;jQuery('.wx-additional-user-locs').css("left",dropDownPos+"px")},whatLocations:function(){if($attrs.type==="visible"){return"wx-visible-locs"}else return"wx-not-visible-locs"},setTempUnit:function(unit){pcoUser.setTempUnit(unit);func.setFahrenheitTitle();func.setCelsiusTitle();$scope.$parent.getWeatherForLocations($scope.$parent.combinedLocations);twcUtil.safeApply($scope)},setNoUserLocationIconAndText:function(){if(pcoUser.getFullLocationList().length===0){$scope.noUserLocationText="Add a Location";$scope.noUserLocations=true}else{$scope.noUserLocationText="";$scope.noUserLocations=false}},toggleShowSettingsTab:function(event){if(!Modernizr.touch&&!(event&&event.keyCode===13))return;if(vars.settingsTabDropdownVerifier&&vars.settingsTabDropdownVerifier.verifyOrigin(event))return;func[vars.settingsTabOpen?'hideSettingsTab':'showSettingsTab'](event)},showSettingsTab:function(event){if(Modernizr.touch&&event&&event.type.match(/mouse/))return;if(!vars.settingsTabOpen){$scope.settingsTabActive="settings-button-active";$scope.showSettings=true;vars.settingsTabOpen=true}},hideSettingsTab:function(event){if(Modernizr.touch&&event&&event.type.match(/mouse/))return;if(vars.settingsTabOpen){$scope.settingsTabActive="";$scope.showSettings=false;vars.settingsTabOpen=false}},addEvent:function(elem,type,eventHandle){if(elem===null||typeof elem==='undefined')return;if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}else if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)}else elem["on"+type]=eventHandle},hasOtherLocs:function(){return!!$scope.$parent.otherLocationsBlock.items.length},toggleShowOtherLocs:function(event){if(!Modernizr.touch)return;func[vars.otherLocsTabOpen?'hideOtherLocs':'showOtherLocs'](event)},showOtherLocs:function(event){if(event.originalEvent.type==="mouseover"&&!$scope.$parent.otherLocationsBlock.items.length)return;if(!vars.otherLocsTabOpen){$scope.otherLocsTabActive="otherLocs-active";func.getDropdownPosition();if($scope.$parent.showOtherLocs(event))vars.otherLocsTabOpen=true}},hideOtherLocs:function(event){if(vars.otherLocsTabOpen){$scope.otherLocsTabActive="";if($scope.$parent.hideOtherLocs(event)){vars.otherLocsTabOpen=false;vars.otherLocsTriggerHovered=false}}},getTempUnitFromPCO:function(){return pcoUser.getTempUnit()},upDateLocationsPosition:function(){var sc=$scope.$parent,width;if(sc.visibleLocationsBlock.length===0)return;width=$element.closest(".wx-user-locs").width()
function setIconType(){if(sc.otherLocationsBlock.items.length>=1){$scope.globalIconType="wx-icon-arrow-down-2";$scope.lifeProfileUrl=""}else{$scope.globalIconType="wx-icon-plus";$scope.lifeProfileUrl="/life/profile"}}
function moveLocationToDP(maxNumOfVisItems){for(var i=sc.visibleLocationsBlock.items.length-1;i>maxNumOfVisItems-1;i--){var loc=sc.visibleLocationsBlock.items.pop();if(loc){sc.otherLocationsBlock.items.unshift(loc)}else break}}
function moveLocationFromDP(maxNumOfVisItems){for(var i=0;i<=sc.otherLocationsBlock.items.length-1;i++)if(sc.visibleLocationsBlock.items.length<maxNumOfVisItems){var loc=sc.otherLocationsBlock.items.shift();if(loc){sc.visibleLocationsBlock.items.push(loc)}else break}else break};if(width<=660){moveLocationToDP(2);moveLocationFromDP(2)}else{moveLocationToDP(3);moveLocationFromDP(3)};setIconType();twcUtil.safeApply($scope);setTimeout(function(){$element.closest(".wx-user-locs").removeAttr("style")},250)},setFahrenheitTitle:function(){var unit=$scope.getTempUnitFromPCO(),_return;if(unit==="F"){_return="Fahrenheit is Selected"}else if(unit==="C")_return="Change to Fahrenheit";return _return},setCelsiusTitle:function(){var unit=$scope.getTempUnitFromPCO(),_return;if(unit==="F"){_return="Change to Celsius"}else if(unit==="C")_return="Celsius is Selected";return _return},registerOtherLocsTrigger:function(triggerElem){if(vars.otherLocsTriggerVerifier){vars.otherLocsTriggerVerifier.setOriginator(triggerElem);vars.otherLocsTriggerVerifier.bindEvents('touchstart')}},registerOtherLocsDropdown:function(dropDownElem){if(vars.otherLocsDropdownVerifier){vars.otherLocsDropdownVerifier.setOriginator(dropDownElem);vars.otherLocsDropdownVerifier.bindEvents('touchstart')}},registerSettingsTabTrigger:function(triggerElem){if(vars.settingsTabTriggerVerifier){vars.settingsTabTriggerVerifier.setOriginator(triggerElem);vars.settingsTabTriggerVerifier.bindEvents('touchstart')}},registerSettingsTabDropdown:function(dropDownElem){if(vars.settingsTabDropdownVerifier){vars.settingsTabDropdownVerifier.setOriginator(dropDownElem);vars.settingsTabDropdownVerifier.bindEvents('touchstart')}}};$scope.hovered=[];$scope.vars=vars;$scope.globalIconType="";$scope.noUserLocationText="";$scope.settingsTagStyle="";$scope.hrefTarget="_parent";$scope.noUserLocations=true;$scope.isVisibleLocations=true;$scope.whatLocations=func.whatLocations;if($scope.whatLocations()!=="wx-visible-locs")$scope.isVisibleLocations=false;$scope.clickThru=func.clickThru;$scope.settingsTabActive="";$scope.otherLocsTabActive="";$scope.showSettings=false;$scope.showSettingsTab=func.showSettingsTab;$scope.hideSettingsTab=func.hideSettingsTab;$scope.toggleShowSettingsTab=func.toggleShowSettingsTab;$scope.completeTempUnitClick=func.completeTempUnitClick;$scope.hasOtherLocs=func.hasOtherLocs;$scope.toggleShowOtherLocs=func.toggleShowOtherLocs;$scope.showOtherLocs=func.showOtherLocs;$scope.hideOtherLocs=func.hideOtherLocs;$scope.setFahrenheitTitle=func.setFahrenheitTitle;$scope.setCelsiusTitle=func.setCelsiusTitle;$scope.setTempUnit=func.setTempUnit;$scope.getTempUnitFromPCO=func.getTempUnitFromPCO;$scope.$watch('otherLocsTabOpen',function(val){vars.otherLocsTabOpen=val});$scope.$watch('vars.otherLocsTabOpen',function(val){$scope.otherLocsTabOpen=val});$scope.otherLocsTriggerActive=function(){return vars.otherLocsTabOpen||vars.otherLocsTriggerHovered};this.registerOtherLocsTrigger=func.registerOtherLocsTrigger;this.registerOtherLocsDropdown=func.registerOtherLocsDropdown;customEvent.getEvent('pcoReady').then(function(){$scope.$watchCollection(function(){return pcoUser},function(){if(!$scope.showSettingButton){$scope.hrefTarget="_self";$scope.showSettingButton=true};func.setNoUserLocationIconAndText();func.getDropdownPosition();func.upDateLocationsPosition()})});if($scope.isVisibleLocations){vars.otherLocsDropdownVerifier=new TwcDomEventOriginVerifier();vars.otherLocsTriggerVerifier=new TwcDomEventOriginVerifier();vars.settingsTabTriggerVerifier=new TwcDomEventOriginVerifier();vars.settingsTabDropdownVerifier=new TwcDomEventOriginVerifier();customEvent.getEvent('other-locations-dropdown-init').progress(function(elem){func.registerOtherLocsDropdown(elem)});customEvent.getEvent('other-locations-trigger-init').progress(function(elem){func.registerOtherLocsTrigger(elem)});customEvent.getEvent('settings-tab-trigger-init').progress(function(elem){func.registerSettingsTabTrigger(elem)});customEvent.getEvent('settings-tab-dropdown-init').progress(function(elem){func.registerSettingsTabDropdown(elem)});customEvent.getEvent("touch-on-body-event").progress(function(event){if(!event.type.match(/touch/))return;if(!vars.otherLocsDropdownVerifier.verifyOrigin(event)&&!vars.otherLocsTriggerVerifier.verifyOrigin(event))if(vars.settingsTabOpen||vars.otherLocsTabOpen)$scope.$evalAsync(function(){func.hideOtherLocs()});if(!vars.settingsTabTriggerVerifier.verifyOrigin(event))if(vars.settingsTabOpen||vars.otherLocsTabOpen)$scope.$evalAsync(function(){func.hideSettingsTab()})});customEvent.getEvent("manage-location-update-event").progress(function(){func.upDateLocationsPosition();func.setNoUserLocationIconAndText()});customEvent.getEvent("imaps-location-update-event").progress(function(){func.upDateLocationsPosition();func.setNoUserLocationIconAndText()});func.addEvent($window,"resize",function(){func.getDropdownPosition();func.upDateLocationsPosition()})}}]}}]).directive('settingsTabTrigger',['customEvent',function(customEvent){return{link:function(scope,elem){customEvent.getEvent("settings-tab-trigger-init").notify(elem)}}}]).directive('settingsTabDropdown',['customEvent',function(customEvent){return{link:function(scope,elem){customEvent.getEvent("settings-tab-dropdown-init").notify(elem)}}}]).directive('otherLocationsTrigger',['customEvent',function(customEvent){return{link:function(scope,elem){customEvent.getEvent("other-locations-trigger-init").notify(elem)}}}]).directive('otherLocationsDropdown',['customEvent',function(customEvent){return{link:function(scope,elem){customEvent.getEvent("other-locations-dropdown-init").notify(elem)}}}]);;
/* Source and licensing information for the above line(s) can be found at http://www.weather.com/sites/all/modules/custom/angularmods/modules/header_savedlocations/header_savedlocations.directives.js. */
